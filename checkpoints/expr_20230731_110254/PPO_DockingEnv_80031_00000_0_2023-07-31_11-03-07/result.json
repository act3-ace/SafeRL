{"episode_reward_max": -3.801279160038309, "episode_reward_min": -3.906790602502561, "episode_reward_mean": -3.868041636231275, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7860437416030971, "reward_component_totals/dist_change_reward_min": -0.8221965123810681, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0819978946281843, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0715022702018433, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19978946281765, "delta_v_total_min": 207.15022702018368, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1262.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 984, "constraint_violation.max_vel_constraint.steps_max": 1657, "constraint_violation.max_vel_constraint.ratio_mean": 0.630767949358654, "constraint_violation.max_vel_constraint.ratio_min": 0.4917541229385307, "constraint_violation.max_vel_constraint.ratio_max": 0.8280859570214892}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9147141631587206, "mean_inference_ms": 5.645911454598665, "mean_action_processing_ms": 0.2834306452379916, "mean_env_wait_ms": 6.683963380414091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 12006, "agent_timesteps_total": 12006, "timers": {"sample_time_ms": 33104.305, "sample_throughput": 362.672, "load_time_ms": 351.957, "load_throughput": 34112.114, "learn_time_ms": 29840.67, "learn_throughput": 402.337, "update_time_ms": 24.499}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0021376104559749365, "policy_loss": -0.0012907073833048344, "vf_loss": 0.003268355969339609, "vf_explained_var": 0.5588147640228271, "kl": 0.000799811736214906, "entropy": 2.7268152236938477, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 12006, "num_agent_steps_sampled": 12006, "num_steps_trained": 12006, "num_agent_steps_trained": 12006}, "done": false, "episodes_total": 6, "training_iteration": 1, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-05-13", "timestamp": 1690826713, "time_this_iter_s": 63.63012385368347, "time_total_s": 63.63012385368347, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 63.63012385368347, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 99.97472527472526, "ram_util_percent": 43.56923076923078}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.801279160038309, "episode_reward_min": -4.036858223132495, "episode_reward_mean": -3.908891732870926, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380579880378911, "reward_component_totals/dist_change_reward_min": -0.9770711120984992, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0708337448330427, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0392251753310395, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.0833744833035, "delta_v_total_min": 203.9225175331036, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1308.0833333333333, "constraint_violation.max_vel_constraint.steps_min": 701, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6537148092620356, "constraint_violation.max_vel_constraint.ratio_min": 0.3503248375812094, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6680092696055973, "mean_inference_ms": 5.741150772802925, "mean_action_processing_ms": 0.2834463133119553, "mean_env_wait_ms": 6.565627748567493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 24012, "agent_timesteps_total": 24012, "timers": {"sample_time_ms": 31075.749, "sample_throughput": 386.346, "load_time_ms": 178.986, "load_throughput": 67077.8, "learn_time_ms": 28902.925, "learn_throughput": 415.39, "update_time_ms": 32.925}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019995858892798424, "policy_loss": -0.0013593981275334954, "vf_loss": 0.0031878692097961903, "vf_explained_var": 0.11082638055086136, "kl": 0.001711126766167581, "entropy": 2.6743366718292236, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 24012, "num_agent_steps_sampled": 24012, "num_steps_trained": 24012, "num_agent_steps_trained": 24012}, "done": false, "episodes_total": 12, "training_iteration": 2, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-06-10", "timestamp": 1690826770, "time_this_iter_s": 57.100647926330566, "time_total_s": 120.73077178001404, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 120.73077178001404, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.97926829268292, "ram_util_percent": 43.6890243902439}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.036858223132495, "episode_reward_mean": -3.9022306168395917, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381490685721041, "reward_component_totals/dist_change_reward_min": -0.9770711120984992, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0640815482674966, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.40815482674884, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1301.3333333333333, "constraint_violation.max_vel_constraint.steps_min": 701, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6503414959187073, "constraint_violation.max_vel_constraint.ratio_min": 0.3503248375812094, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5525152357213505, "mean_inference_ms": 5.852333807411186, "mean_action_processing_ms": 0.28577985159994723, "mean_env_wait_ms": 6.614468352312632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 36018, "agent_timesteps_total": 36018, "timers": {"sample_time_ms": 31322.302, "sample_throughput": 383.305, "load_time_ms": 121.665, "load_throughput": 98680.481, "learn_time_ms": 30227.538, "learn_throughput": 397.187, "update_time_ms": 29.338}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0003435994731262326, "policy_loss": -0.002514812396839261, "vf_loss": 0.0027230747509747744, "vf_explained_var": 0.08590348809957504, "kl": 0.0027067370247095823, "entropy": 2.7511308193206787, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 36018, "num_agent_steps_sampled": 36018, "num_steps_trained": 36018, "num_agent_steps_trained": 36018}, "done": false, "episodes_total": 18, "training_iteration": 3, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-07-15", "timestamp": 1690826835, "time_this_iter_s": 64.75984311103821, "time_total_s": 185.49061489105225, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 185.49061489105225, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.97500000000001, "ram_util_percent": 46.21521739130434}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.036858223132495, "episode_reward_mean": -3.90568850141441, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8353959173606557, "reward_component_totals/dist_change_reward_min": -0.9770711120984992, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0702925840537616, "reward_component_totals/delta_v_min": -2.120038070082669, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.02925840537543, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 212.00380700826622, "constraint_violation.max_vel_constraint.steps_mean": 1243.4166666666667, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6213976345160752, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4817298478557754, "mean_inference_ms": 5.92447832666216, "mean_action_processing_ms": 0.2892110116382639, "mean_env_wait_ms": 6.678749049110697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 48024, "agent_timesteps_total": 48024, "timers": {"sample_time_ms": 31419.065, "sample_throughput": 382.125, "load_time_ms": 92.776, "load_throughput": 129409.049, "learn_time_ms": 29860.726, "learn_throughput": 402.067, "update_time_ms": 25.124}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007593746995553374, "policy_loss": -0.0017701361794024706, "vf_loss": 0.0025150037836283445, "vf_explained_var": 0.040840886533260345, "kl": 0.0005803589010611176, "entropy": 2.811706781387329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 48024, "num_agent_steps_sampled": 48024, "num_steps_trained": 48024, "num_agent_steps_trained": 48024}, "done": false, "episodes_total": 24, "training_iteration": 4, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-08-16", "timestamp": 1690826896, "time_this_iter_s": 60.543790340423584, "time_total_s": 246.03440523147583, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 246.03440523147583, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.97241379310343, "ram_util_percent": 47.3264367816092}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.920269629469873, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8431994387305762, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.077070190739304, "reward_component_totals/delta_v_min": -2.1296713096896815, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70701907392962, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 212.9671309689672, "constraint_violation.max_vel_constraint.steps_mean": 1190.3333333333333, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5948692320506412, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.434889420898942, "mean_inference_ms": 5.994294722506767, "mean_action_processing_ms": 0.2914598389480472, "mean_env_wait_ms": 6.707768295818304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 60030, "agent_timesteps_total": 60030, "timers": {"sample_time_ms": 31630.269, "sample_throughput": 379.573, "load_time_ms": 75.249, "load_throughput": 159549.98, "learn_time_ms": 29981.734, "learn_throughput": 400.444, "update_time_ms": 23.251}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0013785656774416566, "policy_loss": -0.0008820655639283359, "vf_loss": 0.002247018273919821, "vf_explained_var": 0.4395591914653778, "kl": 0.0010892038699239492, "entropy": 2.756232738494873, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 60030, "num_agent_steps_sampled": 60030, "num_steps_trained": 60030, "num_agent_steps_trained": 60030}, "done": false, "episodes_total": 30, "training_iteration": 5, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-09-19", "timestamp": 1690826959, "time_this_iter_s": 63.01030611991882, "time_total_s": 309.04471135139465, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 309.04471135139465, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 99.97111111111111, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.917336041677145, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8347526415681253, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.7202608868497118, "reward_component_totals/delta_v_mean": -2.0825834001090273, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.25834001090192, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1209.9722222222222, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6046837692264979, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4002585962314966, "mean_inference_ms": 6.048443080641597, "mean_action_processing_ms": 0.2933503585836833, "mean_env_wait_ms": 6.732586061406008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 72036, "agent_timesteps_total": 72036, "timers": {"sample_time_ms": 31684.784, "sample_throughput": 378.92, "load_time_ms": 63.699, "load_throughput": 188478.882, "learn_time_ms": 30240.825, "learn_throughput": 397.013, "update_time_ms": 21.875}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007294748211279511, "policy_loss": -0.0016039953334257007, "vf_loss": 0.002324797213077545, "vf_explained_var": 0.5173929929733276, "kl": 0.0013881637714803219, "entropy": 2.751415729522705, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 72036, "num_agent_steps_sampled": 72036, "num_steps_trained": 72036, "num_agent_steps_trained": 72036}, "done": false, "episodes_total": 36, "training_iteration": 6, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-10-23", "timestamp": 1690827023, "time_this_iter_s": 63.56281232833862, "time_total_s": 372.6075236797333, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 372.6075236797333, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.96923076923076, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9231070671532198, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8393276368986393, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.7202608868497118, "reward_component_totals/delta_v_mean": -2.0837794302545882, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.37794302545794, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1207.857142857143, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6036267580495467, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3744338846717494, "mean_inference_ms": 6.088527903290769, "mean_action_processing_ms": 0.2950588471050038, "mean_env_wait_ms": 6.757058698662627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 84042, "agent_timesteps_total": 84042, "timers": {"sample_time_ms": 31806.879, "sample_throughput": 377.466, "load_time_ms": 55.556, "load_throughput": 216104.585, "learn_time_ms": 30410.843, "learn_throughput": 394.793, "update_time_ms": 21.86}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 1.0000000116860974e-07, "total_loss": 2.2634383640252054e-05, "policy_loss": -0.0023280333261936903, "vf_loss": 0.0023471685126423836, "vf_explained_var": 0.35774004459381104, "kl": 0.0011198867578059435, "entropy": 2.766267776489258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 84042, "num_agent_steps_sampled": 84042, "num_steps_trained": 84042, "num_agent_steps_trained": 84042}, "done": false, "episodes_total": 42, "training_iteration": 7, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-11-27", "timestamp": 1690827087, "time_this_iter_s": 64.03861713409424, "time_total_s": 436.6461408138275, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 436.6461408138275, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.97472527472526, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9249949782420224, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8395880073480614, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.7202608868497118, "reward_component_totals/delta_v_mean": -2.0854069708939673, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.54069708939596, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1201.5208333333333, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.60046018657338, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3553220734047622, "mean_inference_ms": 6.122690445458425, "mean_action_processing_ms": 0.29673298471683957, "mean_env_wait_ms": 6.781681517398755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 96048, "agent_timesteps_total": 96048, "timers": {"sample_time_ms": 31912.141, "sample_throughput": 376.22, "load_time_ms": 49.557, "load_throughput": 242267.645, "learn_time_ms": 30247.939, "learn_throughput": 396.92, "update_time_ms": 22.108}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0006641861982643604, "policy_loss": -0.0016889681573957205, "vf_loss": 0.002352061215788126, "vf_explained_var": 0.27962610125541687, "kl": 0.0006997855962254107, "entropy": 2.782505512237549, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 96048, "num_agent_steps_sampled": 96048, "num_steps_trained": 96048, "num_agent_steps_trained": 96048}, "done": false, "episodes_total": 48, "training_iteration": 8, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-12-29", "timestamp": 1690827149, "time_this_iter_s": 61.82275629043579, "time_total_s": 498.4688971042633, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 498.4688971042633, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.97303370786517, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9250343503275102, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8389496314089692, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.7202608868497118, "reward_component_totals/delta_v_mean": -2.086084718918546, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.60847189185387, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1173.537037037037, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5864752808780794, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3410365045756318, "mean_inference_ms": 6.153438681111059, "mean_action_processing_ms": 0.2984361403340517, "mean_env_wait_ms": 6.804718052568521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 108054, "agent_timesteps_total": 108054, "timers": {"sample_time_ms": 32002.115, "sample_throughput": 375.163, "load_time_ms": 45.265, "load_throughput": 265240.765, "learn_time_ms": 30318.095, "learn_throughput": 396.001, "update_time_ms": 20.434}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009052189998328686, "policy_loss": -0.0013351115630939603, "vf_loss": 0.0022398820146918297, "vf_explained_var": 0.4395883083343506, "kl": 0.0005770907737314701, "entropy": 2.777329206466675, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 108054, "num_agent_steps_sampled": 108054, "num_steps_trained": 108054, "num_agent_steps_trained": 108054}, "done": false, "episodes_total": 54, "training_iteration": 9, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-13-33", "timestamp": 1690827213, "time_this_iter_s": 63.67027163505554, "time_total_s": 562.1391687393188, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 562.1391687393188, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 99.97888888888887, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.7703374186084853, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9290136884643494, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8410599905163603, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.7202608868497118, "reward_component_totals/delta_v_mean": -2.0879536979479956, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.79536979479877, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1149.7166666666667, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5745710478094286, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3290071740184524, "mean_inference_ms": 6.180364021088737, "mean_action_processing_ms": 0.30008127361326914, "mean_env_wait_ms": 6.828131234739838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 120060, "agent_timesteps_total": 120060, "timers": {"sample_time_ms": 32187.159, "sample_throughput": 373.006, "load_time_ms": 41.561, "load_throughput": 288874.385, "learn_time_ms": 30275.579, "learn_throughput": 396.557, "update_time_ms": 20.26}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0014428900321945548, "policy_loss": -0.000856259313877672, "vf_loss": 0.0022990438155829906, "vf_explained_var": 0.4185663163661957, "kl": 0.00027082671294920146, "entropy": 2.8055131435394287, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 120060, "num_agent_steps_sampled": 120060, "num_steps_trained": 120060, "num_agent_steps_trained": 120060}, "done": false, "episodes_total": 60, "training_iteration": 10, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-14-37", "timestamp": 1690827277, "time_this_iter_s": 63.818647384643555, "time_total_s": 625.9578161239624, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 625.9578161239624, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.97252747252745, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9267315204488784, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8380675117229579, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.088664008725927, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.86640087259192, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1177.4545454545455, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5884330561991733, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.328558062244478, "mean_inference_ms": 6.19961025810869, "mean_action_processing_ms": 0.30147551009636947, "mean_env_wait_ms": 6.849730645180838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 132066, "agent_timesteps_total": 132066, "timers": {"sample_time_ms": 32933.954, "sample_throughput": 364.548, "load_time_ms": 7.357, "load_throughput": 1631862.01, "learn_time_ms": 30531.266, "learn_throughput": 393.236, "update_time_ms": 20.05}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009367644088342786, "policy_loss": -0.001311171567067504, "vf_loss": 0.0022478278260678053, "vf_explained_var": 0.6047620177268982, "kl": 0.0005524228326976299, "entropy": 2.771576166152954, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 132066, "num_agent_steps_sampled": 132066, "num_steps_trained": 132066, "num_agent_steps_trained": 132066}, "done": false, "episodes_total": 66, "training_iteration": 11, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-15-50", "timestamp": 1690827350, "time_this_iter_s": 73.06439161300659, "time_total_s": 699.022207736969, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 699.022207736969, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.96476190476191, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.926465116526864, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8397599676652272, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0867051488616433, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.6705148861636, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1166.7083333333333, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5830626353489922, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3276346728699713, "mean_inference_ms": 6.217020730404396, "mean_action_processing_ms": 0.30271392030869737, "mean_env_wait_ms": 6.870362885176999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 144072, "agent_timesteps_total": 144072, "timers": {"sample_time_ms": 33334.442, "sample_throughput": 360.168, "load_time_ms": 7.402, "load_throughput": 1621902.017, "learn_time_ms": 30800.413, "learn_throughput": 389.8, "update_time_ms": 17.751}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0018337717046961188, "policy_loss": -0.003908577840775251, "vf_loss": 0.002074460033327341, "vf_explained_var": 0.6682015061378479, "kl": 0.0035655100364238024, "entropy": 2.6777637004852295, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 144072, "num_agent_steps_sampled": 144072, "num_steps_trained": 144072, "num_agent_steps_trained": 144072}, "done": false, "episodes_total": 72, "training_iteration": 12, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-16-54", "timestamp": 1690827414, "time_this_iter_s": 63.80241513252258, "time_total_s": 762.8246228694916, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 762.8246228694916, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.97912087912088, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.929085201553315, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.843863768011222, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0852214335420984, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.52214335420916, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1177.0, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5882058970514742, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3264074391340692, "mean_inference_ms": 6.233296188607528, "mean_action_processing_ms": 0.3038847124399797, "mean_env_wait_ms": 6.891148995792477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 156078, "agent_timesteps_total": 156078, "timers": {"sample_time_ms": 33443.429, "sample_throughput": 358.994, "load_time_ms": 7.552, "load_throughput": 1589857.037, "learn_time_ms": 30550.115, "learn_throughput": 392.994, "update_time_ms": 16.985}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0013038171455264091, "policy_loss": -0.0008287057280540466, "vf_loss": 0.0021324348635971546, "vf_explained_var": 0.6426658630371094, "kl": 0.0018152142874896526, "entropy": 2.6465158462524414, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 156078, "num_agent_steps_sampled": 156078, "num_steps_trained": 156078, "num_agent_steps_trained": 156078}, "done": false, "episodes_total": 78, "training_iteration": 13, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-17-57", "timestamp": 1690827477, "time_this_iter_s": 63.3555474281311, "time_total_s": 826.1801702976227, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 826.1801702976227, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 99.97333333333331, "ram_util_percent": 47.43444444444443}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.92380457567801, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8396695597648316, "reward_component_totals/dist_change_reward_min": -0.9910339589415863, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0841350159131853, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.41350159131775, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1160.797619047619, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5801087551462364, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3251746134165354, "mean_inference_ms": 6.248388272344226, "mean_action_processing_ms": 0.30492104453380636, "mean_env_wait_ms": 6.909820152855774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 168084, "agent_timesteps_total": 168084, "timers": {"sample_time_ms": 33650.958, "sample_throughput": 356.78, "load_time_ms": 7.54, "load_throughput": 1592411.024, "learn_time_ms": 30733.99, "learn_throughput": 390.642, "update_time_ms": 17.218}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0035059130750596523, "policy_loss": 0.000934613635763526, "vf_loss": 0.0025712994392961264, "vf_explained_var": 0.28748100996017456, "kl": 1.882054675661493e-05, "entropy": 2.7926480770111084, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 168084, "num_agent_steps_sampled": 168084, "num_steps_trained": 168084, "num_agent_steps_trained": 168084}, "done": false, "episodes_total": 84, "training_iteration": 14, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-19-02", "timestamp": 1690827542, "time_this_iter_s": 64.47060823440552, "time_total_s": 890.6507785320282, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 890.6507785320282, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.97065217391301, "ram_util_percent": 47.39999999999997}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9232725991668493, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8404968579589217, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0827757412079344, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.27757412079268, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1156.9666666666667, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5781942362152257, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3236672405369632, "mean_inference_ms": 6.263403536082382, "mean_action_processing_ms": 0.30585441529893387, "mean_env_wait_ms": 6.926825508465847, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 180090, "agent_timesteps_total": 180090, "timers": {"sample_time_ms": 33658.017, "sample_throughput": 356.706, "load_time_ms": 7.624, "load_throughput": 1574797.081, "learn_time_ms": 30513.745, "learn_throughput": 393.462, "update_time_ms": 17.84}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00036449506296776235, "policy_loss": -0.0017731674015522003, "vf_loss": 0.0021376428194344044, "vf_explained_var": 0.63948655128479, "kl": 0.0016122880624607205, "entropy": 2.7188451290130615, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 180090, "num_agent_steps_sampled": 180090, "num_steps_trained": 180090, "num_agent_steps_trained": 180090}, "done": false, "episodes_total": 90, "training_iteration": 15, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-20-03", "timestamp": 1690827603, "time_this_iter_s": 60.9595091342926, "time_total_s": 951.6102876663208, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 951.6102876663208, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.9758620689655, "ram_util_percent": 47.39999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.919688269014902, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8382534709486084, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.081434798066301, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.008838313718641, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.14347980662933, "delta_v_total_min": 200.8838313718632, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1160.6979166666667, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1969, "constraint_violation.max_vel_constraint.ratio_mean": 0.5800589288688989, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.984007996001999}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3223284561244462, "mean_inference_ms": 6.2764797338276965, "mean_action_processing_ms": 0.30669017971107176, "mean_env_wait_ms": 6.94263443479014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 192096, "agent_timesteps_total": 192096, "timers": {"sample_time_ms": 33679.513, "sample_throughput": 356.478, "load_time_ms": 7.996, "load_throughput": 1501409.19, "learn_time_ms": 30435.52, "learn_throughput": 394.473, "update_time_ms": 18.33}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017911437898874283, "policy_loss": 2.4877168470993638e-05, "vf_loss": 0.0017662594327703118, "vf_explained_var": 0.8042458891868591, "kl": 0.0016015133587643504, "entropy": 2.566826820373535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 192096, "num_agent_steps_sampled": 192096, "num_steps_trained": 192096, "num_agent_steps_trained": 192096}, "done": false, "episodes_total": 96, "training_iteration": 16, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-21-06", "timestamp": 1690827666, "time_this_iter_s": 63.057013511657715, "time_total_s": 1014.6673011779785, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1014.6673011779785, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.97362637362636, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.918627767860408, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8391336991091758, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0794940687512398, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.006814845552053, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.94940687512317, "delta_v_total_min": 200.68148455520458, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1155.49, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1969, "constraint_violation.max_vel_constraint.ratio_mean": 0.5774562718640679, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.984007996001999}, "hist_stats": {"episode_reward": [-3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.036858223132495, -3.981496782317075, -4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2729180161797296, "mean_inference_ms": 6.3212153801188276, "mean_action_processing_ms": 0.30796482357269, "mean_env_wait_ms": 6.968222517921486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 204102, "agent_timesteps_total": 204102, "timers": {"sample_time_ms": 33815.148, "sample_throughput": 355.048, "load_time_ms": 8.119, "load_throughput": 1478777.606, "learn_time_ms": 30266.592, "learn_throughput": 396.675, "update_time_ms": 17.455}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012235537869855762, "policy_loss": -0.0008590810466557741, "vf_loss": 0.002082634950056672, "vf_explained_var": 0.5076904296875, "kl": 0.00039610249223187566, "entropy": 2.691194772720337, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 204102, "num_agent_steps_sampled": 204102, "num_steps_trained": 204102, "num_agent_steps_trained": 204102}, "done": false, "episodes_total": 102, "training_iteration": 17, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-22-10", "timestamp": 1690827730, "time_this_iter_s": 63.72094368934631, "time_total_s": 1078.3882448673248, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1078.3882448673248, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.96593406593404, "ram_util_percent": 47.42967032967032}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.9148002957150494, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8374100075806363, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0773902881344193, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.006814845552053, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73902881344122, "delta_v_total_min": 200.68148455520458, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1146.62, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1969, "constraint_violation.max_vel_constraint.ratio_mean": 0.5730234882558719, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.984007996001999}, "hist_stats": {"episode_reward": [-4.00376336042405, -3.9186321837487075, -3.8729840893891545, -3.8847163380519767, -3.8994395582362356, -4.026674120888563, -3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2632674664512904, "mean_inference_ms": 6.359642649547598, "mean_action_processing_ms": 0.31007558546854985, "mean_env_wait_ms": 7.002732016651977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 216108, "agent_timesteps_total": 216108, "timers": {"sample_time_ms": 33925.145, "sample_throughput": 353.897, "load_time_ms": 8.126, "load_throughput": 1477445.636, "learn_time_ms": 30642.751, "learn_throughput": 391.806, "update_time_ms": 17.058}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0005658956943079829, "policy_loss": -0.001307421363890171, "vf_loss": 0.0018733178731054068, "vf_explained_var": 0.6443800330162048, "kl": 0.00041716304258443415, "entropy": 2.6555562019348145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 216108, "num_agent_steps_sampled": 216108, "num_steps_trained": 216108, "num_agent_steps_trained": 216108}, "done": false, "episodes_total": 108, "training_iteration": 18, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-23-17", "timestamp": 1690827797, "time_this_iter_s": 66.77047681808472, "time_total_s": 1145.1587216854095, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1145.1587216854095, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.97127659574467, "ram_util_percent": 47.39999999999996}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.917028677847968, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8398095190798145, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0772191587681603, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.006814845552053, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72191587681536, "delta_v_total_min": 200.68148455520458, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1128.44, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1979, "constraint_violation.max_vel_constraint.ratio_mean": 0.5639380309845078, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9890054972513743}, "hist_stats": {"episode_reward": [-3.885558831579771, -3.7703374186084853, -3.7862586383645676, -3.9651817409839225, -3.8463000995325873, -3.9129174194390983, -3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2628271560777526, "mean_inference_ms": 6.391287321248209, "mean_action_processing_ms": 0.31194713244155464, "mean_env_wait_ms": 7.038700362605616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 228114, "agent_timesteps_total": 228114, "timers": {"sample_time_ms": 33760.709, "sample_throughput": 355.62, "load_time_ms": 8.133, "load_throughput": 1476133.371, "learn_time_ms": 30640.291, "learn_throughput": 391.837, "update_time_ms": 18.081}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.001889673643745482, "policy_loss": -0.0005842127138748765, "vf_loss": 0.0024738875217735767, "vf_explained_var": 0.6081196069717407, "kl": 0.0007136297645047307, "entropy": 2.6703381538391113, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 228114, "num_agent_steps_sampled": 228114, "num_steps_trained": 228114, "num_agent_steps_trained": 228114}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-24-19", "timestamp": 1690827859, "time_this_iter_s": 62.04813051223755, "time_total_s": 1207.206852197647, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1207.206852197647, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.96136363636361, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.0984092789887265, "episode_reward_mean": -3.92208565373014, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454264859625791, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0766591677675676, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -2.006814845552053, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66591677675606, "delta_v_total_min": 200.68148455520458, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1118.17, "constraint_violation.max_vel_constraint.steps_min": 369, "constraint_violation.max_vel_constraint.steps_max": 1979, "constraint_violation.max_vel_constraint.ratio_mean": 0.5588055972013992, "constraint_violation.max_vel_constraint.ratio_min": 0.18440779610194902, "constraint_violation.max_vel_constraint.ratio_max": 0.9890054972513743}, "hist_stats": {"episode_reward": [-3.8850470217519275, -4.018417116069102, -3.888030388741735, -3.9456608852987465, -4.05237966817772, -3.8721531974741414, -4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2650903005714365, "mean_inference_ms": 6.4142105654342, "mean_action_processing_ms": 0.3133897027397578, "mean_env_wait_ms": 7.06257936861521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 240120, "agent_timesteps_total": 240120, "timers": {"sample_time_ms": 33625.953, "sample_throughput": 357.046, "load_time_ms": 8.785, "load_throughput": 1366649.944, "learn_time_ms": 30803.298, "learn_throughput": 389.763, "update_time_ms": 17.776}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0001869505358627066, "policy_loss": -0.0018327002180740237, "vf_loss": 0.0020196514669805765, "vf_explained_var": 0.5509804487228394, "kl": 0.0023959169629961252, "entropy": 2.632722854614258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 240120, "num_agent_steps_sampled": 240120, "num_steps_trained": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 120, "training_iteration": 20, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-25-24", "timestamp": 1690827924, "time_this_iter_s": 64.18237853050232, "time_total_s": 1271.3892307281494, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1271.3892307281494, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.9782608695652, "ram_util_percent": 47.44021739130433}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.9203073907956925, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8458637509038525, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.074443639891846, "reward_component_totals/delta_v_min": -2.1814488788445767, "reward_component_totals/delta_v_max": -1.995153729716942, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44436398918396, "delta_v_total_min": 199.51537297169358, "delta_v_total_max": 218.14488788445675, "constraint_violation.max_vel_constraint.steps_mean": 1124.62, "constraint_violation.max_vel_constraint.steps_min": 378, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5620289855072463, "constraint_violation.max_vel_constraint.ratio_min": 0.1889055472263868, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-4.0984092789887265, -4.035255679195737, -3.9142404618736153, -3.89912656444039, -3.959841336809893, -3.9497516440462777, -3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2719516883690734, "mean_inference_ms": 6.430888711948374, "mean_action_processing_ms": 0.31454014316492473, "mean_env_wait_ms": 7.0828329050982735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 252126, "agent_timesteps_total": 252126, "timers": {"sample_time_ms": 33489.921, "sample_throughput": 358.496, "load_time_ms": 8.469, "load_throughput": 1417683.136, "learn_time_ms": 30630.204, "learn_throughput": 391.966, "update_time_ms": 17.596}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0003189236740581691, "policy_loss": -0.0021371159236878157, "vf_loss": 0.0018181910272687674, "vf_explained_var": 0.7063984274864197, "kl": 0.0014449791051447392, "entropy": 2.5340099334716797, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 252126, "num_agent_steps_sampled": 252126, "num_steps_trained": 252126, "num_agent_steps_trained": 252126}, "done": false, "episodes_total": 126, "training_iteration": 21, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-26-34", "timestamp": 1690827994, "time_this_iter_s": 69.9938337802887, "time_total_s": 1341.383064508438, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1341.383064508438, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.973, "ram_util_percent": 47.450999999999986}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.915445184239805, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8469525789544613, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0684926052853503, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.84926052853427, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1121.26, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5603498250874562, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.901637825819289, -3.8126472809431453, -3.943030019698273, -3.8491005089641734, -4.018303126500736, -3.8628297114732075, -3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2794416622588376, "mean_inference_ms": 6.442525719916124, "mean_action_processing_ms": 0.3155632547252526, "mean_env_wait_ms": 7.102657075419887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 264132, "agent_timesteps_total": 264132, "timers": {"sample_time_ms": 33478.513, "sample_throughput": 358.618, "load_time_ms": 9.144, "load_throughput": 1312948.162, "learn_time_ms": 30494.832, "learn_throughput": 393.706, "update_time_ms": 16.867}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0014090947806835175, "policy_loss": -0.0008692835690453649, "vf_loss": 0.002278377301990986, "vf_explained_var": 0.5048862099647522, "kl": 0.000491255777888, "entropy": 2.652177333831787, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 264132, "num_agent_steps_sampled": 264132, "num_steps_trained": 264132, "num_agent_steps_trained": 264132}, "done": false, "episodes_total": 132, "training_iteration": 22, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-27-36", "timestamp": 1690828056, "time_this_iter_s": 62.33669137954712, "time_total_s": 1403.7197558879852, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1403.7197558879852, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.97078651685393, "ram_util_percent": 47.45056179775281}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.918228127188017, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8531063037097784, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.065121823478245, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.51218234782382, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1102.63, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.55103948025987, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.854359013629108, -3.9962614335010276, -3.9747679577408976, -4.039878077213011, -3.9425695870683075, -3.8965793594094293, -3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2867786660487581, "mean_inference_ms": 6.452023279025943, "mean_action_processing_ms": 0.3162924096915977, "mean_env_wait_ms": 7.118548150053353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 276138, "agent_timesteps_total": 276138, "timers": {"sample_time_ms": 33298.453, "sample_throughput": 360.557, "load_time_ms": 9.078, "load_throughput": 1322568.978, "learn_time_ms": 30416.366, "learn_throughput": 394.722, "update_time_ms": 18.118}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 1.0000000116860974e-07, "total_loss": 8.888183947419748e-05, "policy_loss": -0.002454533940181136, "vf_loss": 0.002543414942920208, "vf_explained_var": 0.4846314787864685, "kl": 0.0007146783755160868, "entropy": 2.62630558013916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 276138, "num_agent_steps_sampled": 276138, "num_steps_trained": 276138, "num_agent_steps_trained": 276138}, "done": false, "episodes_total": 138, "training_iteration": 23, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-28-37", "timestamp": 1690828117, "time_this_iter_s": 60.797977685928345, "time_total_s": 1464.5177335739136, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1464.5177335739136, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.96551724137929, "ram_util_percent": 47.45632183908046}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.9166771619476424, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.854435079292712, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0622420826549366, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.22420826549293, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1085.33, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5423938030984508, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.9157495771944735, -3.870644396698675, -3.9796796704899515, -4.024039544320996, -3.8730199795409606, -3.8909450302731323, -3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2941636173609397, "mean_inference_ms": 6.4619619129603425, "mean_action_processing_ms": 0.3169937980248853, "mean_env_wait_ms": 7.133041867455727, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 288144, "agent_timesteps_total": 288144, "timers": {"sample_time_ms": 33203.131, "sample_throughput": 361.592, "load_time_ms": 9.305, "load_throughput": 1290277.31, "learn_time_ms": 30399.275, "learn_throughput": 394.944, "update_time_ms": 18.065}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00037885678466409445, "policy_loss": -0.0027042326983064413, "vf_loss": 0.002325373934581876, "vf_explained_var": 0.39062705636024475, "kl": 0.0022091527935117483, "entropy": 2.6766083240509033, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 288144, "num_agent_steps_sampled": 288144, "num_steps_trained": 288144, "num_agent_steps_trained": 288144}, "done": false, "episodes_total": 144, "training_iteration": 24, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-29-41", "timestamp": 1690828181, "time_this_iter_s": 63.39173150062561, "time_total_s": 1527.9094650745392, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1527.9094650745392, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.97362637362636, "ram_util_percent": 47.43846153846153}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.91243412844687, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8544209908301598, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.058013137616717, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.80131376167105, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1081.17, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5403148425787105, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.9023039345641086, -3.9633891446267997, -3.9857381776012835, -3.936699695462141, -3.7988418007591003, -4.0028353324344295, -3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3009467415761815, "mean_inference_ms": 6.469853037521241, "mean_action_processing_ms": 0.3174552449582603, "mean_env_wait_ms": 7.145420034051026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 300150, "agent_timesteps_total": 300150, "timers": {"sample_time_ms": 33242.69, "sample_throughput": 361.162, "load_time_ms": 9.187, "load_throughput": 1306842.251, "learn_time_ms": 30682.479, "learn_throughput": 391.298, "update_time_ms": 18.71}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00031519480398856103, "policy_loss": -0.0015843692235648632, "vf_loss": 0.0018995634745806456, "vf_explained_var": 0.6069279909133911, "kl": 0.0015099388547241688, "entropy": 2.5127458572387695, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 300150, "num_agent_steps_sampled": 300150, "num_steps_trained": 300150, "num_agent_steps_trained": 300150}, "done": false, "episodes_total": 150, "training_iteration": 25, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-30-45", "timestamp": 1690828245, "time_this_iter_s": 64.2316575050354, "time_total_s": 1592.1411225795746, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1592.1411225795746, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 99.96593406593406, "ram_util_percent": 47.54285714285716}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.9100144251884785, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8538495009583034, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.0561649242301816, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.61649242301743, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1081.84, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5406496751624188, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.9061343001343216, -4.01410739124446, -4.034745086115558, -4.032302479487609, -3.943211517049206, -3.983760243769662, -3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3074714039863145, "mean_inference_ms": 6.476694757849555, "mean_action_processing_ms": 0.3176338569529239, "mean_env_wait_ms": 7.15485901941813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 312156, "agent_timesteps_total": 312156, "timers": {"sample_time_ms": 33280.607, "sample_throughput": 360.751, "load_time_ms": 8.713, "load_throughput": 1377988.924, "learn_time_ms": 30694.492, "learn_throughput": 391.145, "update_time_ms": 17.906}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0010611816542223096, "policy_loss": -0.0013196326326578856, "vf_loss": 0.0023808134719729424, "vf_explained_var": 0.3729691803455353, "kl": 0.0008200103184208274, "entropy": 2.68738055229187, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 312156, "num_agent_steps_sampled": 312156, "num_steps_trained": 312156, "num_agent_steps_trained": 312156}, "done": false, "episodes_total": 156, "training_iteration": 26, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-31-49", "timestamp": 1690828309, "time_this_iter_s": 63.502442836761475, "time_total_s": 1655.643565416336, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1655.643565416336, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.96304347826087, "ram_util_percent": 47.60000000000003}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6880571163370175, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.9039348946437555, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8500524301722995, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.611687133528181, "reward_component_totals/delta_v_mean": -2.053882464471463, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.38824644714566, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1118.85, "constraint_violation.max_vel_constraint.steps_min": 345, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5596159554011032, "constraint_violation.max_vel_constraint.ratio_min": 0.1724137931034483, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.9295687067921783, -3.8506258969182148, -4.028235560898772, -3.6880571163370175, -3.916273611406828, -3.9779508355249042, -3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.307952925200351, "mean_inference_ms": 6.484413039333645, "mean_action_processing_ms": 0.31776606844597965, "mean_env_wait_ms": 7.16311877869615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 324067, "agent_timesteps_total": 324067, "timers": {"sample_time_ms": 33163.599, "sample_throughput": 361.737, "load_time_ms": 8.399, "load_throughput": 1428278.552, "learn_time_ms": 30772.612, "learn_throughput": 389.843, "update_time_ms": 19.582}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0003383007424417883, "policy_loss": -0.0016070220153778791, "vf_loss": 0.0019453230779618025, "vf_explained_var": 0.6907446980476379, "kl": 0.003500221762806177, "entropy": 2.4169435501098633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 324067, "num_agent_steps_sampled": 324067, "num_steps_trained": 324067, "num_agent_steps_trained": 324067}, "done": false, "episodes_total": 162, "training_iteration": 27, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-32-53", "timestamp": 1690828373, "time_this_iter_s": 63.4175181388855, "time_total_s": 1719.0610835552216, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1719.0610835552216, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.97032967032966, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6900880210894904, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.905443168123502, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8524938138772465, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.052949354246262, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.29493542462555, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1110.91, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5556479394090992, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.7897575003074566, -4.085359098476635, -3.991171766843819, -3.780695227748577, -3.842486740287187, -4.0276088361256175, -3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.308389537045879, "mean_inference_ms": 6.492352268421022, "mean_action_processing_ms": 0.3178513914834262, "mean_env_wait_ms": 7.170529204612502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 336073, "agent_timesteps_total": 336073, "timers": {"sample_time_ms": 33085.2, "sample_throughput": 362.594, "load_time_ms": 8.151, "load_throughput": 1471759.869, "learn_time_ms": 30362.804, "learn_throughput": 395.105, "update_time_ms": 20.154}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0016571590676903725, "policy_loss": -0.0005415032501332462, "vf_loss": 0.0021986630745232105, "vf_explained_var": 0.5570525527000427, "kl": 0.0008131205686368048, "entropy": 2.5636215209960938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 336073, "num_agent_steps_sampled": 336073, "num_steps_trained": 336073, "num_agent_steps_trained": 336073}, "done": false, "episodes_total": 168, "training_iteration": 28, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-33-55", "timestamp": 1690828435, "time_this_iter_s": 61.85894465446472, "time_total_s": 1780.9200282096863, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1780.9200282096863, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.97241379310343, "ram_util_percent": 47.60000000000001}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6900880210894904, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.900949194900843, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8487142872354947, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0522349076653557, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.2234907665349, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1126.26, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5633191038268902, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.989086388586415, -3.909225333887827, -4.059027420041533, -3.935722612295729, -3.8448796643101835, -3.839471202579789, -3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.309268557668729, "mean_inference_ms": 6.499573979390617, "mean_action_processing_ms": 0.31794203408552, "mean_env_wait_ms": 7.176729782791054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 348079, "agent_timesteps_total": 348079, "timers": {"sample_time_ms": 33323.287, "sample_throughput": 360.003, "load_time_ms": 7.855, "load_throughput": 1527200.124, "learn_time_ms": 30313.519, "learn_throughput": 395.748, "update_time_ms": 20.918}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0011447523720562458, "policy_loss": -0.0011373469606041908, "vf_loss": 0.0022820995654910803, "vf_explained_var": 0.4703236520290375, "kl": 0.0024265863467007875, "entropy": 2.5746560096740723, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 348079, "num_agent_steps_sampled": 348079, "num_steps_trained": 348079, "num_agent_steps_trained": 348079}, "done": false, "episodes_total": 174, "training_iteration": 29, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-34-59", "timestamp": 1690828499, "time_this_iter_s": 63.971649169921875, "time_total_s": 1844.8916773796082, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1844.8916773796082, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.97252747252745, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6900880210894904, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.8985926391301144, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8497027933187908, "reward_component_totals/dist_change_reward_min": -0.9997473658007497, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0488898458113303, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.88898458113235, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1132.43, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.566402562097755, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.8957669561946737, -3.8172185632399476, -3.798225317234251, -3.9353769322355063, -4.0821298192324305, -3.8706989358399997, -3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3102732878453178, "mean_inference_ms": 6.505505701717026, "mean_action_processing_ms": 0.31791693780026326, "mean_env_wait_ms": 7.181018211122625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 360085, "agent_timesteps_total": 360085, "timers": {"sample_time_ms": 33220.371, "sample_throughput": 361.119, "load_time_ms": 6.915, "load_throughput": 1734750.819, "learn_time_ms": 30211.587, "learn_throughput": 397.083, "update_time_ms": 20.338}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 1.0000000116860974e-07, "total_loss": -5.216181671130471e-05, "policy_loss": -0.002018263563513756, "vf_loss": 0.0019661004189401865, "vf_explained_var": 0.5991531014442444, "kl": 0.002084910636767745, "entropy": 2.5574355125427246, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 360085, "num_agent_steps_sampled": 360085, "num_steps_trained": 360085, "num_agent_steps_trained": 360085}, "done": false, "episodes_total": 180, "training_iteration": 30, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-36-01", "timestamp": 1690828561, "time_this_iter_s": 62.051082134246826, "time_total_s": 1906.942759513855, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1906.942759513855, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 99.96853932584268, "ram_util_percent": 47.600000000000016}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.6900880210894904, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.894610239451648, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8485936706250159, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0460165688266385, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.60165688266326, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1161.99, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5811751757909084, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.8325765261760294, -3.827744652489705, -3.9625170369372773, -3.919282597388098, -3.8255441896499374, -3.9381076549254574, -3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3136576007727894, "mean_inference_ms": 6.5095126946673405, "mean_action_processing_ms": 0.31781651952215084, "mean_env_wait_ms": 7.183625789232562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 372091, "agent_timesteps_total": 372091, "timers": {"sample_time_ms": 33160.381, "sample_throughput": 361.772, "load_time_ms": 7.064, "load_throughput": 1698170.709, "learn_time_ms": 30284.791, "learn_throughput": 396.123, "update_time_ms": 22.328}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0008452312904410064, "policy_loss": -0.001304261269979179, "vf_loss": 0.0021494918037205935, "vf_explained_var": 0.4858337640762329, "kl": 0.0011775062885135412, "entropy": 2.650085687637329, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 372091, "num_agent_steps_sampled": 372091, "num_steps_trained": 372091, "num_agent_steps_trained": 372091}, "done": false, "episodes_total": 186, "training_iteration": 31, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-37-12", "timestamp": 1690828632, "time_this_iter_s": 70.11380648612976, "time_total_s": 1977.0565659999847, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1977.0565659999847, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.972, "ram_util_percent": 47.60000000000003}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.892379403705397, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8495586719070887, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.042820731798314, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.2820731798308, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1145.34, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5728543362106984, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.818280338211286, -3.7507043956369124, -4.020643900961653, -3.8422594210289334, -4.039049601418943, -3.7773432106061344, -3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167634581051246, "mean_inference_ms": 6.512162026430428, "mean_action_processing_ms": 0.3176720453618258, "mean_env_wait_ms": 7.184794079609826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 384097, "agent_timesteps_total": 384097, "timers": {"sample_time_ms": 32965.617, "sample_throughput": 363.909, "load_time_ms": 6.312, "load_throughput": 1900718.779, "learn_time_ms": 30608.133, "learn_throughput": 391.938, "update_time_ms": 22.542}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.000445549696451053, "policy_loss": -0.0023654953110963106, "vf_loss": 0.0019199494272470474, "vf_explained_var": 0.65334552526474, "kl": 0.0019704089500010014, "entropy": 2.5616626739501953, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 384097, "num_agent_steps_sampled": 384097, "num_steps_trained": 384097, "num_agent_steps_trained": 384097}, "done": false, "episodes_total": 192, "training_iteration": 32, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-38-15", "timestamp": 1690828695, "time_this_iter_s": 63.6772403717041, "time_total_s": 2040.7338063716888, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2040.7338063716888, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.96373626373625, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.890401755496404, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8504719648853383, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0399297906110716, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.9929790611065, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1151.32, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5758428419578249, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.7650713889566774, -3.8365913234651083, -4.006451909143921, -3.8445949886618145, -3.9434461236847023, -3.9406372772276788, -3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3195065987864043, "mean_inference_ms": 6.515122470290382, "mean_action_processing_ms": 0.3175271957932184, "mean_env_wait_ms": 7.185014399597353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 396103, "agent_timesteps_total": 396103, "timers": {"sample_time_ms": 32985.583, "sample_throughput": 363.689, "load_time_ms": 6.216, "load_throughput": 1929856.975, "learn_time_ms": 30839.832, "learn_throughput": 388.994, "update_time_ms": 22.653}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.000776817905716598, "policy_loss": -0.0014719152823090553, "vf_loss": 0.0022487337701022625, "vf_explained_var": 0.5573262572288513, "kl": 0.0012515058042481542, "entropy": 2.5386462211608887, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 396103, "num_agent_steps_sampled": 396103, "num_steps_trained": 396103, "num_agent_steps_trained": 396103}, "done": false, "episodes_total": 198, "training_iteration": 33, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-39-19", "timestamp": 1690828759, "time_this_iter_s": 63.336957693099976, "time_total_s": 2104.070764064789, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2104.070764064789, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.97582417582417, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.8901791998999844, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8496762261209461, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.040502973779046, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.0502973779039, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1170.13, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5852431418078998, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.875112469216731, -3.797350945472921, -3.793234085258449, -3.7976772457984107, -4.0204831736352835, -3.967542723029471, -4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3222882661684268, "mean_inference_ms": 6.517135313629044, "mean_action_processing_ms": 0.31739769017942066, "mean_env_wait_ms": 7.185450033697763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 408109, "agent_timesteps_total": 408109, "timers": {"sample_time_ms": 32799.359, "sample_throughput": 365.754, "load_time_ms": 6.532, "load_throughput": 1836519.744, "learn_time_ms": 30933.057, "learn_throughput": 387.821, "update_time_ms": 22.614}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00012797702220268548, "policy_loss": -0.002032301388680935, "vf_loss": 0.001904322998598218, "vf_explained_var": 0.7170240879058838, "kl": 0.0025644907727837563, "entropy": 2.34958553314209, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 408109, "num_agent_steps_sampled": 408109, "num_steps_trained": 408109, "num_agent_steps_trained": 408109}, "done": false, "episodes_total": 204, "training_iteration": 34, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-40-22", "timestamp": 1690828822, "time_this_iter_s": 62.43654727935791, "time_total_s": 2166.5073113441467, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2166.5073113441467, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.96741573033707, "ram_util_percent": 47.600000000000016}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.887673529612523, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8499662136813044, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0377073159312236, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.77073159312175, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1186.91, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5936289489043517, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-4.000704940885791, -3.8339684087704797, -3.96686790213475, -4.0394807155748875, -3.982199887419407, -3.8674524306676714, -3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3248418120587784, "mean_inference_ms": 6.519381803035063, "mean_action_processing_ms": 0.3172225563452154, "mean_env_wait_ms": 7.18480887949229, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 420115, "agent_timesteps_total": 420115, "timers": {"sample_time_ms": 32630.223, "sample_throughput": 367.65, "load_time_ms": 6.756, "load_throughput": 1775725.859, "learn_time_ms": 30880.063, "learn_throughput": 388.487, "update_time_ms": 22.508}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0004918558988720179, "policy_loss": -0.003020196221768856, "vf_loss": 0.002528340322896838, "vf_explained_var": 0.37053415179252625, "kl": 0.002263670088723302, "entropy": 2.6645405292510986, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 420115, "num_agent_steps_sampled": 420115, "num_steps_trained": 420115, "num_agent_steps_trained": 420115}, "done": false, "episodes_total": 210, "training_iteration": 35, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-41-24", "timestamp": 1690828884, "time_this_iter_s": 61.964630126953125, "time_total_s": 2228.4719414711, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2228.4719414711, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.975, "ram_util_percent": 47.600000000000016}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.1111787610356965, "episode_reward_mean": -3.886839879912868, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8489313360514624, "reward_component_totals/dist_change_reward_min": -0.9968870606700876, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0379085438614113, "reward_component_totals/delta_v_min": -2.1731091775496685, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.7908543861406, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 217.31091775496574, "constraint_violation.max_vel_constraint.steps_mean": 1196.76, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1988, "constraint_violation.max_vel_constraint.ratio_mean": 0.5985514876349862, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.993503248375812}, "hist_stats": {"episode_reward": [-3.998992045599569, -4.041133409955135, -3.7983557463790554, -3.9841182167047835, -4.1111787610356965, -3.9821966091315475, -3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3271932923460008, "mean_inference_ms": 6.520840881049553, "mean_action_processing_ms": 0.3170711079348168, "mean_env_wait_ms": 7.184194117415435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 432121, "agent_timesteps_total": 432121, "timers": {"sample_time_ms": 32427.999, "sample_throughput": 369.943, "load_time_ms": 6.761, "load_throughput": 1774323.232, "learn_time_ms": 31093.48, "learn_throughput": 385.82, "update_time_ms": 24.557}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0013026518281549215, "policy_loss": -0.0007143786642700434, "vf_loss": 0.0020170286297798157, "vf_explained_var": 0.6707977652549744, "kl": 0.0007488963310606778, "entropy": 2.5347561836242676, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 432121, "num_agent_steps_sampled": 432121, "num_steps_trained": 432121, "num_agent_steps_trained": 432121}, "done": false, "episodes_total": 216, "training_iteration": 36, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-42-28", "timestamp": 1690828948, "time_this_iter_s": 63.68667650222778, "time_total_s": 2292.1586179733276, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2292.1586179733276, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.97802197802197, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.060867505828203, "episode_reward_mean": -3.880914076011446, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8438161741868339, "reward_component_totals/dist_change_reward_min": -0.9968466991959017, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0370979018246165, "reward_component_totals/delta_v_min": -2.148249782472847, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.709790182461, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 214.8249782472831, "constraint_violation.max_vel_constraint.steps_mean": 1198.01, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.5991761752911582, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.86078014424354, -3.829097789160929, -3.8425204130255155, -3.8580882674713166, -4.001181582119816, -3.9434429609145116, -3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326174405085093, "mean_inference_ms": 6.523221015602753, "mean_action_processing_ms": 0.31686667620149317, "mean_env_wait_ms": 7.1824436162399605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 444127, "agent_timesteps_total": 444127, "timers": {"sample_time_ms": 32209.636, "sample_throughput": 372.746, "load_time_ms": 7.096, "load_throughput": 1692023.326, "learn_time_ms": 31117.479, "learn_throughput": 385.828, "update_time_ms": 23.296}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0014605913311243057, "policy_loss": -0.0036110978107899427, "vf_loss": 0.0021505081094801426, "vf_explained_var": 0.5907609462738037, "kl": 0.0023117654491215944, "entropy": 2.57997989654541, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 444127, "num_agent_steps_sampled": 444127, "num_steps_trained": 444127, "num_agent_steps_trained": 444127}, "done": false, "episodes_total": 222, "training_iteration": 37, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-43-29", "timestamp": 1690829009, "time_this_iter_s": 61.39140701293945, "time_total_s": 2353.550024986267, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2353.550024986267, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.96896551724134, "ram_util_percent": 47.58045977011494}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.060867505828203, "episode_reward_mean": -3.879397692656521, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8410923368876237, "reward_component_totals/dist_change_reward_min": -0.9968466991959017, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0383053557689026, "reward_component_totals/delta_v_min": -2.148249782472847, "reward_component_totals/delta_v_max": -1.9469147943953697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.83053557688967, "delta_v_total_min": 194.69147943953644, "delta_v_total_max": 214.8249782472831, "constraint_violation.max_vel_constraint.steps_mean": 1210.12, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6052281493041517, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.8573231025551458, -3.7077890392856743, -3.9619720860701744, -3.8986955388205686, -3.9160333221652457, -4.032189949814128, -3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3251521948787797, "mean_inference_ms": 6.5250078518612336, "mean_action_processing_ms": 0.31666514765136894, "mean_env_wait_ms": 7.18076991460089, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 456133, "agent_timesteps_total": 456133, "timers": {"sample_time_ms": 32162.54, "sample_throughput": 373.291, "load_time_ms": 7.428, "load_throughput": 1616233.124, "learn_time_ms": 31376.764, "learn_throughput": 382.64, "update_time_ms": 22.551}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 1.0000000116860974e-07, "total_loss": 3.8633665099041536e-05, "policy_loss": -0.0020900643430650234, "vf_loss": 0.0021286981645971537, "vf_explained_var": 0.49256011843681335, "kl": 0.0012571933912113309, "entropy": 2.595954179763794, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 456133, "num_agent_steps_sampled": 456133, "num_steps_trained": 456133, "num_agent_steps_trained": 456133}, "done": false, "episodes_total": 228, "training_iteration": 38, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-44-33", "timestamp": 1690829073, "time_this_iter_s": 64.01531648635864, "time_total_s": 2417.5653414726257, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2417.5653414726257, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.97391304347826, "ram_util_percent": 47.60108695652177}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.060867505828203, "episode_reward_mean": -3.8813515514281347, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840615106307167, "reward_component_totals/dist_change_reward_min": -0.9968466991959017, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0407364451209733, "reward_component_totals/delta_v_min": -2.148249782472847, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.07364451209676, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 214.8249782472831, "constraint_violation.max_vel_constraint.steps_mean": 1243.68, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6219997634970552, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.974411020656844, -3.904184598104386, -4.033803833849349, -3.8052200436301127, -3.9771384208411336, -3.997805801052735, -3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3242455465209657, "mean_inference_ms": 6.526562134068073, "mean_action_processing_ms": 0.3165268721568228, "mean_env_wait_ms": 7.179590723175556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 468139, "agent_timesteps_total": 468139, "timers": {"sample_time_ms": 32090.213, "sample_throughput": 374.133, "load_time_ms": 7.168, "load_throughput": 1674987.155, "learn_time_ms": 31375.511, "learn_throughput": 382.655, "update_time_ms": 22.376}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 1.0000000116860974e-07, "total_loss": 6.253448373172432e-05, "policy_loss": -0.0020166519097983837, "vf_loss": 0.0020791864953935146, "vf_explained_var": 0.6357086300849915, "kl": 0.0007631105836480856, "entropy": 2.49049711227417, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 468139, "num_agent_steps_sampled": 468139, "num_steps_trained": 468139, "num_agent_steps_trained": 468139}, "done": false, "episodes_total": 234, "training_iteration": 39, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-45-37", "timestamp": 1690829137, "time_this_iter_s": 63.18090343475342, "time_total_s": 2480.746244907379, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2480.746244907379, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.97, "ram_util_percent": 47.64333333333333}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.060867505828203, "episode_reward_mean": -3.882140341371252, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8415777476941112, "reward_component_totals/dist_change_reward_min": -0.9968466991959017, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0405625936771465, "reward_component_totals/delta_v_min": -2.148249782472847, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.056259367714, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 214.8249782472831, "constraint_violation.max_vel_constraint.steps_mean": 1258.08, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6291961652961556, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.968344282693275, -3.7588943331834623, -4.004199294823216, -3.8429367719304888, -3.852079262378501, -3.8109659461718, -3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3234614914041247, "mean_inference_ms": 6.528438534185457, "mean_action_processing_ms": 0.31645473632820587, "mean_env_wait_ms": 7.179602215080466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 480145, "agent_timesteps_total": 480145, "timers": {"sample_time_ms": 32315.044, "sample_throughput": 371.53, "load_time_ms": 7.132, "load_throughput": 1683448.072, "learn_time_ms": 31375.458, "learn_throughput": 382.656, "update_time_ms": 25.684}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0010644905269145966, "policy_loss": -0.0015151090919971466, "vf_loss": 0.002579598920419812, "vf_explained_var": 0.39587563276290894, "kl": 0.002116086659952998, "entropy": 2.6724464893341064, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 480145, "num_agent_steps_sampled": 480145, "num_steps_trained": 480145, "num_agent_steps_trained": 480145}, "done": false, "episodes_total": 240, "training_iteration": 40, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-46-41", "timestamp": 1690829201, "time_this_iter_s": 64.35180068016052, "time_total_s": 2545.0980455875397, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2545.0980455875397, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.96956521739129, "ram_util_percent": 47.5195652173913}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.073229694448728, "episode_reward_mean": -3.888552993305094, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.843622798612287, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.044930194692813, "reward_component_totals/delta_v_min": -2.148249782472847, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.4930194692807, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 214.8249782472831, "constraint_violation.max_vel_constraint.steps_mean": 1282.4, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6413500883346365, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.839108959819524, -3.8843466723388103, -3.962896379208579, -3.7803776285237705, -3.9384553074824096, -4.00639890679866, -3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3246163195132636, "mean_inference_ms": 6.528733056745782, "mean_action_processing_ms": 0.31640025956822326, "mean_env_wait_ms": 7.179476305534417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 492151, "agent_timesteps_total": 492151, "timers": {"sample_time_ms": 32404.897, "sample_throughput": 370.5, "load_time_ms": 6.806, "load_throughput": 1763971.984, "learn_time_ms": 31308.864, "learn_throughput": 383.47, "update_time_ms": 22.562}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00031846208730712533, "policy_loss": -0.0021883826702833176, "vf_loss": 0.0025068449322134256, "vf_explained_var": 0.5599247217178345, "kl": 0.0005267614615149796, "entropy": 2.672872304916382, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 492151, "num_agent_steps_sampled": 492151, "num_steps_trained": 492151, "num_agent_steps_trained": 492151}, "done": false, "episodes_total": 246, "training_iteration": 41, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-47-52", "timestamp": 1690829272, "time_this_iter_s": 70.30516624450684, "time_total_s": 2615.4032118320465, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2615.4032118320465, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.97425742574256, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.891190333220278, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8433170572031722, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.6897248537038125, "reward_component_totals/delta_v_mean": -2.0478732760171128, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.78732760171061, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1277.46, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6388813227174451, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.764100763469372, -3.7799024879479366, -3.8278173780551685, -4.031162915855125, -3.924958674923807, -3.8168691502004917, -3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3256793928868162, "mean_inference_ms": 6.528310444333811, "mean_action_processing_ms": 0.31632713223628256, "mean_env_wait_ms": 7.178440664551665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 504157, "agent_timesteps_total": 504157, "timers": {"sample_time_ms": 32424.838, "sample_throughput": 370.272, "load_time_ms": 9.261, "load_throughput": 1296422.611, "learn_time_ms": 31103.922, "learn_throughput": 385.996, "update_time_ms": 24.61}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00031476200092583895, "policy_loss": -0.0017900810344144702, "vf_loss": 0.002104843268170953, "vf_explained_var": 0.6657264232635498, "kl": 0.0006176445167511702, "entropy": 2.6156539916992188, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 504157, "num_agent_steps_sampled": 504157, "num_steps_trained": 504157, "num_agent_steps_trained": 504157}, "done": false, "episodes_total": 252, "training_iteration": 42, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-48-53", "timestamp": 1690829333, "time_this_iter_s": 61.81479597091675, "time_total_s": 2677.2180078029633, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2677.2180078029633, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.97386363636362, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.892987015344261, "episode_len_mean": 2000.05, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844785052889648, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.7075563713045351, "reward_component_totals/delta_v_mean": -2.04820196245462, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.82019624546135, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1270.4, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1974, "constraint_violation.max_vel_constraint.ratio_mean": 0.6353530868353862, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9910807974816369}, "hist_stats": {"episode_reward": [-3.9818872882451015, -3.918758789803552, -3.6900880210894904, -3.973746039066026, -4.0435993827934045, -3.9204531468052233, -3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816], "episode_lengths": [2001, 1906, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.32664948568204, "mean_inference_ms": 6.52815951557953, "mean_action_processing_ms": 0.3162919925220929, "mean_env_wait_ms": 7.177074663361824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 516163, "agent_timesteps_total": 516163, "timers": {"sample_time_ms": 32511.743, "sample_throughput": 369.282, "load_time_ms": 9.096, "load_throughput": 1319961.988, "learn_time_ms": 31106.732, "learn_throughput": 385.961, "update_time_ms": 24.118}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0007956530316732824, "policy_loss": -0.0030226982198655605, "vf_loss": 0.0022270451299846172, "vf_explained_var": 0.518417477607727, "kl": 0.0016835713759064674, "entropy": 2.63036847114563, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 516163, "num_agent_steps_sampled": 516163, "num_steps_trained": 516163, "num_agent_steps_trained": 516163}, "done": false, "episodes_total": 258, "training_iteration": 43, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-49-58", "timestamp": 1690829398, "time_this_iter_s": 64.25183463096619, "time_total_s": 2741.4698424339294, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2741.4698424339294, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.97173913043478, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.680686361171622, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.893306402421967, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8468463077430713, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.7075563713045351, "reward_component_totals/delta_v_mean": -2.0464600946789018, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.64600946788957, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1246.68, "constraint_violation.max_vel_constraint.steps_min": 330, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6230284857571214, "constraint_violation.max_vel_constraint.ratio_min": 0.16491754122938532, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.7887046599474634, -3.9912673437530017, -3.886347180957549, -3.9111673615959006, -3.929294876866501, -3.7328556697627144, -3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3275145597318327, "mean_inference_ms": 6.527440888984579, "mean_action_processing_ms": 0.3162175264760288, "mean_env_wait_ms": 7.174202117836964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 528169, "agent_timesteps_total": 528169, "timers": {"sample_time_ms": 32654.169, "sample_throughput": 367.671, "load_time_ms": 8.537, "load_throughput": 1406402.772, "learn_time_ms": 30808.447, "learn_throughput": 389.698, "update_time_ms": 25.362}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015865298919379711, "policy_loss": -0.0008638607687316835, "vf_loss": 0.0024503914173692465, "vf_explained_var": 0.43775811791419983, "kl": 0.001158219063654542, "entropy": 2.6834306716918945, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 528169, "num_agent_steps_sampled": 528169, "num_steps_trained": 528169, "num_agent_steps_trained": 528169}, "done": false, "episodes_total": 264, "training_iteration": 44, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-50-59", "timestamp": 1690829459, "time_this_iter_s": 60.891430377960205, "time_total_s": 2802.3612728118896, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2802.3612728118896, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.97126436781608, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.58610081833174, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.892932945122768, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442781436408086, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.5009248710331387, "reward_component_totals/delta_v_mean": -2.0486548014819648, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.8654801481959, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1235.63, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6175062468765617, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.9420819359192842, -3.7657258002251552, -3.845855958169627, -3.8518676065801922, -3.7952673666313848, -3.955116758945715, -3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3283453294930092, "mean_inference_ms": 6.5256717961448745, "mean_action_processing_ms": 0.31610888597867975, "mean_env_wait_ms": 7.170193004048067, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 540175, "agent_timesteps_total": 540175, "timers": {"sample_time_ms": 32512.897, "sample_throughput": 369.269, "load_time_ms": 8.548, "load_throughput": 1404531.653, "learn_time_ms": 30885.21, "learn_throughput": 388.73, "update_time_ms": 25.127}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00029665298643521965, "policy_loss": -0.0019106834661215544, "vf_loss": 0.0022073364816606045, "vf_explained_var": 0.6653729677200317, "kl": 0.001515490235760808, "entropy": 2.585561752319336, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 540175, "num_agent_steps_sampled": 540175, "num_steps_trained": 540175, "num_agent_steps_trained": 540175}, "done": false, "episodes_total": 270, "training_iteration": 45, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-52-00", "timestamp": 1690829520, "time_this_iter_s": 61.244959115982056, "time_total_s": 2863.6062319278717, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2863.6062319278717, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.97241379310343, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.58610081833174, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.892174633845702, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8421563018198002, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.5009248710331387, "reward_component_totals/delta_v_mean": -2.0500183320259087, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.0018332025902, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1254.61, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6269915042478761, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.952040477263563, -3.823824430324777, -3.9405673913664394, -3.87494062009677, -3.7883059663549217, -3.853437180535897, -3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3290016388335344, "mean_inference_ms": 6.52343032765782, "mean_action_processing_ms": 0.3159149744458001, "mean_env_wait_ms": 7.164990032919528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 552181, "agent_timesteps_total": 552181, "timers": {"sample_time_ms": 32469.216, "sample_throughput": 369.766, "load_time_ms": 8.482, "load_throughput": 1415467.514, "learn_time_ms": 30601.884, "learn_throughput": 392.329, "update_time_ms": 24.265}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0015673752641305327, "policy_loss": -0.003481799503788352, "vf_loss": 0.001914425753057003, "vf_explained_var": 0.5783528685569763, "kl": 0.00588477635756135, "entropy": 2.54726505279541, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 552181, "num_agent_steps_sampled": 552181, "num_steps_trained": 552181, "num_agent_steps_trained": 552181}, "done": false, "episodes_total": 276, "training_iteration": 46, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-53-01", "timestamp": 1690829581, "time_this_iter_s": 60.406505823135376, "time_total_s": 2924.012737751007, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2924.012737751007, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.98275862068965, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.58610081833174, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.88780675239394, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8360602961925683, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.5009248710331387, "reward_component_totals/delta_v_mean": -2.051746456201377, "reward_component_totals/delta_v_min": -2.18630345980326, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.1746456201371, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 218.63034598032516, "constraint_violation.max_vel_constraint.steps_mean": 1204.48, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6019390304847577, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.7958774149831225, -4.008200892690059, -3.805772482001777, -3.749582619564373, -3.733392863051919, -3.9778976551812257, -3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.327261386694556, "mean_inference_ms": 6.521535854314695, "mean_action_processing_ms": 0.3157185456073724, "mean_env_wait_ms": 7.159979103560514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 564187, "agent_timesteps_total": 564187, "timers": {"sample_time_ms": 32656.212, "sample_throughput": 367.648, "load_time_ms": 8.218, "load_throughput": 1461019.524, "learn_time_ms": 30657.957, "learn_throughput": 391.611, "update_time_ms": 24.131}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017364141531288624, "policy_loss": -0.0006232076557353139, "vf_loss": 0.00235962332226336, "vf_explained_var": 0.32522526383399963, "kl": 0.0005761025822721422, "entropy": 2.7195286750793457, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 564187, "num_agent_steps_sampled": 564187, "num_steps_trained": 564187, "num_agent_steps_trained": 564187}, "done": false, "episodes_total": 282, "training_iteration": 47, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-54-05", "timestamp": 1690829645, "time_this_iter_s": 63.85864543914795, "time_total_s": 2987.871383190155, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2987.871383190155, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 99.97977528089886, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.58610081833174, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.8978344904062605, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840862005154043, "reward_component_totals/dist_change_reward_min": -0.9946794955997447, "reward_component_totals/dist_change_reward_max": -0.5009248710331387, "reward_component_totals/delta_v_mean": -2.0569724852522238, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9661062491436856, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.6972485252218, "delta_v_total_min": 196.6106249143679, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1203.73, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6015642178910544, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.9260514811435674, -3.83298738313776, -3.680686361171622, -3.9316733392552536, -3.9692053685653934, -3.7745490467532448, -3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3256265911996916, "mean_inference_ms": 6.519386913532203, "mean_action_processing_ms": 0.31556165562042154, "mean_env_wait_ms": 7.155192351671612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 576193, "agent_timesteps_total": 576193, "timers": {"sample_time_ms": 32478.227, "sample_throughput": 369.663, "load_time_ms": 7.941, "load_throughput": 1511994.146, "learn_time_ms": 30633.311, "learn_throughput": 391.926, "update_time_ms": 23.8}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0006262038368731737, "policy_loss": -0.0024496084079146385, "vf_loss": 0.0018234036397188902, "vf_explained_var": 0.7835360169410706, "kl": 0.0023522821720689535, "entropy": 2.5796282291412354, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 576193, "num_agent_steps_sampled": 576193, "num_steps_trained": 576193, "num_agent_steps_trained": 576193}, "done": false, "episodes_total": 288, "training_iteration": 48, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-55-07", "timestamp": 1690829707, "time_this_iter_s": 61.89699602127075, "time_total_s": 3049.768379211426, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3049.768379211426, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.97977528089886, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.58610081833174, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.9029331039617032, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8417888834595285, "reward_component_totals/dist_change_reward_min": -0.9937353746548516, "reward_component_totals/dist_change_reward_max": -0.5009248710331387, "reward_component_totals/delta_v_mean": -2.0611442205021806, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9722683464487405, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.1144220502174, "delta_v_total_min": 197.2268346448737, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1205.32, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6023588205897051, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.986610865608621, -3.7693683937963964, -3.8365870401872955, -3.714195332053606, -4.060867505828203, -3.8748022857332987, -3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3240302813370874, "mean_inference_ms": 6.517195376280719, "mean_action_processing_ms": 0.31540638930390275, "mean_env_wait_ms": 7.150633589123959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 588199, "agent_timesteps_total": 588199, "timers": {"sample_time_ms": 32297.506, "sample_throughput": 371.731, "load_time_ms": 8.084, "load_throughput": 1485083.75, "learn_time_ms": 30607.81, "learn_throughput": 392.253, "update_time_ms": 23.722}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00200945814140141, "policy_loss": -0.00032577887759543955, "vf_loss": 0.0023352382704615593, "vf_explained_var": 0.5374018549919128, "kl": 0.0007086621480993927, "entropy": 2.6940724849700928, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 588199, "num_agent_steps_sampled": 588199, "num_steps_trained": 588199, "num_agent_steps_trained": 588199}, "done": false, "episodes_total": 294, "training_iteration": 49, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-56-08", "timestamp": 1690829768, "time_this_iter_s": 61.12531113624573, "time_total_s": 3110.8936903476715, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3110.8936903476715, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.97471264367813, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.9017416730479253, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8389410832614587, "reward_component_totals/dist_change_reward_min": -0.9965790308781826, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0628005897864727, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9757641996940003, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.28005897864662, "delta_v_total_min": 197.57641996939947, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1219.91, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6096501749125437, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.7855247986976415, -3.9110132276931875, -3.951522372393578, -3.7308072611521848, -3.7578772624238983, -3.7096361286441635, -3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3225372323495983, "mean_inference_ms": 6.5144593436496505, "mean_action_processing_ms": 0.3152771206733825, "mean_env_wait_ms": 7.146348592425102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 600205, "agent_timesteps_total": 600205, "timers": {"sample_time_ms": 32021.228, "sample_throughput": 374.939, "load_time_ms": 8.676, "load_throughput": 1383790.105, "learn_time_ms": 30581.688, "learn_throughput": 392.588, "update_time_ms": 22.054}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0014738660538569093, "policy_loss": -0.0008835762273520231, "vf_loss": 0.0023574428632855415, "vf_explained_var": 0.506605327129364, "kl": 0.0011215143604204059, "entropy": 2.6759445667266846, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 600205, "num_agent_steps_sampled": 600205, "num_steps_trained": 600205, "num_agent_steps_trained": 600205}, "done": false, "episodes_total": 300, "training_iteration": 50, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-57-09", "timestamp": 1690829829, "time_this_iter_s": 61.34973216056824, "time_total_s": 3172.2434225082397, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3172.2434225082397, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.97272727272725, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.9072006865703277, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412664922846598, "reward_component_totals/dist_change_reward_min": -0.9965790308781826, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0659341942856737, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9757641996940003, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.59341942856673, "delta_v_total_min": 197.57641996939947, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1214.9, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6071464267866067, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.9042637436423266, -3.9756247284944912, -3.8492536141418974, -3.8041781363181597, -3.927267253818745, -3.8320290708705222, -3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3225734437007242, "mean_inference_ms": 6.511442828311588, "mean_action_processing_ms": 0.3151764223285568, "mean_env_wait_ms": 7.142561679081817, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 612211, "agent_timesteps_total": 612211, "timers": {"sample_time_ms": 32265.47, "sample_throughput": 372.101, "load_time_ms": 8.709, "load_throughput": 1378498.169, "learn_time_ms": 30521.315, "learn_throughput": 393.364, "update_time_ms": 23.504}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00011077235103584826, "policy_loss": -0.0022307755425572395, "vf_loss": 0.002120001707226038, "vf_explained_var": 0.6108360886573792, "kl": 0.001810921006835997, "entropy": 2.5792267322540283, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 612211, "num_agent_steps_sampled": 612211, "num_steps_trained": 612211, "num_agent_steps_trained": 612211}, "done": false, "episodes_total": 306, "training_iteration": 51, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-58-22", "timestamp": 1690829902, "time_this_iter_s": 72.26506185531616, "time_total_s": 3244.508484363556, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3244.508484363556, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.97864077669902, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.907154389076679, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8395822933328675, "reward_component_totals/dist_change_reward_min": -0.9965790308781826, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0675720957438184, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9815047941605277, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.75720957438116, "delta_v_total_min": 198.15047941605246, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1226.96, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6131734132933533, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.9398532205065044, -3.9577645069011607, -4.007455841642033, -3.9429394217486107, -3.9853020090545295, -3.8108155375673114, -3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.322761065367515, "mean_inference_ms": 6.508993859852875, "mean_action_processing_ms": 0.315094984756369, "mean_env_wait_ms": 7.139356738256774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 624217, "agent_timesteps_total": 624217, "timers": {"sample_time_ms": 32604.613, "sample_throughput": 368.23, "load_time_ms": 6.387, "load_throughput": 1879616.805, "learn_time_ms": 30422.662, "learn_throughput": 394.64, "update_time_ms": 21.679}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0007053983863443136, "policy_loss": -0.0032977673690766096, "vf_loss": 0.002592368982732296, "vf_explained_var": 0.41096973419189453, "kl": 0.0008193514659069479, "entropy": 2.7367281913757324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 624217, "num_agent_steps_sampled": 624217, "num_steps_trained": 624217, "num_agent_steps_trained": 624217}, "done": false, "episodes_total": 312, "training_iteration": 52, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_11-59-26", "timestamp": 1690829966, "time_this_iter_s": 64.18258786201477, "time_total_s": 3308.6910722255707, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3308.6910722255707, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.98043478260868, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.901077685446055, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8331782466953147, "reward_component_totals/dist_change_reward_min": -0.9965790308781826, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0678994387507474, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -2.0073507247368565, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.789943875074, "delta_v_total_min": 200.73507247368462, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1216.7, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6080459770114942, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.775557110313243, -4.001590935724183, -3.950284315107899, -3.7998444908962825, -3.7738303354244547, -3.9982903490024695, -3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3229277003686801, "mean_inference_ms": 6.506864741460109, "mean_action_processing_ms": 0.31503487135231123, "mean_env_wait_ms": 7.136592123271786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 636223, "agent_timesteps_total": 636223, "timers": {"sample_time_ms": 32670.156, "sample_throughput": 367.491, "load_time_ms": 6.719, "load_throughput": 1786792.435, "learn_time_ms": 30172.29, "learn_throughput": 397.915, "update_time_ms": 21.49}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0008008161094039679, "policy_loss": -0.0031387812923640013, "vf_loss": 0.0023379656486213207, "vf_explained_var": 0.4505406320095062, "kl": 0.0008948977338150144, "entropy": 2.7295477390289307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 636223, "num_agent_steps_sampled": 636223, "num_steps_trained": 636223, "num_agent_steps_trained": 636223}, "done": false, "episodes_total": 318, "training_iteration": 53, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-00-29", "timestamp": 1690830029, "time_this_iter_s": 62.36053919792175, "time_total_s": 3371.0516114234924, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3371.0516114234924, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.97303370786516, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.9030907388922613, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8326697870360887, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0704209518561796, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -2.0092998359600744, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.04209518561723, "delta_v_total_min": 200.92998359600668, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1224.96, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.6121739130434782, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.7758847488576146, -3.9564357810780617, -3.8086686522686257, -3.870362954811955, -4.0367108838215575, -4.045097629092453, -3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323177017647598, "mean_inference_ms": 6.504670226050057, "mean_action_processing_ms": 0.3150131819548069, "mean_env_wait_ms": 7.134453602919962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 648229, "agent_timesteps_total": 648229, "timers": {"sample_time_ms": 32660.703, "sample_throughput": 367.598, "load_time_ms": 6.702, "load_throughput": 1791337.072, "learn_time_ms": 30364.97, "learn_throughput": 395.39, "update_time_ms": 20.237}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00019064641674049199, "policy_loss": -0.0017287274822592735, "vf_loss": 0.0019193729385733604, "vf_explained_var": 0.6923830509185791, "kl": 0.00043085013749077916, "entropy": 2.618147850036621, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 648229, "num_agent_steps_sampled": 648229, "num_steps_trained": 648229, "num_agent_steps_trained": 648229}, "done": false, "episodes_total": 324, "training_iteration": 54, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-01-32", "timestamp": 1690830092, "time_this_iter_s": 62.688684701919556, "time_total_s": 3433.740296125412, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3433.740296125412, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.97333333333334, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.4122251393048, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.904735091164518, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8332358880766351, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": -0.31805665991188165, "reward_component_totals/delta_v_mean": -2.0714992030878894, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -2.0092998359600744, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.1499203087882, "delta_v_total_min": 200.92998359600668, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1199.77, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.5995852073963018, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.813513738471306, -3.807692901308001, -3.9083295001831626, -3.9580442629958617, -3.916097560422055, -4.033089521548235, -3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3235825136994195, "mean_inference_ms": 6.502336013655806, "mean_action_processing_ms": 0.31498529262606095, "mean_env_wait_ms": 7.132532479174343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 660235, "agent_timesteps_total": 660235, "timers": {"sample_time_ms": 32920.53, "sample_throughput": 364.696, "load_time_ms": 6.622, "load_throughput": 1813176.746, "learn_time_ms": 30226.539, "learn_throughput": 397.201, "update_time_ms": 19.583}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0020944722928106785, "policy_loss": -0.00021740161173511297, "vf_loss": 0.00231187604367733, "vf_explained_var": 0.36725834012031555, "kl": 0.00019988237181678414, "entropy": 2.7604012489318848, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 660235, "num_agent_steps_sampled": 660235, "num_steps_trained": 660235, "num_agent_steps_trained": 660235}, "done": false, "episodes_total": 330, "training_iteration": 55, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-02-34", "timestamp": 1690830154, "time_this_iter_s": 62.5206081867218, "time_total_s": 3496.260904312134, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3496.260904312134, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.97640449438202, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.895567556654238, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8257033232548094, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.069864233399434, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.98642333994275, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1179.4, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.5894052973513244, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-3.9452458698343413, -3.925551817054819, -4.024486563071567, -3.9269713805152313, -4.073229694448728, -4.011613769926183, -4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.324039746668305, "mean_inference_ms": 6.500105051058889, "mean_action_processing_ms": 0.31493254571966217, "mean_env_wait_ms": 7.130649241811882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 672241, "agent_timesteps_total": 672241, "timers": {"sample_time_ms": 33226.273, "sample_throughput": 361.341, "load_time_ms": 6.897, "load_throughput": 1740643.409, "learn_time_ms": 30218.426, "learn_throughput": 397.307, "update_time_ms": 20.018}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0021633568685501814, "policy_loss": -3.802776336669922e-05, "vf_loss": 0.002201387193053961, "vf_explained_var": 0.5961966514587402, "kl": 0.0005343187367543578, "entropy": 2.675058603286743, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 672241, "num_agent_steps_sampled": 672241, "num_steps_trained": 672241, "num_agent_steps_trained": 672241}, "done": false, "episodes_total": 336, "training_iteration": 56, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-03-38", "timestamp": 1690830218, "time_this_iter_s": 63.36455798149109, "time_total_s": 3559.625462293625, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3559.625462293625, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.9696629213483, "ram_util_percent": 47.43483146067415}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.891626782208006, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.821779296098474, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.069847486109538, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.98474861095315, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1179.88, "constraint_violation.max_vel_constraint.steps_min": 348, "constraint_violation.max_vel_constraint.steps_max": 1972, "constraint_violation.max_vel_constraint.ratio_mean": 0.5896451774112943, "constraint_violation.max_vel_constraint.ratio_min": 0.17391304347826086, "constraint_violation.max_vel_constraint.ratio_max": 0.9855072463768116}, "hist_stats": {"episode_reward": [-4.006751236781738, -3.9983400574942105, -4.025183305504713, -3.763567020409456, -3.9014235175657115, -3.8285705894916164, -3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3229596298979445, "mean_inference_ms": 6.498413223421421, "mean_action_processing_ms": 0.3148800282222637, "mean_env_wait_ms": 7.129000453468844, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 684247, "agent_timesteps_total": 684247, "timers": {"sample_time_ms": 33219.151, "sample_throughput": 361.418, "load_time_ms": 6.98, "load_throughput": 1720130.276, "learn_time_ms": 30132.756, "learn_throughput": 398.437, "update_time_ms": 21.16}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002081578364595771, "policy_loss": 8.633051766082644e-05, "vf_loss": 0.0019952477887272835, "vf_explained_var": 0.6983738541603088, "kl": 0.0007593510672450066, "entropy": 2.6216371059417725, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 684247, "num_agent_steps_sampled": 684247, "num_steps_trained": 684247, "num_agent_steps_trained": 684247}, "done": false, "episodes_total": 342, "training_iteration": 57, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-04-41", "timestamp": 1690830281, "time_this_iter_s": 62.973525285720825, "time_total_s": 3622.5989875793457, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3622.5989875793457, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.9722222222222, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.172375147010322, "episode_reward_mean": -3.8887881491513934, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8210396528752564, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.0677484962761437, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.77484962761366, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1191.36, "constraint_violation.max_vel_constraint.steps_min": 389, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.5953823088455773, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.8221192353630014, -4.100047099055991, -4.172375147010322, -3.8507822572035346, -3.823316358947233, -3.88856067023928, -3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3219035442759617, "mean_inference_ms": 6.49699322755797, "mean_action_processing_ms": 0.3148354782068745, "mean_env_wait_ms": 7.127490764387796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 696253, "agent_timesteps_total": 696253, "timers": {"sample_time_ms": 33202.971, "sample_throughput": 361.594, "load_time_ms": 7.015, "load_throughput": 1711547.69, "learn_time_ms": 30068.253, "learn_throughput": 399.292, "update_time_ms": 21.103}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0007050229469314218, "policy_loss": -0.0027224617078900337, "vf_loss": 0.0020174409728497267, "vf_explained_var": 0.5988872051239014, "kl": 0.0011417403584346175, "entropy": 2.6272881031036377, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 696253, "num_agent_steps_sampled": 696253, "num_steps_trained": 696253, "num_agent_steps_trained": 696253}, "done": false, "episodes_total": 348, "training_iteration": 58, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-05-42", "timestamp": 1690830342, "time_this_iter_s": 61.12240123748779, "time_total_s": 3683.7213888168335, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3683.7213888168335, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.97954545454546, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.144539039177234, "episode_reward_mean": -3.881118378529714, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8166735311058847, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.0644448474238355, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.4444847423828, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1188.39, "constraint_violation.max_vel_constraint.steps_min": 389, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.5938980509745128, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.9963414800993062, -3.8288936213146445, -3.8662109289189353, -3.921156523330816, -3.9690802359974198, -3.918237287790862, -3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3208534826502545, "mean_inference_ms": 6.495729383495242, "mean_action_processing_ms": 0.31475826647877353, "mean_env_wait_ms": 7.125556446252623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 708259, "agent_timesteps_total": 708259, "timers": {"sample_time_ms": 33206.178, "sample_throughput": 361.559, "load_time_ms": 6.812, "load_throughput": 1762434.73, "learn_time_ms": 30261.816, "learn_throughput": 396.738, "update_time_ms": 19.869}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017056281212717295, "policy_loss": -0.0005662554758600891, "vf_loss": 0.0022718796972185373, "vf_explained_var": 0.5314722657203674, "kl": 0.0005176049307920039, "entropy": 2.6676979064941406, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 708259, "num_agent_steps_sampled": 708259, "num_steps_trained": 708259, "num_agent_steps_trained": 708259}, "done": false, "episodes_total": 354, "training_iteration": 59, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-06-46", "timestamp": 1690830406, "time_this_iter_s": 63.12490105628967, "time_total_s": 3746.846289873123, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3746.846289873123, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.97444444444443, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.144539039177234, "episode_reward_mean": -3.8795047922710935, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8142415491730352, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.065263243098064, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.5263243098057, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1211.83, "constraint_violation.max_vel_constraint.steps_min": 389, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.6056121939030484, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.8295017289265125, -4.026809818151683, -3.995666769098227, -3.8211755356086576, -3.58610081833174, -3.809978548217801, -4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.319899711411588, "mean_inference_ms": 6.49400769018601, "mean_action_processing_ms": 0.3147001899382669, "mean_env_wait_ms": 7.123431981034493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 720265, "agent_timesteps_total": 720265, "timers": {"sample_time_ms": 33172.993, "sample_throughput": 361.921, "load_time_ms": 6.209, "load_throughput": 1933550.679, "learn_time_ms": 30188.628, "learn_throughput": 397.699, "update_time_ms": 19.099}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0005925014847889543, "policy_loss": -0.001431967131793499, "vf_loss": 0.0020244698971509933, "vf_explained_var": 0.6678808331489563, "kl": 0.0022998552303761244, "entropy": 2.5712761878967285, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 720265, "num_agent_steps_sampled": 720265, "num_steps_trained": 720265, "num_agent_steps_trained": 720265}, "done": false, "episodes_total": 360, "training_iteration": 60, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-07-46", "timestamp": 1690830466, "time_this_iter_s": 60.31962203979492, "time_total_s": 3807.165911912918, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3807.165911912918, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.97674418604649, "ram_util_percent": 47.4}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.144539039177234, "episode_reward_mean": -3.885969297511244, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8223919339794576, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.0635773635317918, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.9999038290480793, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.35773635317852, "delta_v_total_min": 199.99038290480757, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1226.76, "constraint_violation.max_vel_constraint.steps_min": 389, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.6130734632683659, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-4.144539039177234, -3.9471791991311815, -3.8158072806153207, -3.898686477489929, -3.806048538283402, -3.9181233689490247, -3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.320043505747137, "mean_inference_ms": 6.49181193948015, "mean_action_processing_ms": 0.3146666118650388, "mean_env_wait_ms": 7.121629187820758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 732271, "agent_timesteps_total": 732271, "timers": {"sample_time_ms": 32969.337, "sample_throughput": 364.157, "load_time_ms": 6.201, "load_throughput": 1936227.111, "learn_time_ms": 30269.036, "learn_throughput": 396.643, "update_time_ms": 18.789}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015502431197091937, "policy_loss": -0.0005270808469504118, "vf_loss": 0.0020773252472281456, "vf_explained_var": 0.6718710660934448, "kl": 0.0006709087756462395, "entropy": 2.5618631839752197, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 732271, "num_agent_steps_sampled": 732271, "num_steps_trained": 732271, "num_agent_steps_trained": 732271}, "done": false, "episodes_total": 366, "training_iteration": 61, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-08-57", "timestamp": 1690830537, "time_this_iter_s": 70.94858288764954, "time_total_s": 3878.1144948005676, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3878.1144948005676, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.97941176470587, "ram_util_percent": 47.39999999999996}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.129471713802975, "episode_reward_mean": -3.8828658196170505, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.822144630596976, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.060721189020081, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.997305420686805, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.0721189020074, "delta_v_total_min": 199.73054206868014, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1241.93, "constraint_violation.max_vel_constraint.steps_min": 442, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.6206546726636681, "constraint_violation.max_vel_constraint.ratio_min": 0.22088955522238882, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.8812118728913214, -3.836090373893423, -3.7926206057120115, -3.8459895390356484, -3.7944120526515848, -3.789849310366016, -3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3203538380547974, "mean_inference_ms": 6.490658818876882, "mean_action_processing_ms": 0.3146670225752254, "mean_env_wait_ms": 7.120681292036099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 744277, "agent_timesteps_total": 744277, "timers": {"sample_time_ms": 32955.442, "sample_throughput": 364.31, "load_time_ms": 6.072, "load_throughput": 1977227.224, "learn_time_ms": 30325.955, "learn_throughput": 395.898, "update_time_ms": 19.219}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 1.0000000116860974e-07, "total_loss": -9.725090785650536e-05, "policy_loss": -0.002191056264564395, "vf_loss": 0.0020938063971698284, "vf_explained_var": 0.6086714267730713, "kl": 0.0009744035778567195, "entropy": 2.5434224605560303, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 744277, "num_agent_steps_sampled": 744277, "num_steps_trained": 744277, "num_agent_steps_trained": 744277}, "done": false, "episodes_total": 372, "training_iteration": 62, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-10-02", "timestamp": 1690830602, "time_this_iter_s": 64.6323471069336, "time_total_s": 3942.746841907501, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3942.746841907501, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.96521739130436, "ram_util_percent": 47.39999999999997}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.129471713802975, "episode_reward_mean": -3.882330605273142, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8225168272974063, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.059813777975742, "reward_component_totals/delta_v_min": -2.2488327413300575, "reward_component_totals/delta_v_max": -1.997305420686805, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.98137779757351, "delta_v_total_min": 199.73054206868014, "delta_v_total_max": 224.8832741330054, "constraint_violation.max_vel_constraint.steps_mean": 1232.74, "constraint_violation.max_vel_constraint.steps_min": 442, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.6160619690154923, "constraint_violation.max_vel_constraint.ratio_min": 0.22088955522238882, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.7618270898669675, -3.766166138430896, -3.7939631620520844, -3.8901101673985385, -4.129471713802975, -4.020927001308026, -3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3208840163699624, "mean_inference_ms": 6.490086725267428, "mean_action_processing_ms": 0.3147074904547174, "mean_env_wait_ms": 7.1203395485212475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 756283, "agent_timesteps_total": 756283, "timers": {"sample_time_ms": 32904.073, "sample_throughput": 364.879, "load_time_ms": 5.97, "load_throughput": 2010942.432, "learn_time_ms": 30155.63, "learn_throughput": 398.135, "update_time_ms": 20.863}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0008396051125600934, "policy_loss": -0.002789104823023081, "vf_loss": 0.0019495015731081367, "vf_explained_var": 0.6625087261199951, "kl": 0.0009239088976755738, "entropy": 2.4957637786865234, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 756283, "num_agent_steps_sampled": 756283, "num_steps_trained": 756283, "num_agent_steps_trained": 756283}, "done": false, "episodes_total": 378, "training_iteration": 63, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-11-02", "timestamp": 1690830662, "time_this_iter_s": 60.17755746841431, "time_total_s": 4002.9243993759155, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4002.9243993759155, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.97674418604649, "ram_util_percent": 47.4}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.8800182330652437, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8240993351717176, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.055918897893532, "reward_component_totals/delta_v_min": -2.1967657906313676, "reward_component_totals/delta_v_max": -1.9961998671790016, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.59188978935254, "delta_v_total_min": 199.61998671789945, "delta_v_total_max": 219.67657906313602, "constraint_violation.max_vel_constraint.steps_mean": 1280.1, "constraint_violation.max_vel_constraint.steps_min": 443, "constraint_violation.max_vel_constraint.steps_max": 1961, "constraint_violation.max_vel_constraint.ratio_mean": 0.6397301349325337, "constraint_violation.max_vel_constraint.ratio_min": 0.22138930534732634, "constraint_violation.max_vel_constraint.ratio_max": 0.9800099950024987}, "hist_stats": {"episode_reward": [-3.881429132743391, -3.9742779196862124, -4.017867223248278, -4.049524737915722, -3.8592209631415697, -3.9836697565548587, -3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321434278514105, "mean_inference_ms": 6.489765001824587, "mean_action_processing_ms": 0.3147653905290173, "mean_env_wait_ms": 7.120179703859832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 768289, "agent_timesteps_total": 768289, "timers": {"sample_time_ms": 32810.815, "sample_throughput": 365.916, "load_time_ms": 6.13, "load_throughput": 1958646.979, "learn_time_ms": 30179.135, "learn_throughput": 397.825, "update_time_ms": 21.262}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009290651069022715, "policy_loss": -0.0009109152015298605, "vf_loss": 0.0018399795517325401, "vf_explained_var": 0.6447984576225281, "kl": 0.0006062870379537344, "entropy": 2.4526262283325195, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 768289, "num_agent_steps_sampled": 768289, "num_steps_trained": 768289, "num_agent_steps_trained": 768289}, "done": false, "episodes_total": 384, "training_iteration": 64, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-12-05", "timestamp": 1690830725, "time_this_iter_s": 61.99915838241577, "time_total_s": 4064.9235577583313, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4064.9235577583313, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 99.97840909090907, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.876583396110047, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8241698239923622, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.05241357211769, "reward_component_totals/delta_v_min": -2.1967657906313676, "reward_component_totals/delta_v_max": -1.9794777530431762, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.24135721176842, "delta_v_total_min": 197.94777530431725, "delta_v_total_max": 219.67657906313602, "constraint_violation.max_vel_constraint.steps_mean": 1264.47, "constraint_violation.max_vel_constraint.steps_min": 443, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6319190404797602, "constraint_violation.max_vel_constraint.ratio_min": 0.22138930534732634, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.8099235872755703, -4.013058367019753, -3.912337646155577, -4.046804015423703, -3.881460261368148, -3.8879049095341824, -3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3222030125900497, "mean_inference_ms": 6.489598726467108, "mean_action_processing_ms": 0.3148524573593746, "mean_env_wait_ms": 7.1210288208259955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 780295, "agent_timesteps_total": 780295, "timers": {"sample_time_ms": 32884.156, "sample_throughput": 365.1, "load_time_ms": 6.058, "load_throughput": 1981724.706, "learn_time_ms": 30342.967, "learn_throughput": 395.677, "update_time_ms": 24.109}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0004039221676066518, "policy_loss": -0.0019449203973636031, "vf_loss": 0.0023488434962928295, "vf_explained_var": 0.3973919451236725, "kl": 0.0008925120928324759, "entropy": 2.6873393058776855, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 780295, "num_agent_steps_sampled": 780295, "num_steps_trained": 780295, "num_agent_steps_trained": 780295}, "done": false, "episodes_total": 390, "training_iteration": 65, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-13-10", "timestamp": 1690830790, "time_this_iter_s": 64.90815258026123, "time_total_s": 4129.8317103385925, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4129.8317103385925, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.96881720430106, "ram_util_percent": 47.39999999999997}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.8529771622888043, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.8751790422336474, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8236162804122994, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.2677967580286904, "reward_component_totals/delta_v_mean": -2.0515627618213537, "reward_component_totals/delta_v_min": -2.1967657906313676, "reward_component_totals/delta_v_max": -1.9794777530431762, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.15627618213463, "delta_v_total_min": 197.94777530431725, "delta_v_total_max": 219.67657906313602, "constraint_violation.max_vel_constraint.steps_mean": 1261.08, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.630224887556222, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.4122251393048, -3.934075307021476, -4.042478968974786, -3.9651437456262766, -3.798701552089298, -3.8932096904586038, -4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231720459459415, "mean_inference_ms": 6.4896973392141595, "mean_action_processing_ms": 0.3149477752288996, "mean_env_wait_ms": 7.1225742082613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 792301, "agent_timesteps_total": 792301, "timers": {"sample_time_ms": 32979.816, "sample_throughput": 364.041, "load_time_ms": 5.809, "load_throughput": 2066675.169, "learn_time_ms": 30430.721, "learn_throughput": 394.536, "update_time_ms": 22.168}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0006816188688389957, "policy_loss": -0.001658126711845398, "vf_loss": 0.0023397456388920546, "vf_explained_var": 0.5403159260749817, "kl": 0.0010971364099532366, "entropy": 2.6965577602386475, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 792301, "num_agent_steps_sampled": 792301, "num_steps_trained": 792301, "num_agent_steps_trained": 792301}, "done": false, "episodes_total": 396, "training_iteration": 66, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-14-15", "timestamp": 1690830855, "time_this_iter_s": 65.15428876876831, "time_total_s": 4194.985999107361, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4194.985999107361, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.96666666666664, "ram_util_percent": 47.39999999999997}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.8607210422440534, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8086278364364494, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0520932058076107, "reward_component_totals/delta_v_min": -2.1967657906313676, "reward_component_totals/delta_v_max": -1.9794777530431762, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 205.20932058076036, "delta_v_total_min": 197.94777530431725, "delta_v_total_max": 219.67657906313602, "constraint_violation.max_vel_constraint.steps_mean": 1252.85, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.626111944027986, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-4.011528654884878, -3.8254321287806317, -3.9379177403028773, -3.9254926367285403, -3.849081439354217, -3.950642654610686, -4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3228599594473451, "mean_inference_ms": 6.490355585851251, "mean_action_processing_ms": 0.3150434537750009, "mean_env_wait_ms": 7.124347616129262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 804307, "agent_timesteps_total": 804307, "timers": {"sample_time_ms": 33025.603, "sample_throughput": 363.536, "load_time_ms": 5.972, "load_throughput": 2010420.587, "learn_time_ms": 30211.839, "learn_throughput": 397.394, "update_time_ms": 21.681}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015488837379962206, "policy_loss": -0.0011200777953490615, "vf_loss": 0.002668961649760604, "vf_explained_var": 0.4920137822628021, "kl": 0.00046051465324126184, "entropy": 2.72731351852417, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 804307, "num_agent_steps_sampled": 804307, "num_steps_trained": 804307, "num_agent_steps_trained": 804307}, "done": false, "episodes_total": 402, "training_iteration": 67, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-15-16", "timestamp": 1690830916, "time_this_iter_s": 61.26216983795166, "time_total_s": 4256.2481689453125, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4256.2481689453125, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.97241379310343, "ram_util_percent": 47.39999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.8566281639816795, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8086835381346397, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.047944625847046, "reward_component_totals/delta_v_min": -2.1207739203174913, "reward_component_totals/delta_v_max": -1.9794777530431762, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.7944625847039, "delta_v_total_min": 197.94777530431725, "delta_v_total_max": 212.07739203174881, "constraint_violation.max_vel_constraint.steps_mean": 1254.05, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.626711644177911, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-4.021472674339915, -3.853771479909537, -3.786622370515893, -3.826396179191089, -3.8311548036235905, -3.8312240482147244, -3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3226411006216139, "mean_inference_ms": 6.491033904038074, "mean_action_processing_ms": 0.3151457317336368, "mean_env_wait_ms": 7.126350240093488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 816313, "agent_timesteps_total": 816313, "timers": {"sample_time_ms": 33414.692, "sample_throughput": 359.303, "load_time_ms": 6.367, "load_throughput": 1885599.259, "learn_time_ms": 30341.768, "learn_throughput": 395.692, "update_time_ms": 21.782}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007804774795658886, "policy_loss": -0.0014626701595261693, "vf_loss": 0.0022431460674852133, "vf_explained_var": 0.48899635672569275, "kl": 0.0025567798875272274, "entropy": 2.6411235332489014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 816313, "num_agent_steps_sampled": 816313, "num_steps_trained": 816313, "num_agent_steps_trained": 816313}, "done": false, "episodes_total": 408, "training_iteration": 68, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-16-23", "timestamp": 1690830983, "time_this_iter_s": 66.37120127677917, "time_total_s": 4322.619370222092, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4322.619370222092, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.9757894736842, "ram_util_percent": 47.39999999999996}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.8561378661283356, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8096909742746267, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.046446891853714, "reward_component_totals/delta_v_min": -2.1207739203174913, "reward_component_totals/delta_v_max": -1.9794777530431762, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.64468918537074, "delta_v_total_min": 197.94777530431725, "delta_v_total_max": 212.07739203174881, "constraint_violation.max_vel_constraint.steps_mean": 1272.87, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6361169415292354, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.7116801983725085, -3.860108538767613, -3.8499988426527194, -3.95229374272662, -4.013312917128156, -3.8558081578514782, -3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3224527452792105, "mean_inference_ms": 6.491179220646092, "mean_action_processing_ms": 0.3152363437870323, "mean_env_wait_ms": 7.128367680363981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 828319, "agent_timesteps_total": 828319, "timers": {"sample_time_ms": 33618.295, "sample_throughput": 357.127, "load_time_ms": 6.555, "load_throughput": 1831696.384, "learn_time_ms": 30004.463, "learn_throughput": 400.14, "update_time_ms": 21.808}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0004362132167443633, "policy_loss": -0.00120903505012393, "vf_loss": 0.0016452475683763623, "vf_explained_var": 0.7698155045509338, "kl": 0.0021435809321701527, "entropy": 2.3990256786346436, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 828319, "num_agent_steps_sampled": 828319, "num_steps_trained": 828319, "num_agent_steps_trained": 828319}, "done": false, "episodes_total": 414, "training_iteration": 69, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-17-25", "timestamp": 1690831045, "time_this_iter_s": 61.74349808692932, "time_total_s": 4384.362868309021, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4384.362868309021, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.96818181818183, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.094693393987573, "episode_reward_mean": -3.843961198596725, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7991829274213026, "reward_component_totals/dist_change_reward_min": -0.9998971977652636, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0447782711754283, "reward_component_totals/delta_v_min": -2.1207739203174913, "reward_component_totals/delta_v_max": -1.9741486936807642, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.47782711754218, "delta_v_total_min": 197.4148693680765, "delta_v_total_max": 212.07739203174881, "constraint_violation.max_vel_constraint.steps_mean": 1250.13, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6247526236881559, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.822730897033136, -4.094693393987573, -3.8635857643090654, -3.8505717507797503, -3.852133570384435, -3.9697832639747768, -3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3223623687733248, "mean_inference_ms": 6.491166048063703, "mean_action_processing_ms": 0.3153256360981884, "mean_env_wait_ms": 7.1303864323855555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 840325, "agent_timesteps_total": 840325, "timers": {"sample_time_ms": 33763.96, "sample_throughput": 355.586, "load_time_ms": 6.712, "load_throughput": 1788728.233, "learn_time_ms": 30104.611, "learn_throughput": 398.809, "update_time_ms": 21.399}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019236552761867642, "policy_loss": -0.00031562967342324555, "vf_loss": 0.0022392848040908575, "vf_explained_var": 0.5406148433685303, "kl": 0.00047938001807779074, "entropy": 2.6420304775238037, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 840325, "num_agent_steps_sampled": 840325, "num_steps_trained": 840325, "num_agent_steps_trained": 840325}, "done": false, "episodes_total": 420, "training_iteration": 70, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-18-28", "timestamp": 1690831108, "time_this_iter_s": 62.72468137741089, "time_total_s": 4447.087549686432, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4447.087549686432, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.97111111111111, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.0527623534331525, "episode_reward_mean": -3.8457931295572103, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8019544936844107, "reward_component_totals/dist_change_reward_min": -0.9993385235597463, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.043838635872805, "reward_component_totals/delta_v_min": -2.1207739203174913, "reward_component_totals/delta_v_max": -1.9741486936807642, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.38386358727985, "delta_v_total_min": 197.4148693680765, "delta_v_total_max": 212.07739203174881, "constraint_violation.max_vel_constraint.steps_mean": 1259.03, "constraint_violation.max_vel_constraint.steps_min": 421, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6292003998001, "constraint_violation.max_vel_constraint.ratio_min": 0.21039480259870064, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.8394839611261933, -4.007265110546493, -3.9992959431858024, -3.989634027938247, -2.8529771622888043, -3.873006580615245, -3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3232515597358263, "mean_inference_ms": 6.491143222111831, "mean_action_processing_ms": 0.3154046349002058, "mean_env_wait_ms": 7.132587935679253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 852331, "agent_timesteps_total": 852331, "timers": {"sample_time_ms": 33794.122, "sample_throughput": 355.269, "load_time_ms": 6.797, "load_throughput": 1766434.699, "learn_time_ms": 29919.248, "learn_throughput": 401.28, "update_time_ms": 22.76}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002568664029240608, "policy_loss": -1.7316111552645452e-05, "vf_loss": 0.0025859803427010775, "vf_explained_var": 0.37580427527427673, "kl": 0.0002498750400263816, "entropy": 2.732863426208496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 852331, "num_agent_steps_sampled": 852331, "num_steps_trained": 852331, "num_agent_steps_trained": 852331}, "done": false, "episodes_total": 426, "training_iteration": 71, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-19-37", "timestamp": 1690831177, "time_this_iter_s": 69.41825747489929, "time_total_s": 4516.505807161331, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4516.505807161331, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.96666666666667, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8540083743016202, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8120985042413373, "reward_component_totals/dist_change_reward_min": -0.9993385235597463, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0419098700602887, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9741486936807642, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.19098700602825, "delta_v_total_min": 197.4148693680765, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1276.73, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6380459770114941, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.8964145508194825, -3.9707343182768553, -3.950260005277457, -3.9766214166227227, -3.908833162758195, -3.8296797222583505, -3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3240458764890883, "mean_inference_ms": 6.490981285618946, "mean_action_processing_ms": 0.315462660363251, "mean_env_wait_ms": 7.13428778243026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 864337, "agent_timesteps_total": 864337, "timers": {"sample_time_ms": 33485.183, "sample_throughput": 358.547, "load_time_ms": 7.236, "load_throughput": 1659224.959, "learn_time_ms": 30106.997, "learn_throughput": 398.778, "update_time_ms": 23.169}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00046290477621369064, "policy_loss": -0.0017539361724629998, "vf_loss": 0.0022168424911797047, "vf_explained_var": 0.5208263397216797, "kl": 0.0008486026199534535, "entropy": 2.6339962482452393, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 864337, "num_agent_steps_sampled": 864337, "num_steps_trained": 864337, "num_agent_steps_trained": 864337}, "done": false, "episodes_total": 432, "training_iteration": 72, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-20-41", "timestamp": 1690831241, "time_this_iter_s": 63.45202398300171, "time_total_s": 4579.957831144333, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4579.957831144333, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.97912087912088, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.848092302972991, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.807657918829144, "reward_component_totals/dist_change_reward_min": -0.9993385235597463, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.040434384143853, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9741486936807642, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 204.0434384143847, "delta_v_total_min": 197.4148693680765, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1272.83, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6360969515242378, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.895294951424778, -3.95295592862957, -3.9709040138642955, -3.9553538712925174, -3.8676981988883483, -3.849486519139288, -3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3247751750769894, "mean_inference_ms": 6.490280303024673, "mean_action_processing_ms": 0.31550461158984705, "mean_env_wait_ms": 7.135583532703141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 876343, "agent_timesteps_total": 876343, "timers": {"sample_time_ms": 33282.417, "sample_throughput": 360.731, "load_time_ms": 7.009, "load_throughput": 1713032.382, "learn_time_ms": 30495.639, "learn_throughput": 393.696, "update_time_ms": 22.206}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0005403454415500164, "policy_loss": -0.001552010071463883, "vf_loss": 0.0020923586562275887, "vf_explained_var": 0.6052778363227844, "kl": 0.0027250563725829124, "entropy": 2.5029494762420654, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 876343, "num_agent_steps_sampled": 876343, "num_steps_trained": 876343, "num_agent_steps_trained": 876343}, "done": false, "episodes_total": 438, "training_iteration": 73, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-21-43", "timestamp": 1690831303, "time_this_iter_s": 61.99868845939636, "time_total_s": 4641.956519603729, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4641.956519603729, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.96741573033707, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8427708826460982, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8044929344155938, "reward_component_totals/dist_change_reward_min": -0.9993385235597463, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0382779482305087, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9625705960889719, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.82779482305025, "delta_v_total_min": 196.25705960889678, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1291.03, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6451924037981009, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.899956218847129, -3.8014275187759656, -4.0527623534331525, -3.7686416125023516, -3.7615828313111033, -3.8660388334869955, -3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3255094306208057, "mean_inference_ms": 6.489667503256824, "mean_action_processing_ms": 0.3155493911456675, "mean_env_wait_ms": 7.136820026104282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 888349, "agent_timesteps_total": 888349, "timers": {"sample_time_ms": 33371.655, "sample_throughput": 359.766, "load_time_ms": 6.758, "load_throughput": 1776617.926, "learn_time_ms": 30488.319, "learn_throughput": 393.79, "update_time_ms": 22.542}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0005768865230493248, "policy_loss": -0.0016437406884506345, "vf_loss": 0.002220627386122942, "vf_explained_var": 0.3374118506908417, "kl": 0.0008764805970713496, "entropy": 2.6862385272979736, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 888349, "num_agent_steps_sampled": 888349, "num_steps_trained": 888349, "num_agent_steps_trained": 888349}, "done": false, "episodes_total": 444, "training_iteration": 74, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-22-46", "timestamp": 1690831366, "time_this_iter_s": 62.83047580718994, "time_total_s": 4704.786995410919, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4704.786995410919, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.97752808988764, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8436509388718423, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8053709369295277, "reward_component_totals/dist_change_reward_min": -0.9898864253847217, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0382800019423204, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9625705960889719, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.82800019423146, "delta_v_total_min": 196.25705960889678, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1302.55, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6509495252373811, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.961371018212624, -3.773108862795162, -3.6493398045084247, -3.878782355337056, -3.884385526951153, -3.9967081962902835, -3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3263039686472744, "mean_inference_ms": 6.489092553795525, "mean_action_processing_ms": 0.31558642650742863, "mean_env_wait_ms": 7.138415794804059, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 900355, "agent_timesteps_total": 900355, "timers": {"sample_time_ms": 33244.667, "sample_throughput": 361.141, "load_time_ms": 6.833, "load_throughput": 1757066.178, "learn_time_ms": 30401.657, "learn_throughput": 394.913, "update_time_ms": 21.521}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0021238329354673624, "policy_loss": -0.00020260215387679636, "vf_loss": 0.0023264356423169374, "vf_explained_var": 0.5466060638427734, "kl": 0.0009313690243288875, "entropy": 2.6606369018554688, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 900355, "num_agent_steps_sampled": 900355, "num_steps_trained": 900355, "num_agent_steps_trained": 900355}, "done": false, "episodes_total": 450, "training_iteration": 75, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-23-49", "timestamp": 1690831429, "time_this_iter_s": 62.7346293926239, "time_total_s": 4767.521624803543, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4767.521624803543, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.97222222222223, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8461491463671917, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8086189911356364, "reward_component_totals/dist_change_reward_min": -0.9898864253847217, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0375301552315594, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9423418746888654, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.7530155231553, "delta_v_total_min": 194.2341874688864, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1288.11, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1951, "constraint_violation.max_vel_constraint.ratio_mean": 0.6437331334332833, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9750124937531235}, "hist_stats": {"episode_reward": [-3.83870095779588, -3.746629150263786, -3.888588026128291, -3.983549594160506, -3.8611330001506134, -3.9933708961923635, -3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3271441197374299, "mean_inference_ms": 6.488504604689743, "mean_action_processing_ms": 0.31563915298970413, "mean_env_wait_ms": 7.140279137127214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 912361, "agent_timesteps_total": 912361, "timers": {"sample_time_ms": 32928.069, "sample_throughput": 364.613, "load_time_ms": 7.107, "load_throughput": 1689253.435, "learn_time_ms": 30256.257, "learn_throughput": 396.81, "update_time_ms": 22.387}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017425818368792534, "policy_loss": -0.0006490071536973119, "vf_loss": 0.00239159120246768, "vf_explained_var": 0.5061237215995789, "kl": 0.0009105824283324182, "entropy": 2.6470277309417725, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 912361, "num_agent_steps_sampled": 912361, "num_steps_trained": 912361, "num_agent_steps_trained": 912361}, "done": false, "episodes_total": 456, "training_iteration": 76, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-24-50", "timestamp": 1690831490, "time_this_iter_s": 60.61577224731445, "time_total_s": 4828.1373970508575, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4828.1373970508575, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.97558139534884, "ram_util_percent": 47.4}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8430533427563685, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8099504524268094, "reward_component_totals/dist_change_reward_min": -0.9898864253847217, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0331028903295634, "reward_component_totals/delta_v_min": -2.120721682757143, "reward_component_totals/delta_v_max": -1.9406734512746346, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.31028903295572, "delta_v_total_min": 194.06734512746337, "delta_v_total_max": 212.07216827571378, "constraint_violation.max_vel_constraint.steps_mean": 1277.97, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1950, "constraint_violation.max_vel_constraint.ratio_mean": 0.6386656671664168, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.974512743628186}, "hist_stats": {"episode_reward": [-3.9409229168366107, -3.860335451009159, -4.0229303462603205, -4.036991131900584, -3.788969856482134, -3.9083028025619226, -3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3269638735966678, "mean_inference_ms": 6.488362506469517, "mean_action_processing_ms": 0.3156896098643267, "mean_env_wait_ms": 7.142556302010264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 924367, "agent_timesteps_total": 924367, "timers": {"sample_time_ms": 32854.826, "sample_throughput": 365.426, "load_time_ms": 6.964, "load_throughput": 1723981.63, "learn_time_ms": 30458.865, "learn_throughput": 394.171, "update_time_ms": 22.898}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00016316730761900544, "policy_loss": -0.002236012602224946, "vf_loss": 0.002072845585644245, "vf_explained_var": 0.4727368652820587, "kl": 0.0012109724339097738, "entropy": 2.6035563945770264, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 924367, "num_agent_steps_sampled": 924367, "num_steps_trained": 924367, "num_agent_steps_trained": 924367}, "done": false, "episodes_total": 462, "training_iteration": 77, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-25-52", "timestamp": 1690831552, "time_this_iter_s": 62.526808738708496, "time_total_s": 4890.664205789566, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4890.664205789566, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.9688888888889, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8350497992503385, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8041660940833637, "reward_component_totals/dist_change_reward_min": -0.9827096885297303, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0308837051669792, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9341055052479172, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.08837051669735, "delta_v_total_min": 193.41055052479123, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1283.88, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1936, "constraint_violation.max_vel_constraint.ratio_mean": 0.6416191904047976, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9675162418790605}, "hist_stats": {"episode_reward": [-3.763668998334828, -3.829649209475554, -3.9426897718235208, -3.9867554755488754, -3.75240023406935, -3.866382468988298, -3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3268549317115181, "mean_inference_ms": 6.488217385559512, "mean_action_processing_ms": 0.31576631978919256, "mean_env_wait_ms": 7.14517566986805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 936373, "agent_timesteps_total": 936373, "timers": {"sample_time_ms": 32715.226, "sample_throughput": 366.985, "load_time_ms": 6.394, "load_throughput": 1877640.415, "learn_time_ms": 30401.239, "learn_throughput": 394.918, "update_time_ms": 24.785}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019811862148344517, "policy_loss": -0.0003453219833318144, "vf_loss": 0.0023265075869858265, "vf_explained_var": 0.5542009472846985, "kl": 0.00044496101327240467, "entropy": 2.603405475616455, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 936373, "num_agent_steps_sampled": 936373, "num_steps_trained": 936373, "num_agent_steps_trained": 936373}, "done": false, "episodes_total": 468, "training_iteration": 78, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-26-57", "timestamp": 1690831617, "time_this_iter_s": 64.47725415229797, "time_total_s": 4955.141459941864, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4955.141459941864, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.96956521739129, "ram_util_percent": 47.420652173913034}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.835519887877489, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8049123582204032, "reward_component_totals/dist_change_reward_min": -0.9827096885297303, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0306075296570896, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9341055052479172, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.06075296570828, "delta_v_total_min": 193.41055052479123, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1278.22, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1936, "constraint_violation.max_vel_constraint.ratio_mean": 0.6387906046976513, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9675162418790605}, "hist_stats": {"episode_reward": [-3.778326888611234, -3.8885157093339844, -3.757573762786614, -3.8434532563696493, -3.7388753092017772, -3.802306924413136, -3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.326736289476108, "mean_inference_ms": 6.487560392840478, "mean_action_processing_ms": 0.31583046233127227, "mean_env_wait_ms": 7.147659836032414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 948379, "agent_timesteps_total": 948379, "timers": {"sample_time_ms": 32487.223, "sample_throughput": 369.561, "load_time_ms": 6.143, "load_throughput": 1954465.897, "learn_time_ms": 30374.273, "learn_throughput": 395.269, "update_time_ms": 25.098}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0002248995442641899, "policy_loss": -0.0019508558325469494, "vf_loss": 0.002175753703340888, "vf_explained_var": 0.5379023551940918, "kl": 0.001877400791272521, "entropy": 2.5982916355133057, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 948379, "num_agent_steps_sampled": 948379, "num_steps_trained": 948379, "num_agent_steps_trained": 948379}, "done": false, "episodes_total": 474, "training_iteration": 79, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-27-56", "timestamp": 1690831676, "time_this_iter_s": 59.18232774734497, "time_total_s": 5014.323787689209, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5014.323787689209, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.97529411764705, "ram_util_percent": 47.4235294117647}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8319245502941146, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8006540545013892, "reward_component_totals/dist_change_reward_min": -0.9838919103365077, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0312704957927306, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9341055052479172, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.12704957927244, "delta_v_total_min": 193.41055052479123, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1251.45, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.6254122938530733, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.9131266495952137, -4.006912792809549, -3.842507730444858, -3.8274986456051066, -3.867212882871176, -3.8359149098161964, -3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3266163566251135, "mean_inference_ms": 6.486788778397919, "mean_action_processing_ms": 0.31588538517732123, "mean_env_wait_ms": 7.149974263183019, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 960385, "agent_timesteps_total": 960385, "timers": {"sample_time_ms": 32465.705, "sample_throughput": 369.806, "load_time_ms": 5.995, "load_throughput": 2002673.071, "learn_time_ms": 30216.953, "learn_throughput": 397.327, "update_time_ms": 26.229}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0025101618375629187, "policy_loss": -1.970294033526443e-05, "vf_loss": 0.00252986466512084, "vf_explained_var": 0.38175538182258606, "kl": 0.00038666470209136605, "entropy": 2.6918115615844727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 960385, "num_agent_steps_sampled": 960385, "num_steps_trained": 960385, "num_agent_steps_trained": 960385}, "done": false, "episodes_total": 480, "training_iteration": 80, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-28-57", "timestamp": 1690831737, "time_this_iter_s": 60.939879417419434, "time_total_s": 5075.263667106628, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5075.263667106628, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.967816091954, "ram_util_percent": 47.39999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8284057514538854, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8010753892198688, "reward_component_totals/dist_change_reward_min": -0.9838919103365077, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0273303622340197, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.7330362234014, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1262.36, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1934, "constraint_violation.max_vel_constraint.ratio_mean": 0.630864567716142, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9665167416291854}, "hist_stats": {"episode_reward": [-3.905646043748649, -3.9164744792987825, -3.8923558411825363, -4.0049018808529535, -3.879228787250861, -3.8985621444789578, -3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3274725235358573, "mean_inference_ms": 6.486207848415415, "mean_action_processing_ms": 0.315942174238106, "mean_env_wait_ms": 7.152483073372379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 972391, "agent_timesteps_total": 972391, "timers": {"sample_time_ms": 32407.58, "sample_throughput": 370.469, "load_time_ms": 6.194, "load_throughput": 1938291.525, "learn_time_ms": 30498.193, "learn_throughput": 393.663, "update_time_ms": 25.733}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 1.0000000116860974e-07, "total_loss": -6.525170465465635e-05, "policy_loss": -0.002000285778194666, "vf_loss": 0.0019350354559719563, "vf_explained_var": 0.62502521276474, "kl": 0.004081303253769875, "entropy": 2.45119571685791, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 972391, "num_agent_steps_sampled": 972391, "num_steps_trained": 972391, "num_agent_steps_trained": 972391}, "done": false, "episodes_total": 486, "training_iteration": 81, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-30-09", "timestamp": 1690831809, "time_this_iter_s": 71.67006540298462, "time_total_s": 5146.933732509613, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5146.933732509613, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 99.9735294117647, "ram_util_percent": 47.41078431372548}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3049302460241456, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8246115454111553, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7993954522802484, "reward_component_totals/dist_change_reward_min": -0.9926844716318104, "reward_component_totals/dist_change_reward_max": 0.7804112946998971, "reward_component_totals/delta_v_mean": -2.0252160931309096, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.52160931309044, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1294.34, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6468465767116441, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.9563853286144166, -3.752405896391449, -3.958262005302085, -3.96620923709923, -2.3049302460241456, -3.899845559616314, -3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3283133988890226, "mean_inference_ms": 6.485526764909539, "mean_action_processing_ms": 0.3159885074218367, "mean_env_wait_ms": 7.154686368475196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 984397, "agent_timesteps_total": 984397, "timers": {"sample_time_ms": 32463.06, "sample_throughput": 369.836, "load_time_ms": 5.637, "load_throughput": 2129990.687, "learn_time_ms": 30645.662, "learn_throughput": 391.768, "update_time_ms": 25.393}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0021069066133350134, "policy_loss": -0.0038922724779695272, "vf_loss": 0.0017853656318038702, "vf_explained_var": 0.7012780904769897, "kl": 0.0038277406711131334, "entropy": 2.360464334487915, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 984397, "num_agent_steps_sampled": 984397, "num_steps_trained": 984397, "num_agent_steps_trained": 984397}, "done": false, "episodes_total": 492, "training_iteration": 82, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-31-15", "timestamp": 1690831875, "time_this_iter_s": 65.43224811553955, "time_total_s": 5212.365980625153, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5212.365980625153, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.98936170212765, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8362802999038865, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8150018894845619, "reward_component_totals/dist_change_reward_min": -0.9926844716318104, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.021278410419329, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.1278410419323, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1308.2, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6537731134432783, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.827753186711984, -3.9462653650856554, -3.813679373618995, -3.8075606734588394, -3.8857022347330457, -3.8055201474818565, -3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.329105960375473, "mean_inference_ms": 6.484604783274391, "mean_action_processing_ms": 0.31603535936976584, "mean_env_wait_ms": 7.156643428733012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 996403, "agent_timesteps_total": 996403, "timers": {"sample_time_ms": 32588.674, "sample_throughput": 368.41, "load_time_ms": 5.621, "load_throughput": 2136016.977, "learn_time_ms": 30594.0, "learn_throughput": 392.43, "update_time_ms": 24.716}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0030727218836545944, "policy_loss": 0.0008362855296581984, "vf_loss": 0.0022364368196576834, "vf_explained_var": 0.45437973737716675, "kl": 0.00033469495247118175, "entropy": 2.588632822036743, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 996403, "num_agent_steps_sampled": 996403, "num_steps_trained": 996403, "num_agent_steps_trained": 996403}, "done": false, "episodes_total": 498, "training_iteration": 83, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-32-18", "timestamp": 1690831938, "time_this_iter_s": 62.728463649749756, "time_total_s": 5275.094444274902, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5275.094444274902, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.9876404494382, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.834463702101064, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8155151850859841, "reward_component_totals/dist_change_reward_min": -0.9926844716318104, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.018948517015083, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.8948517015078, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1309.83, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6545877061469265, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.7720106742160766, -3.7394012569463424, -3.9695685621342363, -3.9186045529128446, -3.834004608411046, -3.774562184265064, -4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3298151545700898, "mean_inference_ms": 6.483663198110979, "mean_action_processing_ms": 0.3160553721417948, "mean_env_wait_ms": 7.158206160257911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1008409, "agent_timesteps_total": 1008409, "timers": {"sample_time_ms": 32600.471, "sample_throughput": 368.277, "load_time_ms": 6.068, "load_throughput": 1978571.214, "learn_time_ms": 30802.305, "learn_throughput": 389.776, "update_time_ms": 25.305}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00016178165969904512, "policy_loss": -0.002350080292671919, "vf_loss": 0.0021882974542677402, "vf_explained_var": 0.5579361915588379, "kl": 0.0022543170489370823, "entropy": 2.5325798988342285, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1008409, "num_agent_steps_sampled": 1008409, "num_steps_trained": 1008409, "num_agent_steps_trained": 1008409}, "done": false, "episodes_total": 504, "training_iteration": 84, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-33-23", "timestamp": 1690832003, "time_this_iter_s": 65.0530652999878, "time_total_s": 5340.14750957489, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5340.14750957489, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.98817204301075, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8329853311709616, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8128671600289202, "reward_component_totals/dist_change_reward_min": -0.9926844716318104, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.0201181711420455, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.01181711420398, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1287.04, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6431984007996003, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-4.017381649088006, -3.815174092199025, -3.778058944238637, -3.882430292258512, -2.9210005928655245, -3.685806970191887, -3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3305487313922308, "mean_inference_ms": 6.482652678236581, "mean_action_processing_ms": 0.3160758369481731, "mean_env_wait_ms": 7.159797279243513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1020415, "agent_timesteps_total": 1020415, "timers": {"sample_time_ms": 32612.556, "sample_throughput": 368.14, "load_time_ms": 6.026, "load_throughput": 1992490.645, "learn_time_ms": 30882.535, "learn_throughput": 388.763, "update_time_ms": 22.843}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00037332295323722064, "policy_loss": -0.0028412912506610155, "vf_loss": 0.002467965940013528, "vf_explained_var": 0.3737802803516388, "kl": 0.0007724741008132696, "entropy": 2.659994602203369, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1020415, "num_agent_steps_sampled": 1020415, "num_steps_trained": 1020415, "num_agent_steps_trained": 1020415}, "done": false, "episodes_total": 510, "training_iteration": 85, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-34-27", "timestamp": 1690832067, "time_this_iter_s": 63.66332674026489, "time_total_s": 5403.810836315155, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5403.810836315155, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 99.98791208791208, "ram_util_percent": 47.501098901098906}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8428991766991305, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8228444302516273, "reward_component_totals/dist_change_reward_min": -0.9926844716318104, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.020054746447508, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.9065074657400494, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.0054746447501, "delta_v_total_min": 190.6507465740047, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1243.6, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6214892553723139, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.8593902801252957, -3.835315282121383, -3.748978338768385, -3.9750441802656367, -3.9166393750741357, -3.917853050460023, -3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3313141278037994, "mean_inference_ms": 6.481794286819049, "mean_action_processing_ms": 0.3160780849594789, "mean_env_wait_ms": 7.161084503212546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1032421, "agent_timesteps_total": 1032421, "timers": {"sample_time_ms": 32626.332, "sample_throughput": 367.985, "load_time_ms": 5.952, "load_throughput": 2017217.691, "learn_time_ms": 30870.191, "learn_throughput": 388.919, "update_time_ms": 22.757}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019148685969412327, "policy_loss": -0.00041134157800115645, "vf_loss": 0.002326213289052248, "vf_explained_var": 0.28102895617485046, "kl": 0.00010932875011349097, "entropy": 2.714252471923828, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1032421, "num_agent_steps_sampled": 1032421, "num_steps_trained": 1032421, "num_agent_steps_trained": 1032421}, "done": false, "episodes_total": 516, "training_iteration": 86, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-35-27", "timestamp": 1690832127, "time_this_iter_s": 60.59701108932495, "time_total_s": 5464.40784740448, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5464.40784740448, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 99.97674418604652, "ram_util_percent": 47.53139534883721}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8396259759208213, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8243080916489809, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.015317884271844, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.8891504434744495, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.5317884271838, "delta_v_total_min": 188.9150443474454, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1266.36, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6328635682158922, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.9849382610723008, -3.957901693383513, -3.9466946927216062, -3.9126646638056677, -3.9546344934516506, -3.7755003363088186, -3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3311076438321263, "mean_inference_ms": 6.481129246835305, "mean_action_processing_ms": 0.3160857631922152, "mean_env_wait_ms": 7.16243081858955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1044427, "agent_timesteps_total": 1044427, "timers": {"sample_time_ms": 32716.416, "sample_throughput": 366.972, "load_time_ms": 5.733, "load_throughput": 2094064.798, "learn_time_ms": 30809.379, "learn_throughput": 389.687, "update_time_ms": 20.853}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0015556078869849443, "policy_loss": -0.003234831616282463, "vf_loss": 0.0016792250098660588, "vf_explained_var": 0.865273118019104, "kl": 0.0021463348530232906, "entropy": 2.3539929389953613, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1044427, "num_agent_steps_sampled": 1044427, "num_steps_trained": 1044427, "num_agent_steps_trained": 1044427}, "done": false, "episodes_total": 522, "training_iteration": 87, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-36-30", "timestamp": 1690832190, "time_this_iter_s": 62.739542722702026, "time_total_s": 5527.147390127182, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5527.147390127182, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.99000000000001, "ram_util_percent": 47.50555555555555}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.074288163865965, "episode_reward_mean": -3.8374597622060054, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8234559234587622, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.0140038387472465, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.8891504434744495, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.4003838747241, "delta_v_total_min": 188.9150443474454, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1255.98, "constraint_violation.max_vel_constraint.steps_min": 382, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6276761619190405, "constraint_violation.max_vel_constraint.ratio_min": 0.19090454772613694, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.8647248413646444, -3.8445978511977286, -4.074288163865965, -3.869441573952999, -3.7462024121787483, -3.8079058577653813, -3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3309623083742061, "mean_inference_ms": 6.4802489541613575, "mean_action_processing_ms": 0.3160886118026119, "mean_env_wait_ms": 7.163835062038499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1056433, "agent_timesteps_total": 1056433, "timers": {"sample_time_ms": 32542.0, "sample_throughput": 368.939, "load_time_ms": 5.937, "load_throughput": 2022321.392, "learn_time_ms": 30685.526, "learn_throughput": 391.259, "update_time_ms": 21.157}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0021126093342900276, "policy_loss": -0.000472455081762746, "vf_loss": 0.0025850669480860233, "vf_explained_var": 0.48541706800460815, "kl": 0.00015230898861773312, "entropy": 2.6668574810028076, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1056433, "num_agent_steps_sampled": 1056433, "num_steps_trained": 1056433, "num_agent_steps_trained": 1056433}, "done": false, "episodes_total": 528, "training_iteration": 88, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-37-32", "timestamp": 1690832252, "time_this_iter_s": 61.36673712730408, "time_total_s": 5588.514127254486, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5588.514127254486, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.98068181818181, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.8300681812125426, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8170747099044898, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.0129934713080564, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.869223909874756, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.299347130805, "delta_v_total_min": 186.9223909874757, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1252.63, "constraint_violation.max_vel_constraint.steps_min": 442, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6260019990004997, "constraint_violation.max_vel_constraint.ratio_min": 0.22088955522238882, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.84436710838575, -3.891201251362764, -3.7475022190241245, -3.9037571944333544, -3.8739237278106096, -3.777198800278221, -3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308549593298702, "mean_inference_ms": 6.47947669664204, "mean_action_processing_ms": 0.3161052909278764, "mean_env_wait_ms": 7.1654622320334775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1068439, "agent_timesteps_total": 1068439, "timers": {"sample_time_ms": 32710.235, "sample_throughput": 367.041, "load_time_ms": 6.1, "load_throughput": 1968039.372, "learn_time_ms": 30929.584, "learn_throughput": 388.172, "update_time_ms": 22.096}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007410392281599343, "policy_loss": -0.0015723361866548657, "vf_loss": 0.0023133791983127594, "vf_explained_var": 0.5265703797340393, "kl": 0.0018721878295764327, "entropy": 2.599912166595459, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1068439, "num_agent_steps_sampled": 1068439, "num_steps_trained": 1068439, "num_agent_steps_trained": 1068439}, "done": false, "episodes_total": 534, "training_iteration": 89, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-38-35", "timestamp": 1690832315, "time_this_iter_s": 63.39261341094971, "time_total_s": 5651.906740665436, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5651.906740665436, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.9811111111111, "ram_util_percent": 47.51222222222223}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.8283008678154626, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8176823713358715, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.0106184964795943, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.869223909874756, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.0618496479588, "delta_v_total_min": 186.9223909874757, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1253.09, "constraint_violation.max_vel_constraint.steps_min": 442, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.626231884057971, "constraint_violation.max_vel_constraint.ratio_min": 0.22088955522238882, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.8548704423407534, -3.785319550936751, -3.8738759178577036, -3.794363011325342, -3.977451431144047, -3.761819940746845, -3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3308336507999852, "mean_inference_ms": 6.47926430491017, "mean_action_processing_ms": 0.31613048428587737, "mean_env_wait_ms": 7.167289660003162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1080445, "agent_timesteps_total": 1080445, "timers": {"sample_time_ms": 32873.039, "sample_throughput": 365.223, "load_time_ms": 6.059, "load_throughput": 1981521.958, "learn_time_ms": 31294.431, "learn_throughput": 383.647, "update_time_ms": 21.986}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00045168015640228987, "policy_loss": -0.0016650379402562976, "vf_loss": 0.002116720424965024, "vf_explained_var": 0.6387969851493835, "kl": 0.00037732679629698396, "entropy": 2.441035270690918, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1080445, "num_agent_steps_sampled": 1080445, "num_steps_trained": 1080445, "num_agent_steps_trained": 1080445}, "done": false, "episodes_total": 540, "training_iteration": 90, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-39-42", "timestamp": 1690832382, "time_this_iter_s": 66.23527908325195, "time_total_s": 5718.142019748688, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5718.142019748688, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.99157894736842, "ram_util_percent": 47.60000000000004}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.7866624909349516, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.8326807392852418, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8228905494090821, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.31133612541276423, "reward_component_totals/delta_v_mean": -2.009790189876162, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.869223909874756, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.97901898761566, "delta_v_total_min": 186.9223909874757, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1251.93, "constraint_violation.max_vel_constraint.steps_min": 442, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6256521739130435, "constraint_violation.max_vel_constraint.ratio_min": 0.22088955522238882, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.9466049924295703, -3.8232009550270254, -3.8264419274749137, -3.90289574410883, -4.024063474737822, -3.9807234929070807, -4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3316125574599165, "mean_inference_ms": 6.478884728284827, "mean_action_processing_ms": 0.3161508068263539, "mean_env_wait_ms": 7.169194387342153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1092451, "agent_timesteps_total": 1092451, "timers": {"sample_time_ms": 33118.698, "sample_throughput": 362.514, "load_time_ms": 5.868, "load_throughput": 2046026.89, "learn_time_ms": 31264.696, "learn_throughput": 384.011, "update_time_ms": 22.035}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002604665234684944, "policy_loss": 0.000274498452199623, "vf_loss": 0.002330167219042778, "vf_explained_var": 0.5770848989486694, "kl": 0.0006746477447450161, "entropy": 2.5381898880004883, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1092451, "num_agent_steps_sampled": 1092451, "num_steps_trained": 1092451, "num_agent_steps_trained": 1092451}, "done": false, "episodes_total": 546, "training_iteration": 91, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-40-56", "timestamp": 1690832456, "time_this_iter_s": 73.77978372573853, "time_total_s": 5791.921803474426, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5791.921803474426, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.9895238095238, "ram_util_percent": 47.57619047619048}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.808159733787247, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8049621864438733, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -2.0031975473433765, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.31975473433712, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1274.6, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6369815092453773, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-4.021637553092074, -3.7210416005914055, -3.8386791594781307, -3.807371232822993, -3.8386741260849826, -3.799298323091934, -3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3323818923899395, "mean_inference_ms": 6.478583801983615, "mean_action_processing_ms": 0.31617231466223056, "mean_env_wait_ms": 7.170915825229174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1104457, "agent_timesteps_total": 1104457, "timers": {"sample_time_ms": 33114.795, "sample_throughput": 362.557, "load_time_ms": 5.836, "load_throughput": 2057177.037, "learn_time_ms": 31058.535, "learn_throughput": 386.56, "update_time_ms": 21.685}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 1.0000000116860974e-07, "total_loss": -9.185836825054139e-05, "policy_loss": -0.0019577424973249435, "vf_loss": 0.0018658838234841824, "vf_explained_var": 0.7141229510307312, "kl": 0.004072204232215881, "entropy": 2.191807746887207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1104457, "num_agent_steps_sampled": 1104457, "num_steps_trained": 1104457, "num_agent_steps_trained": 1104457}, "done": false, "episodes_total": 552, "training_iteration": 92, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-41-59", "timestamp": 1690832519, "time_this_iter_s": 63.36291170120239, "time_total_s": 5855.284715175629, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5855.284715175629, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.99010989010988, "ram_util_percent": 47.47142857142856}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.8097730479047334, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8056537763735286, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -2.0041192715312075, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.41192715312027, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1265.49, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6324287856071963, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.7861768741313346, -4.006001476811233, -3.7018786427521992, -3.8703618207375152, -3.690482573659165, -3.8415943686282583, -3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3331859757523392, "mean_inference_ms": 6.478399159406135, "mean_action_processing_ms": 0.3161896139351205, "mean_env_wait_ms": 7.172717294355935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1116463, "agent_timesteps_total": 1116463, "timers": {"sample_time_ms": 33116.558, "sample_throughput": 362.538, "load_time_ms": 6.042, "load_throughput": 1987128.379, "learn_time_ms": 31054.492, "learn_throughput": 386.611, "update_time_ms": 22.639}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019662848208099604, "policy_loss": -0.00048724384396336973, "vf_loss": 0.0024535274133086205, "vf_explained_var": 0.3855622708797455, "kl": 8.94570184755139e-05, "entropy": 2.6936137676239014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1116463, "num_agent_steps_sampled": 1116463, "num_steps_trained": 1116463, "num_agent_steps_trained": 1116463}, "done": false, "episodes_total": 558, "training_iteration": 93, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-43-02", "timestamp": 1690832582, "time_this_iter_s": 62.82977080345154, "time_total_s": 5918.11448597908, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5918.11448597908, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.98999999999998, "ram_util_percent": 47.489999999999995}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.810535013561244, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8094894616924674, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -2.001045551868779, "reward_component_totals/delta_v_min": -2.103620141694946, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.1045551868775, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 210.3620141694937, "constraint_violation.max_vel_constraint.steps_mean": 1251.04, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6252073963018491, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.654451526385761, -3.7609954691234844, -3.9832084354387147, -3.8273657812123925, -3.9299176998913254, -3.805141863684973, -3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3340188370155794, "mean_inference_ms": 6.4783109806942125, "mean_action_processing_ms": 0.31623021691256337, "mean_env_wait_ms": 7.174580232390571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1128469, "agent_timesteps_total": 1128469, "timers": {"sample_time_ms": 33168.956, "sample_throughput": 361.965, "load_time_ms": 5.535, "load_throughput": 2169028.391, "learn_time_ms": 30734.121, "learn_throughput": 390.641, "update_time_ms": 21.934}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015653347363695502, "policy_loss": -0.00031946279341354966, "vf_loss": 0.0018848004983738065, "vf_explained_var": 0.7051515579223633, "kl": 0.0005127295153215528, "entropy": 2.399024724960327, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1128469, "num_agent_steps_sampled": 1128469, "num_steps_trained": 1128469, "num_agent_steps_trained": 1128469}, "done": false, "episodes_total": 564, "training_iteration": 94, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-44-05", "timestamp": 1690832645, "time_this_iter_s": 62.401827335357666, "time_total_s": 5980.516313314438, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5980.516313314438, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.98295454545455, "ram_util_percent": 47.399999999999984}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.811546648459371, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8144504280445336, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9970962204148406, "reward_component_totals/delta_v_min": -2.0979986163477125, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.70962204148353, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 209.7998616347705, "constraint_violation.max_vel_constraint.steps_mean": 1255.61, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6274912543728136, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.7774311918210013, -3.9491028889648616, -3.920853530490187, -3.806107846103072, -2.7866624909349516, -3.9104699467820545, -3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3348555634482928, "mean_inference_ms": 6.478379456041859, "mean_action_processing_ms": 0.3162721108125778, "mean_env_wait_ms": 7.176450927620791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1140475, "agent_timesteps_total": 1140475, "timers": {"sample_time_ms": 33217.186, "sample_throughput": 361.439, "load_time_ms": 5.77, "load_throughput": 2080937.466, "learn_time_ms": 30668.41, "learn_throughput": 391.478, "update_time_ms": 22.902}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.000301765016047284, "policy_loss": -0.001743812346830964, "vf_loss": 0.002045577159151435, "vf_explained_var": 0.6586340665817261, "kl": 0.0010982519015669823, "entropy": 2.403679847717285, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1140475, "num_agent_steps_sampled": 1140475, "num_steps_trained": 1140475, "num_agent_steps_trained": 1140475}, "done": false, "episodes_total": 570, "training_iteration": 95, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-45-08", "timestamp": 1690832708, "time_this_iter_s": 63.49249577522278, "time_total_s": 6044.008809089661, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6044.008809089661, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.98571428571428, "ram_util_percent": 47.39999999999998}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.06875465564141, "episode_reward_mean": -3.8159148135912293, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8194490254955366, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9964657880956957, "reward_component_totals/delta_v_min": -2.084862745304904, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.64657880956915, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 208.48627453049002, "constraint_violation.max_vel_constraint.steps_mean": 1233.55, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6164667666166916, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.8466394402026056, -3.9006455296837244, -4.06875465564141, -3.9363460291343273, -3.8578029191732797, -3.632765008392427, -3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3357277007484263, "mean_inference_ms": 6.478728539197076, "mean_action_processing_ms": 0.31629830985870844, "mean_env_wait_ms": 7.1783498181450724, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1152481, "agent_timesteps_total": 1152481, "timers": {"sample_time_ms": 33248.157, "sample_throughput": 361.103, "load_time_ms": 5.955, "load_throughput": 2016054.745, "learn_time_ms": 30647.374, "learn_throughput": 391.746, "update_time_ms": 23.572}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0010375513229519129, "policy_loss": -0.003083319403231144, "vf_loss": 0.0020457685459405184, "vf_explained_var": 0.6272467970848083, "kl": 0.0011364640668034554, "entropy": 2.446208953857422, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1152481, "num_agent_steps_sampled": 1152481, "num_steps_trained": 1152481, "num_agent_steps_trained": 1152481}, "done": false, "episodes_total": 576, "training_iteration": 96, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-46-09", "timestamp": 1690832769, "time_this_iter_s": 60.724395751953125, "time_total_s": 6104.733204841614, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6104.733204841614, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.98390804597702, "ram_util_percent": 47.39999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8100257465079386, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8157083775336509, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9943173689742912, "reward_component_totals/delta_v_min": -2.08401237199704, "reward_component_totals/delta_v_max": -1.8641694541275509, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.43173689742866, "delta_v_total_min": 186.41694541275535, "delta_v_total_max": 208.4012371997037, "constraint_violation.max_vel_constraint.steps_mean": 1237.49, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6184357821089455, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.8227568199383803, -3.7191762877043795, -3.884492841892418, -4.024299850018188, -3.702715844926039, -3.8624588374385347, -3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3357404121945842, "mean_inference_ms": 6.479235510109785, "mean_action_processing_ms": 0.31632638417535464, "mean_env_wait_ms": 7.180338907263414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1164487, "agent_timesteps_total": 1164487, "timers": {"sample_time_ms": 33159.344, "sample_throughput": 362.07, "load_time_ms": 6.035, "load_throughput": 1989373.554, "learn_time_ms": 30744.202, "learn_throughput": 390.513, "update_time_ms": 25.287}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0018255957402288914, "policy_loss": -0.0005143105518072844, "vf_loss": 0.00233990466222167, "vf_explained_var": 0.5490032434463501, "kl": 0.000361787126166746, "entropy": 2.4750864505767822, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1164487, "num_agent_steps_sampled": 1164487, "num_steps_trained": 1164487, "num_agent_steps_trained": 1164487}, "done": false, "episodes_total": 582, "training_iteration": 97, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-47-12", "timestamp": 1690832832, "time_this_iter_s": 62.87428021430969, "time_total_s": 6167.6074850559235, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6167.6074850559235, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.98202247191011, "ram_util_percent": 47.42247191011234}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.804650470740753, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8133789087639819, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9912715619767736, "reward_component_totals/delta_v_min": -2.08401237199704, "reward_component_totals/delta_v_max": -1.862258182714381, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.12715619767684, "delta_v_total_min": 186.22581827143816, "delta_v_total_max": 208.4012371997037, "constraint_violation.max_vel_constraint.steps_mean": 1236.75, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1997, "constraint_violation.max_vel_constraint.ratio_mean": 0.6180659670164917, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9980009995002499}, "hist_stats": {"episode_reward": [-3.891108385411981, -4.015851730679241, -3.779358383363591, -3.8662553907203323, -3.83110846370884, -3.8393666152775934, -3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.33568965764323, "mean_inference_ms": 6.479479317719044, "mean_action_processing_ms": 0.31636006967720803, "mean_env_wait_ms": 7.182203550739136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1176493, "agent_timesteps_total": 1176493, "timers": {"sample_time_ms": 33460.694, "sample_throughput": 358.809, "load_time_ms": 5.87, "load_throughput": 2045245.755, "learn_time_ms": 30812.875, "learn_throughput": 389.642, "update_time_ms": 24.365}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0002268553216708824, "policy_loss": -0.0019844810012727976, "vf_loss": 0.0022113367449492216, "vf_explained_var": 0.5270036458969116, "kl": 0.0015154873253777623, "entropy": 2.3451344966888428, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1176493, "num_agent_steps_sampled": 1176493, "num_steps_trained": 1176493, "num_agent_steps_trained": 1176493}, "done": false, "episodes_total": 588, "training_iteration": 98, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-48-18", "timestamp": 1690832898, "time_this_iter_s": 65.03413438796997, "time_total_s": 6232.641619443893, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6232.641619443893, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 99.98602150537633, "ram_util_percent": 47.44301075268815}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.7999998112634716, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8131629157837128, "reward_component_totals/dist_change_reward_min": -0.994780364310988, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9868368954797617, "reward_component_totals/delta_v_min": -2.08401237199704, "reward_component_totals/delta_v_max": -1.8597127791245789, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.68368954797566, "delta_v_total_min": 185.9712779124578, "delta_v_total_max": 208.4012371997037, "constraint_violation.max_vel_constraint.steps_mean": 1227.08, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6132333833083458, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.903613476133888, -3.731861101600672, -3.853131853764876, -3.8458322118349777, -3.759158042889524, -3.8128909254820593, -3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3356549874616517, "mean_inference_ms": 6.47985104741005, "mean_action_processing_ms": 0.31640836353671536, "mean_env_wait_ms": 7.184085709280582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1188499, "agent_timesteps_total": 1188499, "timers": {"sample_time_ms": 33472.517, "sample_throughput": 358.682, "load_time_ms": 5.922, "load_throughput": 2027295.902, "learn_time_ms": 30816.485, "learn_throughput": 389.597, "update_time_ms": 27.376}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.001128522795625031, "policy_loss": -0.0007230271003209054, "vf_loss": 0.0018515485571697354, "vf_explained_var": 0.7059680819511414, "kl": 0.0012548466911539435, "entropy": 2.1157565116882324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1188499, "num_agent_steps_sampled": 1188499, "num_steps_trained": 1188499, "num_agent_steps_trained": 1188499}, "done": false, "episodes_total": 594, "training_iteration": 99, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-49-21", "timestamp": 1690832961, "time_this_iter_s": 63.59441637992859, "time_total_s": 6296.236035823822, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6296.236035823822, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.99010989010989, "ram_util_percent": 47.43956043956044}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8013577998379655, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8179473173737312, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.983410482464237, "reward_component_totals/delta_v_min": -2.08401237199704, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.34104824642327, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.4012371997037, "constraint_violation.max_vel_constraint.steps_mean": 1226.98, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.613183408295852, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.813174509641435, -3.78620780687921, -3.9241398696797503, -3.809250046236112, -3.783972489024306, -3.8721320096028933, -3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3356398173562447, "mean_inference_ms": 6.480227516265707, "mean_action_processing_ms": 0.3164599330953061, "mean_env_wait_ms": 7.185988986639302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1200505, "agent_timesteps_total": 1200505, "timers": {"sample_time_ms": 33333.078, "sample_throughput": 360.183, "load_time_ms": 6.049, "load_throughput": 1984653.583, "learn_time_ms": 30937.105, "learn_throughput": 388.078, "update_time_ms": 26.607}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015514484839513898, "policy_loss": -0.0007196381338872015, "vf_loss": 0.0022710857447236776, "vf_explained_var": 0.4375649690628052, "kl": 0.0013934723101556301, "entropy": 2.4696826934814453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1200505, "num_agent_steps_sampled": 1200505, "num_steps_trained": 1200505, "num_agent_steps_trained": 1200505}, "done": false, "episodes_total": 600, "training_iteration": 100, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-50-27", "timestamp": 1690833027, "time_this_iter_s": 66.01971769332886, "time_total_s": 6362.255753517151, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6362.255753517151, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.98936170212765, "ram_util_percent": 47.439361702127634}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.800816694071206, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8196229308742408, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.981193763196968, "reward_component_totals/delta_v_min": -2.08401237199704, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.1193763196963, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.4012371997037, "constraint_violation.max_vel_constraint.steps_mean": 1222.53, "constraint_violation.max_vel_constraint.steps_min": 476, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6109595202398801, "constraint_violation.max_vel_constraint.ratio_min": 0.23788105947026486, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.768881251531603, -3.943606652881742, -3.6695625049811538, -3.822159837853719, -3.7428391627733193, -3.8796015896005884, -3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3362864114993835, "mean_inference_ms": 6.480410998660122, "mean_action_processing_ms": 0.3165107658098455, "mean_env_wait_ms": 7.187717204859639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1212511, "agent_timesteps_total": 1212511, "timers": {"sample_time_ms": 33131.763, "sample_throughput": 362.371, "load_time_ms": 6.042, "load_throughput": 1987057.809, "learn_time_ms": 30822.57, "learn_throughput": 389.52, "update_time_ms": 25.079}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0004525918047875166, "policy_loss": -0.0028519253246486187, "vf_loss": 0.0023993314243853092, "vf_explained_var": 0.4256519079208374, "kl": 0.0009652082808315754, "entropy": 2.6570467948913574, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1212511, "num_agent_steps_sampled": 1212511, "num_steps_trained": 1212511, "num_agent_steps_trained": 1212511}, "done": false, "episodes_total": 606, "training_iteration": 101, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-51-38", "timestamp": 1690833098, "time_this_iter_s": 70.64749431610107, "time_total_s": 6432.903247833252, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6432.903247833252, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.98415841584158, "ram_util_percent": 47.48910891089108}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8055649858783362, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8251187121536003, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9804462737247375, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.04462737247323, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1227.16, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6132733633183409, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.8226952995208814, -3.9602082823300364, -3.7633409476386075, -3.9225518117950786, -3.6267724263302084, -3.8984303624378915, -3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3369226093810016, "mean_inference_ms": 6.480607288774484, "mean_action_processing_ms": 0.3165670170964341, "mean_env_wait_ms": 7.1893292520574485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1224517, "agent_timesteps_total": 1224517, "timers": {"sample_time_ms": 33230.393, "sample_throughput": 361.296, "load_time_ms": 6.115, "load_throughput": 1963496.533, "learn_time_ms": 30755.725, "learn_throughput": 390.366, "update_time_ms": 26.746}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0010750095825642347, "policy_loss": -0.0014576469548046589, "vf_loss": 0.002532659098505974, "vf_explained_var": 0.48268041014671326, "kl": 0.0008776187896728516, "entropy": 2.591970682144165, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1224517, "num_agent_steps_sampled": 1224517, "num_steps_trained": 1224517, "num_agent_steps_trained": 1224517}, "done": false, "episodes_total": 612, "training_iteration": 102, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-52-42", "timestamp": 1690833162, "time_this_iter_s": 63.739866971969604, "time_total_s": 6496.643114805222, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6496.643114805222, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 99.98586956521739, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8074778853664526, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8297193015560235, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9777585838104317, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.7758583810427, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1254.6, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6269865067466267, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.983902297713888, -3.644062628819234, -3.8888019058972336, -3.8839308077854366, -3.8976851826803887, -3.7888005539366927, -3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3375573824697145, "mean_inference_ms": 6.480982893947332, "mean_action_processing_ms": 0.3166137393566706, "mean_env_wait_ms": 7.1909938817373655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1236523, "agent_timesteps_total": 1236523, "timers": {"sample_time_ms": 33353.284, "sample_throughput": 359.965, "load_time_ms": 6.019, "load_throughput": 1994526.738, "learn_time_ms": 30720.272, "learn_throughput": 390.817, "update_time_ms": 24.376}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0018670065328478813, "policy_loss": -0.0002726548118516803, "vf_loss": 0.002139661693945527, "vf_explained_var": 0.5941134095191956, "kl": 0.000429200881626457, "entropy": 2.4304165840148926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1236523, "num_agent_steps_sampled": 1236523, "num_steps_trained": 1236523, "num_agent_steps_trained": 1236523}, "done": false, "episodes_total": 618, "training_iteration": 103, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-53-46", "timestamp": 1690833226, "time_this_iter_s": 63.57092237472534, "time_total_s": 6560.214037179947, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6560.214037179947, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.99111111111112, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8016597370842207, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8268683549497627, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9747913821344603, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.4791382134456, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1262.13, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6307496251874063, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9067311815899495, -3.970684380953233, -3.7888410843176175, -3.9629703857840743, -3.937750491249931, -3.7586236471741694, -3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.338158041719633, "mean_inference_ms": 6.4813163674902965, "mean_action_processing_ms": 0.3166497692077181, "mean_env_wait_ms": 7.192540282714212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1248529, "agent_timesteps_total": 1248529, "timers": {"sample_time_ms": 33218.63, "sample_throughput": 361.424, "load_time_ms": 6.17, "load_throughput": 1946014.16, "learn_time_ms": 30993.703, "learn_throughput": 387.369, "update_time_ms": 24.544}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0016473459545522928, "policy_loss": -0.0003506435896269977, "vf_loss": 0.0019979900680482388, "vf_explained_var": 0.6021619439125061, "kl": 0.0006991981063038111, "entropy": 2.3468708992004395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1248529, "num_agent_steps_sampled": 1248529, "num_steps_trained": 1248529, "num_agent_steps_trained": 1248529}, "done": false, "episodes_total": 624, "training_iteration": 104, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-54-50", "timestamp": 1690833290, "time_this_iter_s": 63.77915143966675, "time_total_s": 6623.993188619614, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6623.993188619614, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.98791208791208, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.791732167791193, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8172780524222703, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9744541153689257, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.44541153689207, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1259.02, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6291954022988506, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.763538475523757, -3.793691490148267, -3.836268771240902, -3.3781297256421383, -3.847937017364065, -3.8192740607042213, -3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3387274581681794, "mean_inference_ms": 6.481735734638345, "mean_action_processing_ms": 0.31666849632834626, "mean_env_wait_ms": 7.193846389955948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1260535, "agent_timesteps_total": 1260535, "timers": {"sample_time_ms": 33066.331, "sample_throughput": 363.088, "load_time_ms": 5.75, "load_throughput": 2087969.525, "learn_time_ms": 30956.824, "learn_throughput": 387.83, "update_time_ms": 24.189}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015488455537706614, "policy_loss": -0.0009108136291615665, "vf_loss": 0.002459659008309245, "vf_explained_var": 0.48934119939804077, "kl": 0.0005102881696075201, "entropy": 2.637873888015747, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1260535, "num_agent_steps_sampled": 1260535, "num_steps_trained": 1260535, "num_agent_steps_trained": 1260535}, "done": false, "episodes_total": 630, "training_iteration": 105, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-55-52", "timestamp": 1690833352, "time_this_iter_s": 61.5720751285553, "time_total_s": 6685.565263748169, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6685.565263748169, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.9875, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.793822952656289, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.823210027776996, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9706129248792958, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.0612924879291, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1270.13, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6347476261869065, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.7289348845233645, -3.798731166957, -3.990061739702419, -3.6762800923357526, -4.032056178843145, -3.774188866709183, -3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3392790302558892, "mean_inference_ms": 6.4819748721434705, "mean_action_processing_ms": 0.3166757780066255, "mean_env_wait_ms": 7.194842764769454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1272541, "agent_timesteps_total": 1272541, "timers": {"sample_time_ms": 32994.245, "sample_throughput": 363.882, "load_time_ms": 5.665, "load_throughput": 2119421.282, "learn_time_ms": 31155.809, "learn_throughput": 385.353, "update_time_ms": 29.622}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00017438223585486412, "policy_loss": -0.0021461036521941423, "vf_loss": 0.00197172281332314, "vf_explained_var": 0.648553729057312, "kl": 0.0023190598003566265, "entropy": 2.307065010070801, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1272541, "num_agent_steps_sampled": 1272541, "num_steps_trained": 1272541, "num_agent_steps_trained": 1272541}, "done": false, "episodes_total": 636, "training_iteration": 106, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-56-54", "timestamp": 1690833414, "time_this_iter_s": 62.07011818885803, "time_total_s": 6747.635381937027, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6747.635381937027, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.98426966292135, "ram_util_percent": 47.433707865168536}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.7883489891612134, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8182919339069321, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9700570552542833, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.0057055254279, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1263.69, "constraint_violation.max_vel_constraint.steps_min": 495, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6315292353823088, "constraint_violation.max_vel_constraint.ratio_min": 0.24737631184407796, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.947033146013706, -3.979116435811294, -3.8612146057904675, -3.8920782081615624, -3.671882661591865, -3.782587549279463, -3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3389956661400246, "mean_inference_ms": 6.482097177555554, "mean_action_processing_ms": 0.3166684000246509, "mean_env_wait_ms": 7.195647402634172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1284547, "agent_timesteps_total": 1284547, "timers": {"sample_time_ms": 33008.751, "sample_throughput": 363.722, "load_time_ms": 6.112, "load_throughput": 1964454.0, "learn_time_ms": 31129.176, "learn_throughput": 385.683, "update_time_ms": 29.195}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0018658590270206332, "policy_loss": -0.0005214583361521363, "vf_loss": 0.0023873168975114822, "vf_explained_var": 0.4591268301010132, "kl": 0.000466622703243047, "entropy": 2.5838332176208496, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1284547, "num_agent_steps_sampled": 1284547, "num_steps_trained": 1284547, "num_agent_steps_trained": 1284547}, "done": false, "episodes_total": 642, "training_iteration": 107, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-57-57", "timestamp": 1690833477, "time_this_iter_s": 62.738590240478516, "time_total_s": 6810.3739721775055, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6810.3739721775055, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.98777777777778, "ram_util_percent": 47.49111111111111}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.1472308190781555, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.7870741011811955, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8163796163850684, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": 0.9367815529188842, "reward_component_totals/delta_v_mean": -1.9706944847961299, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.06944847961248, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1248.54, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6239580209895053, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9121950139281307, -3.8731063322378656, -3.664827660770328, -2.1472308190781555, -3.83212681831211, -4.042879112087582, -3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.338635395392374, "mean_inference_ms": 6.482267382042039, "mean_action_processing_ms": 0.31666068228607325, "mean_env_wait_ms": 7.196231989605243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1296553, "agent_timesteps_total": 1296553, "timers": {"sample_time_ms": 32714.293, "sample_throughput": 366.996, "load_time_ms": 6.045, "load_throughput": 1986250.53, "learn_time_ms": 31204.757, "learn_throughput": 384.749, "update_time_ms": 27.486}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.001543110585771501, "policy_loss": -0.0007425170624628663, "vf_loss": 0.0022856267169117928, "vf_explained_var": 0.4851512610912323, "kl": 0.0007569357985630631, "entropy": 2.556049346923828, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1296553, "num_agent_steps_sampled": 1296553, "num_steps_trained": 1296553, "num_agent_steps_trained": 1296553}, "done": false, "episodes_total": 648, "training_iteration": 108, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_12-59-00", "timestamp": 1690833540, "time_this_iter_s": 62.903034925460815, "time_total_s": 6873.277007102966, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6873.277007102966, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.98539325842698, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.2003767261211182, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.801626716025737, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8303841865122982, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9712425295134415, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.12425295134366, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1240.2, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6197901049475262, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.746598410841904, -3.7167785063057424, -3.9659169537567727, -3.8837336056060594, -3.869785864698734, -3.6827722227000788, -3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3382717708899592, "mean_inference_ms": 6.482700836968694, "mean_action_processing_ms": 0.3166545331063277, "mean_env_wait_ms": 7.196803705930791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1308559, "agent_timesteps_total": 1308559, "timers": {"sample_time_ms": 32729.202, "sample_throughput": 366.828, "load_time_ms": 5.758, "load_throughput": 2085021.503, "learn_time_ms": 31312.415, "learn_throughput": 383.426, "update_time_ms": 24.962}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00014283652126323432, "policy_loss": -0.0023816267494112253, "vf_loss": 0.002238789340481162, "vf_explained_var": 0.4767211079597473, "kl": 0.0003833778027910739, "entropy": 2.5501911640167236, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1308559, "num_agent_steps_sampled": 1308559, "num_steps_trained": 1308559, "num_agent_steps_trained": 1308559}, "done": false, "episodes_total": 654, "training_iteration": 109, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-00-05", "timestamp": 1690833605, "time_this_iter_s": 64.68295454978943, "time_total_s": 6937.959961652756, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6937.959961652756, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.98494623655914, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.2003767261211182, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8048442506897855, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8336672578248789, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.97117699286491, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.1176992864905, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1240.64, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6200099950024988, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.7486548656279295, -3.830399508477214, -3.8623255114207913, -3.9787543494460023, -3.7832197656009385, -3.9110796855921204, -4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337859558530403, "mean_inference_ms": 6.483074449210078, "mean_action_processing_ms": 0.3166329369519247, "mean_env_wait_ms": 7.197118500393653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1320565, "agent_timesteps_total": 1320565, "timers": {"sample_time_ms": 32671.577, "sample_throughput": 367.475, "load_time_ms": 5.854, "load_throughput": 2050935.068, "learn_time_ms": 31363.275, "learn_throughput": 382.804, "update_time_ms": 24.469}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0014163712039589882, "policy_loss": -0.003700739936903119, "vf_loss": 0.0022843678016215563, "vf_explained_var": 0.4621879458427429, "kl": 0.0009443329181522131, "entropy": 2.5898661613464355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1320565, "num_agent_steps_sampled": 1320565, "num_steps_trained": 1320565, "num_agent_steps_trained": 1320565}, "done": false, "episodes_total": 660, "training_iteration": 110, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-01-11", "timestamp": 1690833671, "time_this_iter_s": 65.9066379070282, "time_total_s": 7003.866599559784, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7003.866599559784, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.9904255319149, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.2003767261211182, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.802702384640706, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.831452127051782, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9712502575889261, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.12502575889212, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1237.83, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6186056971514243, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.017590585580892, -4.01365036802168, -3.6720800642102867, -3.6646237965434185, -3.7328070582762125, -3.662628110169811, -3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3381105022816124, "mean_inference_ms": 6.48328107079964, "mean_action_processing_ms": 0.3165880738775525, "mean_env_wait_ms": 7.1970609572195725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1332571, "agent_timesteps_total": 1332571, "timers": {"sample_time_ms": 32797.297, "sample_throughput": 366.067, "load_time_ms": 5.705, "load_throughput": 2104566.891, "learn_time_ms": 31476.283, "learn_throughput": 381.43, "update_time_ms": 25.591}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0017575945239514112, "policy_loss": -0.003865375416353345, "vf_loss": 0.002107782056555152, "vf_explained_var": 0.5856656432151794, "kl": 0.0010497363982722163, "entropy": 2.443458080291748, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1332571, "num_agent_steps_sampled": 1332571, "num_steps_trained": 1332571, "num_agent_steps_trained": 1332571}, "done": false, "episodes_total": 666, "training_iteration": 111, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-02-24", "timestamp": 1690833744, "time_this_iter_s": 73.05983424186707, "time_total_s": 7076.926433801651, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7076.926433801651, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 99.98365384615386, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.2003767261211182, "episode_reward_min": -4.064490746052947, "episode_reward_mean": -3.8008262189667374, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8276918560431351, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9731343629236053, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.31343629236014, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1231.05, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6152173913043479, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.2003767261211182, -3.972612054687221, -3.9545297129746735, -4.064490746052947, -3.7767895033390797, -3.9386438956864884, -3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3383497996842473, "mean_inference_ms": 6.483428381368023, "mean_action_processing_ms": 0.31654095158240847, "mean_env_wait_ms": 7.196965334019203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1344577, "agent_timesteps_total": 1344577, "timers": {"sample_time_ms": 32680.991, "sample_throughput": 367.37, "load_time_ms": 5.942, "load_throughput": 2020698.374, "learn_time_ms": 31616.057, "learn_throughput": 379.744, "update_time_ms": 24.746}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0008800016366876662, "policy_loss": -0.0014420448569580913, "vf_loss": 0.0023220479488372803, "vf_explained_var": 0.5513808131217957, "kl": 0.0003340975963510573, "entropy": 2.474189043045044, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1344577, "num_agent_steps_sampled": 1344577, "num_steps_trained": 1344577, "num_agent_steps_trained": 1344577}, "done": false, "episodes_total": 672, "training_iteration": 112, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-03-28", "timestamp": 1690833808, "time_this_iter_s": 63.93122744560242, "time_total_s": 7140.857661247253, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7140.857661247253, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.99000000000001, "ram_util_percent": 47.48222222222222}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.035475553531553, "episode_reward_mean": -3.797856946110431, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8298169329426713, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.968040013167762, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 196.80400131677573, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1265.67, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6325187406296852, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.7609619257515376, -3.615753226992652, -3.8184622712864646, -3.743436050842511, -3.6889444657663457, -3.7621421777777444, -3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3385690727487012, "mean_inference_ms": 6.4834756162536245, "mean_action_processing_ms": 0.3165062563132293, "mean_env_wait_ms": 7.196774460226858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1356583, "agent_timesteps_total": 1356583, "timers": {"sample_time_ms": 32653.941, "sample_throughput": 367.674, "load_time_ms": 5.894, "load_throughput": 2036881.943, "learn_time_ms": 31653.739, "learn_throughput": 379.292, "update_time_ms": 26.074}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0011456706561148167, "policy_loss": -0.003019860712811351, "vf_loss": 0.0018741902895271778, "vf_explained_var": 0.6086142063140869, "kl": 0.0010763820027932525, "entropy": 2.318783760070801, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1356583, "num_agent_steps_sampled": 1356583, "num_steps_trained": 1356583, "num_agent_steps_trained": 1356583}, "done": false, "episodes_total": 678, "training_iteration": 113, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-04-32", "timestamp": 1690833872, "time_this_iter_s": 63.715941429138184, "time_total_s": 7204.573602676392, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7204.573602676392, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.98901098901099, "ram_util_percent": 47.46813186813187}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.035475553531553, "episode_reward_mean": -3.8003753326950522, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8293975113091915, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9709778213858637, "reward_component_totals/delta_v_min": -2.085860812067994, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.0977821385859, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.58608120679784, "constraint_violation.max_vel_constraint.steps_mean": 1251.71, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6255422288855572, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.6726813682639103, -3.9895051907483907, -3.6415911850265075, -3.7235085176163945, -3.7535943946667514, -3.9702133687199304, -3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3387807933111657, "mean_inference_ms": 6.483399015041016, "mean_action_processing_ms": 0.31645939597934, "mean_env_wait_ms": 7.196389982371621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1368589, "agent_timesteps_total": 1368589, "timers": {"sample_time_ms": 32671.261, "sample_throughput": 367.479, "load_time_ms": 5.831, "load_throughput": 2059170.711, "learn_time_ms": 31575.199, "learn_throughput": 380.235, "update_time_ms": 27.026}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00011675484711304307, "policy_loss": -0.002365579828619957, "vf_loss": 0.00248233275488019, "vf_explained_var": 0.44195646047592163, "kl": 0.0011238179868087173, "entropy": 2.618939161300659, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1368589, "num_agent_steps_sampled": 1368589, "num_steps_trained": 1368589, "num_agent_steps_trained": 1368589}, "done": false, "episodes_total": 684, "training_iteration": 114, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-05-35", "timestamp": 1690833935, "time_this_iter_s": 63.096967935562134, "time_total_s": 7267.670570611954, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7267.670570611954, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.99010989010989, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.035475553531553, "episode_reward_mean": -3.8035192227182, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.82682134664478, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9766978760734235, "reward_component_totals/delta_v_min": -2.087008171379572, "reward_component_totals/delta_v_max": -1.8292784758905616, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.66978760734185, "delta_v_total_min": 182.92784758905557, "delta_v_total_max": 208.70081713795634, "constraint_violation.max_vel_constraint.steps_mean": 1239.6, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.6194902548725638, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.6753927714261705, -3.783824473600319, -3.767100362128314, -3.807857650891993, -3.6016407115093068, -3.914927112041149, -3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.33896446819153, "mean_inference_ms": 6.483238386497412, "mean_action_processing_ms": 0.3164083872338386, "mean_env_wait_ms": 7.195986059605634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1380595, "agent_timesteps_total": 1380595, "timers": {"sample_time_ms": 32713.032, "sample_throughput": 367.01, "load_time_ms": 6.08, "load_throughput": 1974552.456, "learn_time_ms": 31582.296, "learn_throughput": 380.15, "update_time_ms": 27.697}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0001839098840719089, "policy_loss": -0.0022410028614103794, "vf_loss": 0.0024249134585261345, "vf_explained_var": 0.39859312772750854, "kl": 0.0013069009874016047, "entropy": 2.6677212715148926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1380595, "num_agent_steps_sampled": 1380595, "num_steps_trained": 1380595, "num_agent_steps_trained": 1380595}, "done": false, "episodes_total": 690, "training_iteration": 115, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-06-37", "timestamp": 1690833997, "time_this_iter_s": 62.11950182914734, "time_total_s": 7329.790072441101, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7329.790072441101, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 99.98522727272726, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.035475553531553, "episode_reward_mean": -3.810062874085944, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8266726337281268, "reward_component_totals/dist_change_reward_min": -0.9989304010706928, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9833902403578196, "reward_component_totals/delta_v_min": -2.087008171379572, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.33902403578145, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 208.70081713795634, "constraint_violation.max_vel_constraint.steps_mean": 1229.87, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6146276861569215, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.935904356950301, -3.874190898666762, -3.7797290237579917, -3.935894366229875, -3.9829051438032135, -3.687020942359961, -3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3391859027233826, "mean_inference_ms": 6.482991501464831, "mean_action_processing_ms": 0.31634762176425296, "mean_env_wait_ms": 7.195547622383282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1392601, "agent_timesteps_total": 1392601, "timers": {"sample_time_ms": 32771.576, "sample_throughput": 366.354, "load_time_ms": 5.937, "load_throughput": 2022134.612, "learn_time_ms": 31634.893, "learn_throughput": 379.518, "update_time_ms": 21.818}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0014650033554062247, "policy_loss": -0.0008886419818736613, "vf_loss": 0.0023536458611488342, "vf_explained_var": 0.5497469902038574, "kl": 0.0007203962886705995, "entropy": 2.638197898864746, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1392601, "num_agent_steps_sampled": 1392601, "num_steps_trained": 1392601, "num_agent_steps_trained": 1392601}, "done": false, "episodes_total": 696, "training_iteration": 116, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-07-40", "timestamp": 1690834060, "time_this_iter_s": 63.05882716178894, "time_total_s": 7392.84889960289, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7392.84889960289, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.98666666666666, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.8112124705173596, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8271470830865728, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9840653874307908, "reward_component_totals/delta_v_min": -2.087008171379572, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.40653874307856, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 208.70081713795634, "constraint_violation.max_vel_constraint.steps_mean": 1236.96, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6181709145427287, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.8909496678385125, -3.7910598244966343, -3.7780632737316715, -3.8047673021577593, -3.686490123884796, -4.023289543657214, -3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.338743299796585, "mean_inference_ms": 6.483002671797647, "mean_action_processing_ms": 0.31628946275824094, "mean_env_wait_ms": 7.194995760783018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1404607, "agent_timesteps_total": 1404607, "timers": {"sample_time_ms": 32761.013, "sample_throughput": 366.472, "load_time_ms": 5.554, "load_throughput": 2161552.064, "learn_time_ms": 31911.272, "learn_throughput": 376.231, "update_time_ms": 20.574}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009081063908524811, "policy_loss": -0.001211402821354568, "vf_loss": 0.002119509968906641, "vf_explained_var": 0.589392900466919, "kl": 0.0006885300972498953, "entropy": 2.5527782440185547, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1404607, "num_agent_steps_sampled": 1404607, "num_steps_trained": 1404607, "num_agent_steps_trained": 1404607}, "done": false, "episodes_total": 702, "training_iteration": 117, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-08-46", "timestamp": 1690834126, "time_this_iter_s": 65.41058921813965, "time_total_s": 7458.25948882103, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7458.25948882103, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.9904255319149, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.202094413457551, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.8089557960763045, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8227786044636837, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": -0.1333237677497039, "reward_component_totals/delta_v_mean": -1.9861771916126245, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.617719161262, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1244.54, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6219590204897552, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.9098010931614366, -4.035475553531553, -3.8653882728045055, -3.7810355932955764, -3.8144177675827926, -4.021547544268896, -3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3383555849344966, "mean_inference_ms": 6.4832262184310165, "mean_action_processing_ms": 0.31623275273831447, "mean_env_wait_ms": 7.194599134832546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1416613, "agent_timesteps_total": 1416613, "timers": {"sample_time_ms": 32875.959, "sample_throughput": 365.191, "load_time_ms": 5.758, "load_throughput": 2085271.89, "learn_time_ms": 31711.873, "learn_throughput": 378.596, "update_time_ms": 21.186}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0002820225490722805, "policy_loss": -0.002787824021652341, "vf_loss": 0.0025058025494217873, "vf_explained_var": 0.4476456046104431, "kl": 0.0016451019328087568, "entropy": 2.6795835494995117, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1416613, "num_agent_steps_sampled": 1416613, "num_steps_trained": 1416613, "num_agent_steps_trained": 1416613}, "done": false, "episodes_total": 708, "training_iteration": 118, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-09-48", "timestamp": 1690834188, "time_this_iter_s": 62.02617597579956, "time_total_s": 7520.285664796829, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7520.285664796829, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.98295454545455, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -3.173562423198897, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7987850526206666, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8113752975749943, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": -0.08327578530656798, "reward_component_totals/delta_v_mean": -1.9874097550456755, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.74097550456707, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1252.6, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6259870064967517, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.787420322065734, -3.923790576503303, -3.9090097098031684, -3.7291031586405037, -3.727239236487318, -3.6283908616285645, -3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337927800070989, "mean_inference_ms": 6.483339103958576, "mean_action_processing_ms": 0.3161847857719746, "mean_env_wait_ms": 7.194154281742036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1428619, "agent_timesteps_total": 1428619, "timers": {"sample_time_ms": 32766.807, "sample_throughput": 366.407, "load_time_ms": 5.97, "load_throughput": 2011103.055, "learn_time_ms": 31494.942, "learn_throughput": 381.204, "update_time_ms": 20.546}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007922562072053552, "policy_loss": -0.0015701426891610026, "vf_loss": 0.002362398896366358, "vf_explained_var": 0.5790665745735168, "kl": 0.0009150996920652688, "entropy": 2.6251814365386963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1428619, "num_agent_steps_sampled": 1428619, "num_steps_trained": 1428619, "num_agent_steps_trained": 1428619}, "done": false, "episodes_total": 714, "training_iteration": 119, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-10-50", "timestamp": 1690834250, "time_this_iter_s": 61.44683837890625, "time_total_s": 7581.7325031757355, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7581.7325031757355, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 99.9909090909091, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.346007603859312, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7797609274512194, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7847310483178157, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 0.7426844548628688, "reward_component_totals/delta_v_mean": -1.9950298791334071, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.50298791334018, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1242.92, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6211494252873563, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.9058154468584436, -3.7650514353541844, -3.6480636802705, -3.8308078880106646, -3.9798877888962774, -3.3608716230636855, -3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3374561933560543, "mean_inference_ms": 6.483297279535237, "mean_action_processing_ms": 0.31615381949497673, "mean_env_wait_ms": 7.193761863768512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1440625, "agent_timesteps_total": 1440625, "timers": {"sample_time_ms": 32771.082, "sample_throughput": 366.36, "load_time_ms": 5.885, "load_throughput": 2040141.548, "learn_time_ms": 31232.384, "learn_throughput": 384.409, "update_time_ms": 21.468}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002482618438079953, "policy_loss": 5.440405948320404e-05, "vf_loss": 0.0024282140657305717, "vf_explained_var": 0.5963702201843262, "kl": 0.0007863459759391844, "entropy": 2.6420774459838867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1440625, "num_agent_steps_sampled": 1440625, "num_steps_trained": 1440625, "num_agent_steps_trained": 1440625}, "done": false, "episodes_total": 720, "training_iteration": 120, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-11-53", "timestamp": 1690834313, "time_this_iter_s": 63.389575719833374, "time_total_s": 7645.122078895569, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7645.122078895569, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.9912087912088, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.765609855159149, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7680019362430021, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -1.9976079189161495, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.76079189161447, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1233.87, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6170912065289316, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.906445571174578, -3.202094413457551, -3.872591850405317, -4.010952994768809, -3.751455208453985, -3.68428077957533, -3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3376113961603795, "mean_inference_ms": 6.482998212071042, "mean_action_processing_ms": 0.3161357665977195, "mean_env_wait_ms": 7.193600764485423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1452506, "agent_timesteps_total": 1452506, "timers": {"sample_time_ms": 32628.052, "sample_throughput": 367.582, "load_time_ms": 5.971, "load_throughput": 2008527.914, "learn_time_ms": 31232.84, "learn_throughput": 384.003, "update_time_ms": 21.73}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0016562442760914564, "policy_loss": -0.0010882962960749865, "vf_loss": 0.0027445408049970865, "vf_explained_var": 0.4176959991455078, "kl": 0.0006008773925714195, "entropy": 2.7247283458709717, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1452506, "num_agent_steps_sampled": 1452506, "num_steps_trained": 1452506, "num_agent_steps_trained": 1452506}, "done": false, "episodes_total": 726, "training_iteration": 121, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-13-05", "timestamp": 1690834385, "time_this_iter_s": 71.57076597213745, "time_total_s": 7716.692844867706, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7716.692844867706, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.98712871287128, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.770766331077766, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.769521425940744, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.001244905137026, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.12449051370209, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1226.14, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1903, "constraint_violation.max_vel_constraint.ratio_mean": 0.6132281380631646, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9510244877561219}, "hist_stats": {"episode_reward": [-3.675761346079736, -3.807283272705993, -3.812221293983029, -3.91691612633487, -3.7579707368319664, -3.675270877917982, -3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3378067403673668, "mean_inference_ms": 6.4828243882063115, "mean_action_processing_ms": 0.3161442101718875, "mean_env_wait_ms": 7.193731217083689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1464512, "agent_timesteps_total": 1464512, "timers": {"sample_time_ms": 32682.595, "sample_throughput": 366.969, "load_time_ms": 5.87, "load_throughput": 2043132.951, "learn_time_ms": 31014.565, "learn_throughput": 386.705, "update_time_ms": 22.759}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012691931333392859, "policy_loss": -0.0010618719970807433, "vf_loss": 0.0023310650140047073, "vf_explained_var": 0.5106509923934937, "kl": 0.0007491330616176128, "entropy": 2.663602828979492, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1464512, "num_agent_steps_sampled": 1464512, "num_steps_trained": 1464512, "num_agent_steps_trained": 1464512}, "done": false, "episodes_total": 732, "training_iteration": 122, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-14-07", "timestamp": 1690834447, "time_this_iter_s": 62.26449799537659, "time_total_s": 7778.957342863083, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7778.957342863083, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.98539325842698, "ram_util_percent": 47.46629213483146}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7734687872846746, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7697334611688875, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.00373532611579, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.37353261157853, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1217.28, "constraint_violation.max_vel_constraint.steps_min": 394, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.6088003519562181, "constraint_violation.max_vel_constraint.ratio_min": 0.1969015492253873, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.568710701354668, -3.925957238907867, -3.8004091963116267, -3.7245378282391464, -3.8752039772739817, -3.8721588139741376, -3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337994030231075, "mean_inference_ms": 6.48263156962401, "mean_action_processing_ms": 0.31615980440905717, "mean_env_wait_ms": 7.193919093522566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1476518, "agent_timesteps_total": 1476518, "timers": {"sample_time_ms": 32544.019, "sample_throughput": 368.532, "load_time_ms": 5.963, "load_throughput": 2011483.451, "learn_time_ms": 31155.231, "learn_throughput": 384.959, "update_time_ms": 22.326}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0008039489039219916, "policy_loss": -0.0027185166254639626, "vf_loss": 0.00191456638276577, "vf_explained_var": 0.7288848161697388, "kl": 0.0021713003516197205, "entropy": 2.5139989852905273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1476518, "num_agent_steps_sampled": 1476518, "num_steps_trained": 1476518, "num_agent_steps_trained": 1476518}, "done": false, "episodes_total": 738, "training_iteration": 123, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-15-11", "timestamp": 1690834511, "time_this_iter_s": 63.768028259277344, "time_total_s": 7842.72537112236, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7842.72537112236, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 99.98901098901099, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7589497547024324, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7538995078254571, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.005050246876978, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.50502468769733, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1226.98, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.613647928168112, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.813649523820753, -3.8931106073135675, -3.925497664525623, -3.6268032217385198, -3.894368682836782, -3.7953192695023974, -3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3382049086302248, "mean_inference_ms": 6.482559923062014, "mean_action_processing_ms": 0.3161738949516872, "mean_env_wait_ms": 7.193999883350276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1488524, "agent_timesteps_total": 1488524, "timers": {"sample_time_ms": 32550.263, "sample_throughput": 368.461, "load_time_ms": 5.962, "load_throughput": 2011756.956, "learn_time_ms": 31161.422, "learn_throughput": 384.883, "update_time_ms": 21.795}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002471132902428508, "policy_loss": 0.00010035844024969265, "vf_loss": 0.0023707770742475986, "vf_explained_var": 0.4829791188240051, "kl": 0.0010761052835732698, "entropy": 2.62473726272583, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1488524, "num_agent_steps_sampled": 1488524, "num_steps_trained": 1488524, "num_agent_steps_trained": 1488524}, "done": false, "episodes_total": 744, "training_iteration": 124, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-16-15", "timestamp": 1690834575, "time_this_iter_s": 63.253576040267944, "time_total_s": 7905.978947162628, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7905.978947162628, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.98777777777778, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.759355148666298, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7517817608646513, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0075733878016506, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.7573387801645, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1224.55, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.6124335353645138, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.9201788699264037, -3.7736882020256766, -3.7519385002094787, -3.7921337163676254, -4.0350897056437125, -3.7853520796312656, -3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3384319776113507, "mean_inference_ms": 6.4823885468462485, "mean_action_processing_ms": 0.3162010204315157, "mean_env_wait_ms": 7.194245505760055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1500530, "agent_timesteps_total": 1500530, "timers": {"sample_time_ms": 32627.594, "sample_throughput": 367.588, "load_time_ms": 6.029, "load_throughput": 1989149.012, "learn_time_ms": 31091.043, "learn_throughput": 385.754, "update_time_ms": 21.943}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0013268382754176855, "policy_loss": -0.0009744546259753406, "vf_loss": 0.0023012924939393997, "vf_explained_var": 0.4032159149646759, "kl": 0.0006461917073465884, "entropy": 2.6695609092712402, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1500530, "num_agent_steps_sampled": 1500530, "num_steps_trained": 1500530, "num_agent_steps_trained": 1500530}, "done": false, "episodes_total": 750, "training_iteration": 125, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-17-17", "timestamp": 1690834637, "time_this_iter_s": 62.15752553939819, "time_total_s": 7968.136472702026, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7968.136472702026, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.98876404494382, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.760553512305295, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7488398070382826, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0117137052670158, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.171370526701, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1195.42, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5978758142250836, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.811953989547117, -3.9248944650686113, -3.8009085164036085, -3.8291402740198563, -3.857943080302502, -3.8462938989806004, -3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3386832666305981, "mean_inference_ms": 6.48223805057465, "mean_action_processing_ms": 0.3162313683581654, "mean_env_wait_ms": 7.194500926149899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1512536, "agent_timesteps_total": 1512536, "timers": {"sample_time_ms": 32746.776, "sample_throughput": 366.25, "load_time_ms": 5.955, "load_throughput": 2014028.307, "learn_time_ms": 31142.921, "learn_throughput": 385.112, "update_time_ms": 22.426}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00016442629566881806, "policy_loss": -0.0021519402507692575, "vf_loss": 0.0023163699079304934, "vf_explained_var": 0.35064345598220825, "kl": 0.00023010715085547417, "entropy": 2.7254481315612793, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1512536, "num_agent_steps_sampled": 1512536, "num_steps_trained": 1512536, "num_agent_steps_trained": 1512536}, "done": false, "episodes_total": 756, "training_iteration": 126, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-18-22", "timestamp": 1690834702, "time_this_iter_s": 64.80257844924927, "time_total_s": 8032.939051151276, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8032.939051151276, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.99032258064514, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7475394085493887, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7339406427122351, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.013598765837157, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.35987658371505, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1198.57, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5994500271186368, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.8014824112801913, -3.8593023382617666, -3.8692760449243746, -3.6659493075074847, -3.7788997370502937, -3.6596158768379534, -3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3382307693701285, "mean_inference_ms": 6.482396222840606, "mean_action_processing_ms": 0.31626133789008837, "mean_env_wait_ms": 7.194590155839126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1524542, "agent_timesteps_total": 1524542, "timers": {"sample_time_ms": 32724.986, "sample_throughput": 366.494, "load_time_ms": 5.919, "load_throughput": 2026270.136, "learn_time_ms": 31060.257, "learn_throughput": 386.137, "update_time_ms": 22.865}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00034367284388281405, "policy_loss": -0.0016272378852590919, "vf_loss": 0.00197090907022357, "vf_explained_var": 0.6676852107048035, "kl": 0.0003437975829001516, "entropy": 2.6184864044189453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1524542, "num_agent_steps_sampled": 1524542, "num_steps_trained": 1524542, "num_agent_steps_trained": 1524542}, "done": false, "episodes_total": 762, "training_iteration": 127, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-19-27", "timestamp": 1690834767, "time_this_iter_s": 64.38661599159241, "time_total_s": 8097.325667142868, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8097.325667142868, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.98804347826086, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7519073091553214, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7332262777851578, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.018681031370167, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.86810313701605, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1195.18, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5977558741950986, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.910693836136721, -3.6086368689317947, -3.6346677306522777, -3.9832493657965156, -3.7531436437745365, -3.797699766340738, -3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3378161784951572, "mean_inference_ms": 6.482630373094741, "mean_action_processing_ms": 0.3162945530744895, "mean_env_wait_ms": 7.194888921319981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1536548, "agent_timesteps_total": 1536548, "timers": {"sample_time_ms": 32829.673, "sample_throughput": 365.325, "load_time_ms": 5.935, "load_throughput": 2020710.884, "learn_time_ms": 31241.875, "learn_throughput": 383.892, "update_time_ms": 23.041}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0014124339213594794, "policy_loss": -0.00039221683982759714, "vf_loss": 0.001804651808924973, "vf_explained_var": 0.7972724437713623, "kl": 0.002026695990934968, "entropy": 2.5085887908935547, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1536548, "num_agent_steps_sampled": 1536548, "num_steps_trained": 1536548, "num_agent_steps_trained": 1536548}, "done": false, "episodes_total": 768, "training_iteration": 128, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-20-32", "timestamp": 1690834832, "time_this_iter_s": 64.94088220596313, "time_total_s": 8162.266549348831, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8162.266549348831, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 99.98586956521739, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.757439726566129, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7361585162126548, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0212812103534774, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.8517670020461128, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.12812103534714, "delta_v_total_min": 185.17670020461063, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1198.92, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.599624939662365, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.7028284053194858, -3.7087282740038585, -3.7735326759988252, -3.8745825877933777, -3.8216459745272213, -3.7422965349432626, -3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3373830644248006, "mean_inference_ms": 6.482913563879226, "mean_action_processing_ms": 0.3163319514734719, "mean_env_wait_ms": 7.195040369150132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1548554, "agent_timesteps_total": 1548554, "timers": {"sample_time_ms": 32892.775, "sample_throughput": 364.624, "load_time_ms": 6.02, "load_throughput": 1992394.904, "learn_time_ms": 31572.019, "learn_throughput": 379.878, "update_time_ms": 23.914}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012409110786393285, "policy_loss": -0.001109255594201386, "vf_loss": 0.002350165043026209, "vf_explained_var": 0.49221059679985046, "kl": 0.00023487153521273285, "entropy": 2.649874687194824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1548554, "num_agent_steps_sampled": 1548554, "num_steps_trained": 1548554, "num_agent_steps_trained": 1548554}, "done": false, "episodes_total": 774, "training_iteration": 129, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-21-37", "timestamp": 1690834897, "time_this_iter_s": 65.37073397636414, "time_total_s": 8227.637283325195, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8227.637283325195, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.98617021276597, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.747325106002328, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7205109520817163, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0268141539206144, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.9424324194093576, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.68141539206084, "delta_v_total_min": 194.24324194093526, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1182.77, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5915539751446239, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.8448972370501107, -3.699467622740988, -3.7573295498132504, -3.7759018578045715, -3.8748659547098248, -3.817241194002245, -3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3369739267374499, "mean_inference_ms": 6.483266585193446, "mean_action_processing_ms": 0.316372806487843, "mean_env_wait_ms": 7.195265039407164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1560560, "agent_timesteps_total": 1560560, "timers": {"sample_time_ms": 32987.082, "sample_throughput": 363.582, "load_time_ms": 6.076, "load_throughput": 1973920.816, "learn_time_ms": 31665.225, "learn_throughput": 378.759, "update_time_ms": 25.906}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.001709575648419559, "policy_loss": -0.0009474721737205982, "vf_loss": 0.002657047938555479, "vf_explained_var": 0.45078516006469727, "kl": 0.00012090337258996442, "entropy": 2.7223079204559326, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1560560, "num_agent_steps_sampled": 1560560, "num_steps_trained": 1560560, "num_agent_steps_trained": 1560560}, "done": false, "episodes_total": 780, "training_iteration": 130, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-22-43", "timestamp": 1690834963, "time_this_iter_s": 65.24773025512695, "time_total_s": 8292.885013580322, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8292.885013580322, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.98709677419355, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.722529299298246, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6928785710988634, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0296507281993867, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.9424324194093576, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.96507281993797, "delta_v_total_min": 194.24324194093526, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1168.52, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5844325358642641, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.9415116938397183, -3.730981205292177, -3.9022366881042747, -3.7986462914084544, -3.8423108656510174, -3.7589205322833275, -3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3371805638697032, "mean_inference_ms": 6.483492412284509, "mean_action_processing_ms": 0.31645875903129256, "mean_env_wait_ms": 7.1957039468646995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1572566, "agent_timesteps_total": 1572566, "timers": {"sample_time_ms": 33134.83, "sample_throughput": 362.338, "load_time_ms": 5.991, "load_throughput": 2003956.187, "learn_time_ms": 31581.46, "learn_throughput": 380.16, "update_time_ms": 25.405}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.003505943575873971, "policy_loss": 0.0008473068010061979, "vf_loss": 0.002658636774867773, "vf_explained_var": 0.42692312598228455, "kl": 6.515632776427083e-06, "entropy": 2.7637343406677246, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1572566, "num_agent_steps_sampled": 1572566, "num_steps_trained": 1572566, "num_agent_steps_trained": 1572566}, "done": false, "episodes_total": 786, "training_iteration": 131, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-23-55", "timestamp": 1690835035, "time_this_iter_s": 72.23311042785645, "time_total_s": 8365.118124008179, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8365.118124008179, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.98737864077671, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.047396668414681, "episode_reward_mean": -3.7201898820390213, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6898523434077605, "reward_component_totals/dist_change_reward_min": -0.9993329969251258, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.030337538631264, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.9424324194093576, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.03375386312575, "delta_v_total_min": 194.24324194093526, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1161.81, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5810792125259332, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.862527452080653, -3.928857824889506, -3.8842805353427536, -3.9282110081243102, -3.9106199368333936, -4.047396668414681, -3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3374203225723493, "mean_inference_ms": 6.483813288642716, "mean_action_processing_ms": 0.31655170669182797, "mean_env_wait_ms": 7.196282051777955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1584572, "agent_timesteps_total": 1584572, "timers": {"sample_time_ms": 33303.365, "sample_throughput": 360.504, "load_time_ms": 6.093, "load_throughput": 1970449.751, "learn_time_ms": 31766.971, "learn_throughput": 377.94, "update_time_ms": 24.629}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0023895956110209227, "policy_loss": 0.00021303148241713643, "vf_loss": 0.0021765646524727345, "vf_explained_var": 0.585459291934967, "kl": 0.0003689337754622102, "entropy": 2.6554195880889893, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1584572, "num_agent_steps_sampled": 1584572, "num_steps_trained": 1584572, "num_agent_steps_trained": 1584572}, "done": false, "episodes_total": 792, "training_iteration": 132, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-25-01", "timestamp": 1690835101, "time_this_iter_s": 65.82940101623535, "time_total_s": 8430.947525024414, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8430.947525024414, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 99.9882978723404, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7100115326419423, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6791586676900523, "reward_component_totals/dist_change_reward_min": -0.9887755614667806, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0308528649518927, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.9424324194093576, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.08528649518857, "delta_v_total_min": 194.24324194093526, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1158.03, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5791901570536693, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.651656024982736, -3.7030784597713606, -3.9795695602373087, -4.018283724670279, -3.8683683955087176, -3.954869409537145, -3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337675476376306, "mean_inference_ms": 6.484074569994863, "mean_action_processing_ms": 0.3166431739774046, "mean_env_wait_ms": 7.196950620639753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1596578, "agent_timesteps_total": 1596578, "timers": {"sample_time_ms": 33362.159, "sample_throughput": 359.869, "load_time_ms": 6.252, "load_throughput": 1920359.302, "learn_time_ms": 31617.134, "learn_throughput": 379.731, "update_time_ms": 26.742}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0020442272070795298, "policy_loss": -0.00018291728338226676, "vf_loss": 0.002227143384516239, "vf_explained_var": 0.6246076822280884, "kl": 0.0006937743746675551, "entropy": 2.6319379806518555, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1596578, "num_agent_steps_sampled": 1596578, "num_steps_trained": 1596578, "num_agent_steps_trained": 1596578}, "done": false, "episodes_total": 798, "training_iteration": 133, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-26-04", "timestamp": 1690835164, "time_this_iter_s": 62.81650400161743, "time_total_s": 8493.764029026031, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8493.764029026031, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.98444444444443, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7082086581731453, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6748480864618824, "reward_component_totals/dist_change_reward_min": -0.9887755614667806, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0333605717112655, "reward_component_totals/delta_v_min": -2.09410314197342, "reward_component_totals/delta_v_max": -1.9582166963815697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.3360571711259, "delta_v_total_min": 195.82166963815735, "delta_v_total_max": 209.41031419734114, "constraint_violation.max_vel_constraint.steps_mean": 1137.01, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5686854094274825, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.2867290677295276, -3.9282532174814118, -3.792093645497027, -3.918638555907272, -3.9051912670619258, -3.759581677940603, -3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337952943645586, "mean_inference_ms": 6.484284829866408, "mean_action_processing_ms": 0.3167319036832444, "mean_env_wait_ms": 7.197769311232339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1608584, "agent_timesteps_total": 1608584, "timers": {"sample_time_ms": 33411.763, "sample_throughput": 359.335, "load_time_ms": 6.233, "load_throughput": 1926125.352, "learn_time_ms": 31473.982, "learn_throughput": 381.458, "update_time_ms": 25.849}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 9.652379230828956e-05, "policy_loss": -0.002001727232709527, "vf_loss": 0.002098252298310399, "vf_explained_var": 0.6192627549171448, "kl": 0.0019569688010960817, "entropy": 2.584111452102661, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1608584, "num_agent_steps_sampled": 1608584, "num_steps_trained": 1608584, "num_agent_steps_trained": 1608584}, "done": false, "episodes_total": 804, "training_iteration": 134, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-27-07", "timestamp": 1690835227, "time_this_iter_s": 62.339242458343506, "time_total_s": 8556.103271484375, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8556.103271484375, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.98876404494382, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.709332605878708, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.675471198759176, "reward_component_totals/dist_change_reward_min": -0.9887755614667806, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.0338614071195362, "reward_component_totals/delta_v_min": -2.091732801645995, "reward_component_totals/delta_v_max": -1.9582166963815697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.38614071195298, "delta_v_total_min": 195.82166963815735, "delta_v_total_max": 209.17328016459894, "constraint_violation.max_vel_constraint.steps_mean": 1118.32, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5593450795923999, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.8234285800255186, -3.98472287744256, -3.173562423198897, -3.764104653411412, -3.944275108690767, -3.804011625020303, -3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3382279433764048, "mean_inference_ms": 6.484373990528976, "mean_action_processing_ms": 0.3168216836254383, "mean_env_wait_ms": 7.198637070382731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1620590, "agent_timesteps_total": 1620590, "timers": {"sample_time_ms": 33470.91, "sample_throughput": 358.7, "load_time_ms": 6.36, "load_throughput": 1887677.359, "learn_time_ms": 31684.466, "learn_throughput": 378.924, "update_time_ms": 24.329}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0032299074809998274, "policy_loss": 0.0005958070396445692, "vf_loss": 0.0026340996846556664, "vf_explained_var": 0.47128865122795105, "kl": 1.986325514735654e-05, "entropy": 2.7449796199798584, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1620590, "num_agent_steps_sampled": 1620590, "num_steps_trained": 1620590, "num_agent_steps_trained": 1620590}, "done": false, "episodes_total": 810, "training_iteration": 135, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-28-11", "timestamp": 1690835291, "time_this_iter_s": 64.8067729473114, "time_total_s": 8620.910044431686, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8620.910044431686, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.99130434782607, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.842673431734041, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7139892440049027, "episode_len_mean": 1999.75, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6807588650587367, "reward_component_totals/dist_change_reward_min": -0.9887755614667806, "reward_component_totals/dist_change_reward_max": 1.1310399128498732, "reward_component_totals/delta_v_mean": -2.033230378946169, "reward_component_totals/delta_v_min": -2.091732801645995, "reward_component_totals/delta_v_max": -1.9582166963815697, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.32303789461622, "delta_v_total_min": 195.82166963815735, "delta_v_total_max": 209.17328016459894, "constraint_violation.max_vel_constraint.steps_mean": 1101.88, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5511291875384269, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.9461909048389905, -3.2241273634607968, -2.346007603859312, -3.537928742313686, -3.6065067281469476, -1.842673431734041, -3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 1876, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3385561929301475, "mean_inference_ms": 6.484590253130153, "mean_action_processing_ms": 0.31690738517173433, "mean_env_wait_ms": 7.199531440370887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1632596, "agent_timesteps_total": 1632596, "timers": {"sample_time_ms": 33613.885, "sample_throughput": 357.174, "load_time_ms": 6.516, "load_throughput": 1842405.59, "learn_time_ms": 31678.779, "learn_throughput": 378.992, "update_time_ms": 26.862}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0008517846581526101, "policy_loss": -0.0012955202255398035, "vf_loss": 0.0021473036613315344, "vf_explained_var": 0.6540123820304871, "kl": 0.0010480070486664772, "entropy": 2.63222599029541, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1632596, "num_agent_steps_sampled": 1632596, "num_steps_trained": 1632596, "num_agent_steps_trained": 1632596}, "done": false, "episodes_total": 816, "training_iteration": 136, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-29-18", "timestamp": 1690835358, "time_this_iter_s": 66.17895555496216, "time_total_s": 8687.088999986649, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8687.088999986649, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 99.98421052631576, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.502954814563698, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7460742954284814, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7134376785746072, "reward_component_totals/dist_change_reward_min": -0.9887755614667806, "reward_component_totals/dist_change_reward_max": 0.5670921522572607, "reward_component_totals/delta_v_mean": -2.032636616853877, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9176646067202097, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.26366168538695, "delta_v_total_min": 191.76646067202117, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1094.35, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1851, "constraint_violation.max_vel_constraint.ratio_mean": 0.5469015492253873, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9250374812593704}, "hist_stats": {"episode_reward": [-3.9751211126998793, -3.930133845589059, -3.799484211917503, -3.9214713031592288, -3.7753687219598024, -4.02026162824528, -3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.33834040819837, "mean_inference_ms": 6.48522282699884, "mean_action_processing_ms": 0.3170004755518244, "mean_env_wait_ms": 7.200479559339243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1644602, "agent_timesteps_total": 1644602, "timers": {"sample_time_ms": 33743.666, "sample_throughput": 355.8, "load_time_ms": 6.567, "load_throughput": 1828132.139, "learn_time_ms": 31723.777, "learn_throughput": 378.454, "update_time_ms": 28.558}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0006936485879123211, "policy_loss": -0.0031133557204157114, "vf_loss": 0.002419705968350172, "vf_explained_var": 0.5382951498031616, "kl": 0.0009158860193565488, "entropy": 2.6636950969696045, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1644602, "num_agent_steps_sampled": 1644602, "num_steps_trained": 1644602, "num_agent_steps_trained": 1644602}, "done": false, "episodes_total": 822, "training_iteration": 137, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-30-24", "timestamp": 1690835424, "time_this_iter_s": 66.18975043296814, "time_total_s": 8753.278750419617, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8753.278750419617, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.98526315789474, "ram_util_percent": 47.52631578947371}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.720478183918973, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6872292715736035, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0332489123453734, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9176646067202097, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.32489123453666, "delta_v_total_min": 191.76646067202117, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1109.94, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5546926536731633, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.7154234573043956, -3.9616660332680325, -3.759469242574202, -3.711279326345687, -3.8534114304494516, -3.955409364667668, -3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3381194435160422, "mean_inference_ms": 6.485973756493654, "mean_action_processing_ms": 0.3170854595899403, "mean_env_wait_ms": 7.201257143460981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1656608, "agent_timesteps_total": 1656608, "timers": {"sample_time_ms": 33717.698, "sample_throughput": 356.074, "load_time_ms": 6.66, "load_throughput": 1802739.142, "learn_time_ms": 31668.35, "learn_throughput": 379.117, "update_time_ms": 30.086}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0004661224957089871, "policy_loss": -0.0026165866293013096, "vf_loss": 0.0021504643373191357, "vf_explained_var": 0.7745928168296814, "kl": 0.0009874519892036915, "entropy": 2.4800097942352295, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1656608, "num_agent_steps_sampled": 1656608, "num_steps_trained": 1656608, "num_agent_steps_trained": 1656608}, "done": false, "episodes_total": 828, "training_iteration": 138, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-31-28", "timestamp": 1690835488, "time_this_iter_s": 64.08530569076538, "time_total_s": 8817.364056110382, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8817.364056110382, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7146856149936633, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6806494876965788, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.034036127297087, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9176646067202097, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.40361272970804, "delta_v_total_min": 191.76646067202117, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1115.08, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5572613693153423, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.901809058600857, -3.5059196619223023, -3.848780270415266, -3.8503394884888626, -3.6847963336218137, -3.962349599295292, -2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.337966718748303, "mean_inference_ms": 6.486670261710498, "mean_action_processing_ms": 0.31716193389891134, "mean_env_wait_ms": 7.202023213392483, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1668614, "agent_timesteps_total": 1668614, "timers": {"sample_time_ms": 33689.109, "sample_throughput": 356.376, "load_time_ms": 6.524, "load_throughput": 1840271.228, "learn_time_ms": 31547.369, "learn_throughput": 380.571, "update_time_ms": 29.508}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002537509659305215, "policy_loss": -1.3072323781671003e-05, "vf_loss": 0.002550579374656081, "vf_explained_var": 0.47461867332458496, "kl": 0.00012005224562017247, "entropy": 2.6747403144836426, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1668614, "num_agent_steps_sampled": 1668614, "num_steps_trained": 1668614, "num_agent_steps_trained": 1668614}, "done": false, "episodes_total": 834, "training_iteration": 139, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-32-33", "timestamp": 1690835553, "time_this_iter_s": 63.93554663658142, "time_total_s": 8881.299602746964, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8881.299602746964, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.98152173913043, "ram_util_percent": 47.60000000000003}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.7131633518769904, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6816593344414785, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.031504017435515, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.1504017435508, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1119.45, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5594452773613193, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-2.9901250092096867, -3.8745737526067314, -3.0551337813948205, -3.748096021708826, -3.9281273568576207, -3.849770764147955, -3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3378545975657323, "mean_inference_ms": 6.487406553291719, "mean_action_processing_ms": 0.31724578864973396, "mean_env_wait_ms": 7.203021857706603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1680620, "agent_timesteps_total": 1680620, "timers": {"sample_time_ms": 33757.577, "sample_throughput": 355.653, "load_time_ms": 6.353, "load_throughput": 1889823.871, "learn_time_ms": 31266.107, "learn_throughput": 383.994, "update_time_ms": 27.557}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0011397352209314704, "policy_loss": -0.0029260667506605387, "vf_loss": 0.0017863308312371373, "vf_explained_var": 0.7515336871147156, "kl": 0.0015766459982842207, "entropy": 2.4028146266937256, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1680620, "num_agent_steps_sampled": 1680620, "num_steps_trained": 1680620, "num_agent_steps_trained": 1680620}, "done": false, "episodes_total": 840, "training_iteration": 140, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-33-36", "timestamp": 1690835616, "time_this_iter_s": 63.10034394264221, "time_total_s": 8944.399946689606, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8944.399946689606, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 99.98764044943822, "ram_util_percent": 47.600000000000016}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.044126183932184, "episode_reward_mean": -3.713318328312485, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6798798812965039, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.033438447015985, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.34384470159776, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1107.18, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5533133433283358, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.8402104131631605, -3.6529592074941357, -3.8602054733065545, -3.858015151154867, -3.8691177143895192, -3.7192767500045325, -3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3382302039384746, "mean_inference_ms": 6.487890117256867, "mean_action_processing_ms": 0.31733987102832456, "mean_env_wait_ms": 7.204285700883697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1692626, "agent_timesteps_total": 1692626, "timers": {"sample_time_ms": 33691.075, "sample_throughput": 356.356, "load_time_ms": 6.589, "load_throughput": 1822000.486, "learn_time_ms": 31306.232, "learn_throughput": 383.502, "update_time_ms": 27.877}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0029334393329918385, "policy_loss": 0.0002311675634700805, "vf_loss": 0.0027022745925933123, "vf_explained_var": 0.3843073546886444, "kl": 2.786192635539919e-05, "entropy": 2.735341787338257, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1692626, "num_agent_steps_sampled": 1692626, "num_steps_trained": 1692626, "num_agent_steps_trained": 1692626}, "done": false, "episodes_total": 846, "training_iteration": 141, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-34-48", "timestamp": 1690835688, "time_this_iter_s": 72.02899074554443, "time_total_s": 9016.42893743515, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9016.42893743515, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.98543689320388, "ram_util_percent": 47.60000000000004}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.7124912742463336, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6789567831225775, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0335344911237594, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.3534491123753, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1115.09, "constraint_violation.max_vel_constraint.steps_min": 329, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5572663668165917, "constraint_violation.max_vel_constraint.ratio_min": 0.16441779110444776, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.9413349964034077, -4.022136976321939, -3.8135461512374667, -3.812804849346924, -3.91190349685486, -2.502954814563698, -3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3386522309277746, "mean_inference_ms": 6.488275934155895, "mean_action_processing_ms": 0.31744264277367273, "mean_env_wait_ms": 7.205760627832529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1704632, "agent_timesteps_total": 1704632, "timers": {"sample_time_ms": 33635.015, "sample_throughput": 356.949, "load_time_ms": 6.591, "load_throughput": 1821631.39, "learn_time_ms": 31029.832, "learn_throughput": 386.918, "update_time_ms": 27.205}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009804375004023314, "policy_loss": -0.0014817228075116873, "vf_loss": 0.0024621605407446623, "vf_explained_var": 0.41432103514671326, "kl": 9.274110925616696e-05, "entropy": 2.713273763656616, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1704632, "num_agent_steps_sampled": 1704632, "num_steps_trained": 1704632, "num_agent_steps_trained": 1704632}, "done": false, "episodes_total": 852, "training_iteration": 142, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-35-51", "timestamp": 1690835751, "time_this_iter_s": 62.47634530067444, "time_total_s": 9078.905282735825, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9078.905282735825, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.98555555555556, "ram_util_percent": 47.60000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.710064873479395, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6778454313641675, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.032219442115231, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.2219442115224, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1111.58, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.555512243878061, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.8771530147571704, -3.874355361471965, -3.9065193536674157, -3.696837807416548, -3.725584876896526, -3.941355420897755, -3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3391397514439964, "mean_inference_ms": 6.488726852847505, "mean_action_processing_ms": 0.31754608830203124, "mean_env_wait_ms": 7.207402524011837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1716638, "agent_timesteps_total": 1716638, "timers": {"sample_time_ms": 33774.758, "sample_throughput": 355.473, "load_time_ms": 6.469, "load_throughput": 1855925.029, "learn_time_ms": 31088.283, "learn_throughput": 386.191, "update_time_ms": 25.548}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0005699020111933351, "policy_loss": -0.002909426810219884, "vf_loss": 0.0023395265452563763, "vf_explained_var": 0.4337654411792755, "kl": 0.00024409654724877328, "entropy": 2.7105541229248047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1716638, "num_agent_steps_sampled": 1716638, "num_steps_trained": 1716638, "num_agent_steps_trained": 1716638}, "done": false, "episodes_total": 858, "training_iteration": 143, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-36-56", "timestamp": 1690835816, "time_this_iter_s": 64.83901953697205, "time_total_s": 9143.744302272797, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9143.744302272797, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.98586956521739, "ram_util_percent": 47.60434782608698}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.7065722471753144, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6737657822494092, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.032806464925909, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.2806464925902, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1103.84, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5516441779110445, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.866107890511299, -3.8305433150502965, -3.842673990447042, -3.865050282652396, -3.8375627933789396, -3.9972127097297, -3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3397022201821644, "mean_inference_ms": 6.489042096706303, "mean_action_processing_ms": 0.31766502249986983, "mean_env_wait_ms": 7.2094225221774435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1728644, "agent_timesteps_total": 1728644, "timers": {"sample_time_ms": 33871.559, "sample_throughput": 354.457, "load_time_ms": 6.655, "load_throughput": 1804056.655, "learn_time_ms": 31311.43, "learn_throughput": 383.438, "update_time_ms": 25.304}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0005290380795486271, "policy_loss": -0.0013488947879523039, "vf_loss": 0.0018779346719384193, "vf_explained_var": 0.7947382926940918, "kl": 0.0003933552070520818, "entropy": 2.547579050064087, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1728644, "num_agent_steps_sampled": 1728644, "num_steps_trained": 1728644, "num_agent_steps_trained": 1728644}, "done": false, "episodes_total": 864, "training_iteration": 144, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-38-01", "timestamp": 1690835881, "time_this_iter_s": 65.53290891647339, "time_total_s": 9209.27721118927, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9209.27721118927, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 99.98404255319149, "ram_util_percent": 47.64574468085105}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.698652377036264, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6643338902528577, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0343184867834085, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.4318486783402, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1084.32, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.541889055472264, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.940322579993812, -3.906678232901129, -3.5779976907743003, -3.9815589459354896, -3.956810520810393, -2.547502348390127, -3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3403169571153657, "mean_inference_ms": 6.489486138719453, "mean_action_processing_ms": 0.31777195095891836, "mean_env_wait_ms": 7.211475947743781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1740650, "agent_timesteps_total": 1740650, "timers": {"sample_time_ms": 33842.666, "sample_throughput": 354.759, "load_time_ms": 6.358, "load_throughput": 1888300.266, "learn_time_ms": 31271.736, "learn_throughput": 383.925, "update_time_ms": 26.02}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0033430943731218576, "policy_loss": 0.0007194076315499842, "vf_loss": 0.002623685635626316, "vf_explained_var": 0.47798940539360046, "kl": 9.06482819118537e-06, "entropy": 2.7317469120025635, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1740650, "num_agent_steps_sampled": 1740650, "num_steps_trained": 1740650, "num_agent_steps_trained": 1740650}, "done": false, "episodes_total": 870, "training_iteration": 145, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-39-06", "timestamp": 1690835946, "time_this_iter_s": 64.13987612724304, "time_total_s": 9273.417087316513, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9273.417087316513, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 99.9836956521739, "ram_util_percent": 47.515217391304354}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.7102060021984475, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6770414331230411, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0331645690754097, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.31645690754027, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1088.85, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5441529235382309, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-3.728484680088842, -3.788087191331412, -3.755193440484898, -3.836074215100203, -3.8098766157314614, -3.400951912542325, -2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3409352973216553, "mean_inference_ms": 6.490059813298017, "mean_action_processing_ms": 0.3178835122868556, "mean_env_wait_ms": 7.213596439488839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1752656, "agent_timesteps_total": 1752656, "timers": {"sample_time_ms": 33740.848, "sample_throughput": 355.83, "load_time_ms": 6.219, "load_throughput": 1930622.54, "learn_time_ms": 31136.873, "learn_throughput": 385.588, "update_time_ms": 23.017}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002167578088119626, "policy_loss": -0.00025106233078986406, "vf_loss": 0.0024186403024941683, "vf_explained_var": 0.5763407945632935, "kl": 0.00045555102406069636, "entropy": 2.6745080947875977, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1752656, "num_agent_steps_sampled": 1752656, "num_steps_trained": 1752656, "num_agent_steps_trained": 1752656}, "done": false, "episodes_total": 876, "training_iteration": 146, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-40-10", "timestamp": 1690836010, "time_this_iter_s": 63.85172128677368, "time_total_s": 9337.268808603287, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9337.268808603287, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.97802197802197, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.698730271157142, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6652989667842937, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0334313043728507, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.34313043728434, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1100.26, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1854, "constraint_violation.max_vel_constraint.ratio_mean": 0.5498550724637681, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9265367316341829}, "hist_stats": {"episode_reward": [-2.776954707364794, -3.938091480515106, -3.674233293062069, -2.690014736497161, -3.8311466520849855, -3.929483487814169, -3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3410002343028913, "mean_inference_ms": 6.490829756164849, "mean_action_processing_ms": 0.31795416376044866, "mean_env_wait_ms": 7.215840040275465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1764662, "agent_timesteps_total": 1764662, "timers": {"sample_time_ms": 33759.491, "sample_throughput": 355.633, "load_time_ms": 6.444, "load_throughput": 1863024.752, "learn_time_ms": 30830.844, "learn_throughput": 389.415, "update_time_ms": 22.815}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0028011868707835674, "policy_loss": 4.1971445170929655e-05, "vf_loss": 0.002759218215942383, "vf_explained_var": 0.46129316091537476, "kl": 2.4199445761041716e-05, "entropy": 2.725252389907837, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1764662, "num_agent_steps_sampled": 1764662, "num_steps_trained": 1764662, "num_agent_steps_trained": 1764662}, "done": false, "episodes_total": 882, "training_iteration": 147, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-41-13", "timestamp": 1690836073, "time_this_iter_s": 63.2730610370636, "time_total_s": 9400.54186964035, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9400.54186964035, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.97777777777777, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.71485690359321, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6836356999858889, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0312212036073243, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.1221203607318, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1132.33, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1919, "constraint_violation.max_vel_constraint.ratio_mean": 0.5658820589705147, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9590204897551224}, "hist_stats": {"episode_reward": [-3.7109432231324027, -3.6256728423106783, -3.889617657842983, -3.753801687471226, -3.8400786006823475, -3.869804797351652, -4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.341108438149083, "mean_inference_ms": 6.491642357594779, "mean_action_processing_ms": 0.31801912000348637, "mean_env_wait_ms": 7.218013795216552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1776668, "agent_timesteps_total": 1776668, "timers": {"sample_time_ms": 33650.321, "sample_throughput": 356.787, "load_time_ms": 6.35, "load_throughput": 1890838.609, "learn_time_ms": 30745.222, "learn_throughput": 390.5, "update_time_ms": 21.323}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0006330647738650441, "policy_loss": -0.0021885100286453962, "vf_loss": 0.0015554442070424557, "vf_explained_var": 0.9452465176582336, "kl": 0.0014330141711980104, "entropy": 2.2260782718658447, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1776668, "num_agent_steps_sampled": 1776668, "num_steps_trained": 1776668, "num_agent_steps_trained": 1776668}, "done": false, "episodes_total": 888, "training_iteration": 148, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-42-15", "timestamp": 1690836135, "time_this_iter_s": 62.18059158325195, "time_total_s": 9462.722461223602, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9462.722461223602, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.97865168539325, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.7086998826759245, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.675894911813457, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0328049708624714, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.2804970862465, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1131.64, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5655372313843078, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-4.044126183932184, -3.198433990948363, -3.919924059713474, -3.6716908533493053, -4.014111843368053, -3.759418911912462, -3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3412438965108076, "mean_inference_ms": 6.492502980797575, "mean_action_processing_ms": 0.3180795299999207, "mean_env_wait_ms": 7.220196038565759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1788674, "agent_timesteps_total": 1788674, "timers": {"sample_time_ms": 33772.348, "sample_throughput": 355.498, "load_time_ms": 6.857, "load_throughput": 1750907.978, "learn_time_ms": 30648.008, "learn_throughput": 391.738, "update_time_ms": 22.064}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.003644599812105298, "policy_loss": 0.0012124980567023158, "vf_loss": 0.002432103967294097, "vf_explained_var": 0.813701331615448, "kl": 0.0004788534715771675, "entropy": 2.498016119003296, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1788674, "num_agent_steps_sampled": 1788674, "num_steps_trained": 1788674, "num_agent_steps_trained": 1788674}, "done": false, "episodes_total": 894, "training_iteration": 149, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-43-20", "timestamp": 1690836200, "time_this_iter_s": 64.11348390579224, "time_total_s": 9526.835945129395, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9526.835945129395, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 99.98681318681318, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.6871243573534414, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6536792873211623, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.033445070032282, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.34450700322756, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1128.89, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5641629185407296, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.699750444253984, -3.9408988985898556, -3.8437416996863907, -3.73761633001713, -3.881280746302596, -3.9981756401777306, -3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.341417510307248, "mean_inference_ms": 6.493383849897696, "mean_action_processing_ms": 0.3181482774790172, "mean_env_wait_ms": 7.222439374941038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1800680, "agent_timesteps_total": 1800680, "timers": {"sample_time_ms": 33699.761, "sample_throughput": 356.264, "load_time_ms": 7.022, "load_throughput": 1709839.118, "learn_time_ms": 30889.051, "learn_throughput": 388.681, "update_time_ms": 21.783}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0026958039961755276, "policy_loss": -0.0002815370971802622, "vf_loss": 0.0029773428104817867, "vf_explained_var": 0.4306965172290802, "kl": 2.3518998659710633e-06, "entropy": 2.734909772872925, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1800680, "num_agent_steps_sampled": 1800680, "num_steps_trained": 1800680, "num_agent_steps_trained": 1800680}, "done": false, "episodes_total": 900, "training_iteration": 150, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-44-25", "timestamp": 1690836265, "time_this_iter_s": 64.82413291931152, "time_total_s": 9591.660078048706, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9591.660078048706, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.98494623655913, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.6744543910526075, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6403761714312259, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0340782196213834, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.9131066182752472, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.40782196213775, "delta_v_total_min": 191.31066182752483, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1140.92, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5701749125437281, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.9636419667019216, -3.2651938432381447, -3.821618728094335, -3.772971277659401, -3.79138133303854, -3.738091485716984, -3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3420579038463902, "mean_inference_ms": 6.4940645084662325, "mean_action_processing_ms": 0.3182167689657908, "mean_env_wait_ms": 7.224610860270349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1812686, "agent_timesteps_total": 1812686, "timers": {"sample_time_ms": 33639.615, "sample_throughput": 356.901, "load_time_ms": 6.881, "load_throughput": 1744829.069, "learn_time_ms": 30813.381, "learn_throughput": 389.636, "update_time_ms": 22.8}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00036373556940816343, "policy_loss": -0.001964321592822671, "vf_loss": 0.002328057074919343, "vf_explained_var": 0.6774942278862, "kl": 0.0020328203681856394, "entropy": 2.588831901550293, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1812686, "num_agent_steps_sampled": 1812686, "num_steps_trained": 1812686, "num_agent_steps_trained": 1812686}, "done": false, "episodes_total": 906, "training_iteration": 151, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-45-36", "timestamp": 1690836336, "time_this_iter_s": 70.6271185874939, "time_total_s": 9662.2871966362, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9662.2871966362, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.98415841584158, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.67595718965344, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6453111070852706, "reward_component_totals/dist_change_reward_min": -0.9838332692600236, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.030646082568172, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.8954584428171346, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 203.06460825681665, "delta_v_total_min": 189.54584428171339, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1152.67, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5760469765117441, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.7984328713702817, -3.7496520176993062, -3.8493664280056192, -4.032844944578102, -3.7389415673490722, -3.2261043523279125, -3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3427010148066298, "mean_inference_ms": 6.49469619393756, "mean_action_processing_ms": 0.3182766720695436, "mean_env_wait_ms": 7.226709495349274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1824692, "agent_timesteps_total": 1824692, "timers": {"sample_time_ms": 33498.753, "sample_throughput": 358.401, "load_time_ms": 6.747, "load_throughput": 1779568.785, "learn_time_ms": 30983.589, "learn_throughput": 387.495, "update_time_ms": 21.978}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.001253845519386232, "policy_loss": -0.0009517839644104242, "vf_loss": 0.0022056305315345526, "vf_explained_var": 0.5187197327613831, "kl": 0.0003538396558724344, "entropy": 2.5848500728607178, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1824692, "num_agent_steps_sampled": 1824692, "num_steps_trained": 1824692, "num_agent_steps_trained": 1824692}, "done": false, "episodes_total": 912, "training_iteration": 152, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-46-38", "timestamp": 1690836398, "time_this_iter_s": 62.739418506622314, "time_total_s": 9725.026615142822, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9725.026615142822, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.98666666666666, "ram_util_percent": 47.49555555555555}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3130235039135325, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.6784011294156405, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.64844415907662, "reward_component_totals/dist_change_reward_min": -0.9942843360534951, "reward_component_totals/dist_change_reward_max": 0.7630333275158736, "reward_component_totals/delta_v_mean": -2.0299569703390237, "reward_component_totals/delta_v_min": -2.0975132437547104, "reward_component_totals/delta_v_max": -1.8954584428171346, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.99569703390173, "delta_v_total_min": 189.54584428171339, "delta_v_total_max": 209.75132437547006, "constraint_violation.max_vel_constraint.steps_mean": 1154.88, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.577151424287856, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.884347762818431, -3.3142207707890936, -3.8251140254618865, -3.7232114379651944, -3.437546142448987, -2.3130235039135325, -3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3433343203355417, "mean_inference_ms": 6.495306575994265, "mean_action_processing_ms": 0.31834152929194554, "mean_env_wait_ms": 7.228804264410826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1836698, "agent_timesteps_total": 1836698, "timers": {"sample_time_ms": 33437.528, "sample_throughput": 359.058, "load_time_ms": 6.823, "load_throughput": 1759583.412, "learn_time_ms": 30982.315, "learn_throughput": 387.511, "update_time_ms": 21.937}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0016662526177242398, "policy_loss": -0.000684975297190249, "vf_loss": 0.002351228380575776, "vf_explained_var": 0.463925302028656, "kl": 0.0003806885506492108, "entropy": 2.6353533267974854, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1836698, "num_agent_steps_sampled": 1836698, "num_steps_trained": 1836698, "num_agent_steps_trained": 1836698}, "done": false, "episodes_total": 918, "training_iteration": 153, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-47-43", "timestamp": 1690836463, "time_this_iter_s": 64.20203280448914, "time_total_s": 9789.228647947311, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9789.228647947311, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 99.98901098901099, "ram_util_percent": 47.494505494505496}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3520923742365345, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.7030362063868227, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6768834050614015, "reward_component_totals/dist_change_reward_min": -0.9954337181918087, "reward_component_totals/dist_change_reward_max": 0.7344426448433086, "reward_component_totals/delta_v_mean": -2.0261528013254235, "reward_component_totals/delta_v_min": -2.096625119398041, "reward_component_totals/delta_v_max": -1.8954584428171346, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.61528013254178, "delta_v_total_min": 189.54584428171339, "delta_v_total_max": 209.66251193980352, "constraint_violation.max_vel_constraint.steps_mean": 1158.43, "constraint_violation.max_vel_constraint.steps_min": 357, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5789255372313842, "constraint_violation.max_vel_constraint.ratio_min": 0.17841079460269865, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.824476271823679, -3.587497867174161, -3.7018748414037317, -3.9978110458559684, -3.4326220987793112, -3.7959653669282014, -3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3439592700049845, "mean_inference_ms": 6.495820523060584, "mean_action_processing_ms": 0.31840017907145224, "mean_env_wait_ms": 7.230883213927875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1848704, "agent_timesteps_total": 1848704, "timers": {"sample_time_ms": 33461.996, "sample_throughput": 358.795, "load_time_ms": 6.666, "load_throughput": 1801004.772, "learn_time_ms": 30858.538, "learn_throughput": 389.066, "update_time_ms": 23.0}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0009727329597808421, "policy_loss": -0.0028701077681034803, "vf_loss": 0.0018973728874698281, "vf_explained_var": 0.7213531732559204, "kl": 0.002464077901095152, "entropy": 2.4243221282958984, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1848704, "num_agent_steps_sampled": 1848704, "num_steps_trained": 1848704, "num_agent_steps_trained": 1848704}, "done": false, "episodes_total": 924, "training_iteration": 154, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-48-48", "timestamp": 1690836528, "time_this_iter_s": 64.50005054473877, "time_total_s": 9853.72869849205, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9853.72869849205, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.98709677419355, "ram_util_percent": 47.50107526881721}, "trial_id": "80031_00000"}
{"episode_reward_max": -2.3520923742365345, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.697464976677436, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6718828029251478, "reward_component_totals/dist_change_reward_min": -0.9954337181918087, "reward_component_totals/dist_change_reward_max": 0.7344426448433086, "reward_component_totals/delta_v_mean": -2.025582173752291, "reward_component_totals/delta_v_min": -2.096625119398041, "reward_component_totals/delta_v_max": -1.8954584428171346, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.55821737522857, "delta_v_total_min": 189.54584428171339, "delta_v_total_max": 209.66251193980352, "constraint_violation.max_vel_constraint.steps_mean": 1143.03, "constraint_violation.max_vel_constraint.steps_min": 357, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5712293853073462, "constraint_violation.max_vel_constraint.ratio_min": 0.17841079460269865, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.5405862797272056, -3.8899898479268487, -3.7444650195379316, -3.9737733491788685, -3.730896847198432, -3.695214404521925, -3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3445507985219018, "mean_inference_ms": 6.49645583773907, "mean_action_processing_ms": 0.3184573991779311, "mean_env_wait_ms": 7.232852585231274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1860710, "agent_timesteps_total": 1860710, "timers": {"sample_time_ms": 33528.965, "sample_throughput": 358.078, "load_time_ms": 6.482, "load_throughput": 1852340.911, "learn_time_ms": 30904.32, "learn_throughput": 388.489, "update_time_ms": 25.259}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0006840938003733754, "policy_loss": -0.001651326660066843, "vf_loss": 0.0023354191798716784, "vf_explained_var": 0.4814884662628174, "kl": 0.0003690093581099063, "entropy": 2.614471673965454, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1860710, "num_agent_steps_sampled": 1860710, "num_steps_trained": 1860710, "num_agent_steps_trained": 1860710}, "done": false, "episodes_total": 930, "training_iteration": 155, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-49-53", "timestamp": 1690836593, "time_this_iter_s": 65.3074939250946, "time_total_s": 9919.036192417145, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9919.036192417145, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.98602150537633, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.6648585637851148, "episode_len_mean": 1987.83, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6551757485706194, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -2.009682815214498, "reward_component_totals/delta_v_min": -2.094349938382706, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.96828152144928, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 209.43499383826997, "constraint_violation.max_vel_constraint.steps_mean": 1133.25, "constraint_violation.max_vel_constraint.steps_min": 357, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5699694670208756, "constraint_violation.max_vel_constraint.ratio_min": 0.17841079460269865, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.7326923981850957, -3.8713017308989985, -3.7941128515503912, -3.77754986832225, -2.3520923742365345, -3.5120632956952162, -3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3451483256911656, "mean_inference_ms": 6.496980085106186, "mean_action_processing_ms": 0.31851413579096394, "mean_env_wait_ms": 7.234788644210807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1871399, "agent_timesteps_total": 1871399, "timers": {"sample_time_ms": 33459.223, "sample_throughput": 354.889, "load_time_ms": 6.372, "load_throughput": 1863387.097, "learn_time_ms": 30520.748, "learn_throughput": 389.057, "update_time_ms": 24.733}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002354316646233201, "policy_loss": -0.0003677208151202649, "vf_loss": 0.0027220339979976416, "vf_explained_var": 0.4353644549846649, "kl": 0.0002522968570701778, "entropy": 2.644195556640625, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1871399, "num_agent_steps_sampled": 1871399, "num_steps_trained": 1871399, "num_agent_steps_trained": 1871399}, "done": false, "episodes_total": 936, "training_iteration": 156, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-50-52", "timestamp": 1690836652, "time_this_iter_s": 59.23953342437744, "time_total_s": 9978.275725841522, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9978.275725841522, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.052427219175721, "episode_reward_mean": -3.678464865308169, "episode_len_mean": 1987.83, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6718146262523176, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -2.006650239055855, "reward_component_totals/delta_v_min": -2.0931732409199113, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.66502390558492, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 209.31732409199032, "constraint_violation.max_vel_constraint.steps_mean": 1142.18, "constraint_violation.max_vel_constraint.steps_min": 357, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5744322356365676, "constraint_violation.max_vel_constraint.ratio_min": 0.17841079460269865, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.895802347880856, -3.8184413178798753, -3.9232516834903013, -3.959673310292385, -4.052427219175721, -3.299374890232829, -3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3452786382357176, "mean_inference_ms": 6.4975586464472, "mean_action_processing_ms": 0.318555265781093, "mean_env_wait_ms": 7.23638634172774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1883405, "agent_timesteps_total": 1883405, "timers": {"sample_time_ms": 33249.662, "sample_throughput": 357.125, "load_time_ms": 6.064, "load_throughput": 1958244.499, "learn_time_ms": 30525.229, "learn_throughput": 389.0, "update_time_ms": 24.552}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012210573768243194, "policy_loss": -0.0006850018980912864, "vf_loss": 0.0019060608465224504, "vf_explained_var": 0.7740167379379272, "kl": 0.001390222692862153, "entropy": 2.297943353652954, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1883405, "num_agent_steps_sampled": 1883405, "num_steps_trained": 1883405, "num_agent_steps_trained": 1883405}, "done": false, "episodes_total": 942, "training_iteration": 157, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-51-54", "timestamp": 1690836714, "time_this_iter_s": 61.20510482788086, "time_total_s": 10039.480830669403, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10039.480830669403, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 99.98275862068965, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.039096844808166, "episode_reward_mean": -3.6616497838160553, "episode_len_mean": 1987.83, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6566895747921022, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -2.0049602090239556, "reward_component_totals/delta_v_min": -2.098583954026301, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.49602090239503, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 209.8583954026296, "constraint_violation.max_vel_constraint.steps_mean": 1136.79, "constraint_violation.max_vel_constraint.steps_min": 357, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5717385824631545, "constraint_violation.max_vel_constraint.ratio_min": 0.17841079460269865, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.9877219841592937, -3.9586251916964086, -3.648542502592223, -3.77038751504115, -3.141101296930718, -3.8194115416490515, -3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.345396854152136, "mean_inference_ms": 6.498201644846099, "mean_action_processing_ms": 0.3185899647712355, "mean_env_wait_ms": 7.237844833807039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1895411, "agent_timesteps_total": 1895411, "timers": {"sample_time_ms": 33293.411, "sample_throughput": 356.656, "load_time_ms": 5.941, "load_throughput": 1998821.041, "learn_time_ms": 30554.999, "learn_throughput": 388.621, "update_time_ms": 23.762}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007233507349155843, "policy_loss": -0.0017136659007519484, "vf_loss": 0.0024370152968913317, "vf_explained_var": 0.3808194696903229, "kl": 0.00012156048614997417, "entropy": 2.641338586807251, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1895411, "num_agent_steps_sampled": 1895411, "num_steps_trained": 1895411, "num_agent_steps_trained": 1895411}, "done": false, "episodes_total": 948, "training_iteration": 158, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-52-57", "timestamp": 1690836777, "time_this_iter_s": 62.90160346031189, "time_total_s": 10102.382434129715, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10102.382434129715, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.9888888888889, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.039096844808166, "episode_reward_mean": -3.631482711269064, "episode_len_mean": 1987.83, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.625565052208903, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -2.005917659060163, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.59176590601578, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1147.75, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5772158438324696, "constraint_violation.max_vel_constraint.ratio_min": 0.27436281859070466, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.8265682704712116, -3.2386190493582263, -3.878118600582894, -3.8582224490423784, -3.8715967378019855, -3.8377380781467307, -3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.345498081708521, "mean_inference_ms": 6.498918505821443, "mean_action_processing_ms": 0.3186168772772707, "mean_env_wait_ms": 7.239247420301812, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1907417, "agent_timesteps_total": 1907417, "timers": {"sample_time_ms": 33305.327, "sample_throughput": 356.529, "load_time_ms": 5.478, "load_throughput": 2167520.715, "learn_time_ms": 30709.904, "learn_throughput": 386.66, "update_time_ms": 23.235}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0009309620363637805, "policy_loss": -0.0018062801100313663, "vf_loss": 0.002737242029979825, "vf_explained_var": 0.43390434980392456, "kl": 0.0004010679549537599, "entropy": 2.685978651046753, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1907417, "num_agent_steps_sampled": 1907417, "num_steps_trained": 1907417, "num_agent_steps_trained": 1907417}, "done": false, "episodes_total": 954, "training_iteration": 159, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-54-03", "timestamp": 1690836843, "time_this_iter_s": 65.90342259407043, "time_total_s": 10168.285856723785, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10168.285856723785, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.98936170212765, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.039096844808166, "episode_reward_mean": -3.628310568386472, "episode_len_mean": 1987.83, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.01, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.6234750061399309, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -2.0048355622465435, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.4835562246539, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1154.16, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5804192421333193, "constraint_violation.max_vel_constraint.ratio_min": 0.27436281859070466, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.8476035896961402, -3.869608429931767, -3.4787660240473075, -3.7672303450753617, -3.8795715828793678, -3.7487577681035877, -3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.345550860335183, "mean_inference_ms": 6.4994707715025495, "mean_action_processing_ms": 0.318643449053081, "mean_env_wait_ms": 7.240539797011633, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1919423, "agent_timesteps_total": 1919423, "timers": {"sample_time_ms": 33262.759, "sample_throughput": 356.985, "load_time_ms": 5.391, "load_throughput": 2202497.888, "learn_time_ms": 30641.505, "learn_throughput": 387.523, "update_time_ms": 23.093}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0027913248632103205, "policy_loss": 0.00045799920917488635, "vf_loss": 0.002333325333893299, "vf_explained_var": 0.36534082889556885, "kl": 0.00020770973060280085, "entropy": 2.6585211753845215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1919423, "num_agent_steps_sampled": 1919423, "num_steps_trained": 1919423, "num_agent_steps_trained": 1919423}, "done": false, "episodes_total": 960, "training_iteration": 160, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-55-07", "timestamp": 1690836907, "time_this_iter_s": 63.692326068878174, "time_total_s": 10231.978182792664, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10231.978182792664, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.039096844808166, "episode_reward_mean": -3.585445156897484, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5887670651871746, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.996678091710312, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.66780917103074, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1158.77, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5850542148255445, "constraint_violation.max_vel_constraint.ratio_min": 0.27436281859070466, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.1884587225380026, -3.8328427158135616, -3.886272694890515, -3.9112604836395106, -3.8953506251520533, -3.7877427167321027, -3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3458795143538325, "mean_inference_ms": 6.499838666847784, "mean_action_processing_ms": 0.31866651822441733, "mean_env_wait_ms": 7.24173681164819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1930548, "agent_timesteps_total": 1930548, "timers": {"sample_time_ms": 32428.39, "sample_throughput": 363.453, "load_time_ms": 5.459, "load_throughput": 2159031.21, "learn_time_ms": 30346.484, "learn_throughput": 388.388, "update_time_ms": 22.203}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012211314169690013, "policy_loss": -0.0012740406673401594, "vf_loss": 0.002495170570909977, "vf_explained_var": 0.8040953278541565, "kl": 0.0005311013665050268, "entropy": 2.509329080581665, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1930548, "num_agent_steps_sampled": 1930548, "num_steps_trained": 1930548, "num_agent_steps_trained": 1930548}, "done": false, "episodes_total": 966, "training_iteration": 161, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-56-06", "timestamp": 1690836966, "time_this_iter_s": 59.37496304512024, "time_total_s": 10291.353145837784, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10291.353145837784, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.98588235294116, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.039096844808166, "episode_reward_mean": -3.57581421975022, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5799970559087929, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.9958171638414293, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.5817163841424, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1160.1, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5857188824917116, "constraint_violation.max_vel_constraint.ratio_min": 0.27436281859070466, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.802541566071961, -3.7517470612120807, -4.039096844808166, -3.789754021047271, -3.7985702479093195, -3.930174882870313, -3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.346181741233592, "mean_inference_ms": 6.50011886588248, "mean_action_processing_ms": 0.3186904905656127, "mean_env_wait_ms": 7.242808538865952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1942554, "agent_timesteps_total": 1942554, "timers": {"sample_time_ms": 32427.443, "sample_throughput": 363.464, "load_time_ms": 5.343, "load_throughput": 2205970.022, "learn_time_ms": 30303.534, "learn_throughput": 388.938, "update_time_ms": 23.032}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0021885735914111137, "policy_loss": -0.00025236126384697855, "vf_loss": 0.002440936164930463, "vf_explained_var": 0.5854790210723877, "kl": 0.0001291874796152115, "entropy": 2.5985825061798096, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1942554, "num_agent_steps_sampled": 1942554, "num_steps_trained": 1942554, "num_agent_steps_trained": 1942554}, "done": false, "episodes_total": 972, "training_iteration": 162, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-57-09", "timestamp": 1690837029, "time_this_iter_s": 62.322964906692505, "time_total_s": 10353.676110744476, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10353.676110744476, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 99.97977528089888, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.016334174368666, "episode_reward_mean": -3.56840155939587, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5714874319888947, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.9969141274069782, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.69141274069727, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1135.71, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5735299769444852, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.7453505779470624, -2.4774663691200174, -3.905530423978553, -3.3140024493232487, -3.942052618045828, -3.7358924277624137, -3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3465062369060647, "mean_inference_ms": 6.500363180867895, "mean_action_processing_ms": 0.3187159784623216, "mean_env_wait_ms": 7.2439698887252435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1954560, "agent_timesteps_total": 1954560, "timers": {"sample_time_ms": 32598.875, "sample_throughput": 361.552, "load_time_ms": 5.094, "load_throughput": 2313599.216, "learn_time_ms": 30313.291, "learn_throughput": 388.813, "update_time_ms": 22.574}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0030828402377665043, "policy_loss": 0.00047870221897028387, "vf_loss": 0.002604136476293206, "vf_explained_var": 0.3404039442539215, "kl": 1.8918266277978546e-06, "entropy": 2.729353427886963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1954560, "num_agent_steps_sampled": 1954560, "num_steps_trained": 1954560, "num_agent_steps_trained": 1954560}, "done": false, "episodes_total": 978, "training_iteration": 163, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-58-15", "timestamp": 1690837095, "time_this_iter_s": 65.9914436340332, "time_total_s": 10419.66755437851, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10419.66755437851, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.98421052631576, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.016334174368666, "episode_reward_mean": -3.5618452087590264, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5645745993638199, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.997270609395209, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.72706093952036, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1115.33, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5633450693982581, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.8900458559892868, -3.7231836149244093, -3.2813346188002153, -3.8800784654230034, -3.8203810409041337, -3.672128132989519, -3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3468131341236511, "mean_inference_ms": 6.500772392449161, "mean_action_processing_ms": 0.3187422394669361, "mean_env_wait_ms": 7.245101334531703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1966566, "agent_timesteps_total": 1966566, "timers": {"sample_time_ms": 32778.933, "sample_throughput": 359.566, "load_time_ms": 5.416, "load_throughput": 2176243.999, "learn_time_ms": 30302.539, "learn_throughput": 388.951, "update_time_ms": 21.865}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0025464710779488087, "policy_loss": -0.00014336624008137733, "vf_loss": 0.002689837710931897, "vf_explained_var": 0.4318263828754425, "kl": 4.542665556073189e-05, "entropy": 2.712447166442871, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1966566, "num_agent_steps_sampled": 1966566, "num_steps_trained": 1966566, "num_agent_steps_trained": 1966566}, "done": false, "episodes_total": 984, "training_iteration": 164, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_13-59-22", "timestamp": 1690837162, "time_this_iter_s": 66.18965816497803, "time_total_s": 10485.857212543488, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10485.857212543488, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.98617021276597, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.016334174368666, "episode_reward_mean": -3.5224433189480893, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5232233916202566, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.9992199273278346, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.92199273278294, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1100.55, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1963, "constraint_violation.max_vel_constraint.ratio_mean": 0.5559587625516815, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9810094952523738}, "hist_stats": {"episode_reward": [-3.589324290371118, -3.843098027245495, -3.239641930654923, -3.9096432948976343, -3.8368269281655447, -3.6141353243957477, -3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.34708753117015, "mean_inference_ms": 6.501179568783995, "mean_action_processing_ms": 0.3187719298456591, "mean_env_wait_ms": 7.246254947112809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1978572, "agent_timesteps_total": 1978572, "timers": {"sample_time_ms": 32632.237, "sample_throughput": 361.183, "load_time_ms": 5.394, "load_throughput": 2185132.399, "learn_time_ms": 30275.798, "learn_throughput": 389.294, "update_time_ms": 20.387}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0029880378860980272, "policy_loss": 0.0001458104234188795, "vf_loss": 0.0028422237373888493, "vf_explained_var": 0.419566810131073, "kl": 2.971367166537675e-06, "entropy": 2.751986503601074, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1978572, "num_agent_steps_sampled": 1978572, "num_steps_trained": 1978572, "num_agent_steps_trained": 1978572}, "done": false, "episodes_total": 990, "training_iteration": 165, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-00-25", "timestamp": 1690837225, "time_this_iter_s": 63.60949635505676, "time_total_s": 10549.466708898544, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10549.466708898544, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.98131868131867, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.016334174368666, "episode_reward_mean": -3.5073181439303913, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.5082323281698972, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.0674568195298788, "reward_component_totals/delta_v_mean": -1.999085815760497, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.9085815760491, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1093.94, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5526554142258445, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.860637123132836, -3.7904384877387156, -2.582534273963969, -2.7655811735786315, -3.959800531851098, -2.3697636845098535, -3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3473357079791257, "mean_inference_ms": 6.501546214538482, "mean_action_processing_ms": 0.31879467586857596, "mean_env_wait_ms": 7.247192591061438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1990578, "agent_timesteps_total": 1990578, "timers": {"sample_time_ms": 32627.79, "sample_throughput": 365.268, "load_time_ms": 5.497, "load_throughput": 2168025.452, "learn_time_ms": 30519.117, "learn_throughput": 390.506, "update_time_ms": 20.666}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0027160425670444965, "policy_loss": -6.653861055383459e-05, "vf_loss": 0.002782581839710474, "vf_explained_var": 0.4869557321071625, "kl": 0.0006895750993862748, "entropy": 2.700875997543335, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1990578, "num_agent_steps_sampled": 1990578, "num_steps_trained": 1990578, "num_agent_steps_trained": 1990578}, "done": false, "episodes_total": 996, "training_iteration": 166, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-01-27", "timestamp": 1690837287, "time_this_iter_s": 61.64210510253906, "time_total_s": 10611.108814001083, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10611.108814001083, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 99.98636363636363, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -4.016334174368666, "episode_reward_mean": -3.4976335748322254, "episode_len_mean": 1979.02, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.49848103610202094, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.1742523199126818, "reward_component_totals/delta_v_mean": -1.9991525387302076, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.91525387302022, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1093.43, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5524005416621264, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.749713084475823, -4.016334174368666, -3.7707121575453963, -3.968143496193383, -3.6977024752101437, -3.8374980521754507, -3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.347131273604915, "mean_inference_ms": 6.502064647843123, "mean_action_processing_ms": 0.3188155833295445, "mean_env_wait_ms": 7.2481201928697025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2002584, "agent_timesteps_total": 2002584, "timers": {"sample_time_ms": 32722.667, "sample_throughput": 364.209, "load_time_ms": 5.461, "load_throughput": 2182441.535, "learn_time_ms": 30726.822, "learn_throughput": 387.866, "update_time_ms": 19.743}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0022255165968090296, "policy_loss": -0.0006277491338551044, "vf_loss": 0.0028532647993415594, "vf_explained_var": 0.3839104473590851, "kl": 2.5806277335505e-05, "entropy": 2.7309536933898926, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2002584, "num_agent_steps_sampled": 2002584, "num_steps_trained": 2002584, "num_agent_steps_trained": 2002584}, "done": false, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-02-31", "timestamp": 1690837351, "time_this_iter_s": 64.18987774848938, "time_total_s": 10675.298691749573, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10675.298691749573, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.9836956521739, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.6430812566821299, "episode_reward_min": -3.9990685828913444, "episode_reward_mean": -3.4507201071054805, "episode_len_mean": 1969.37, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.4590878474494879, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.2336985843637271, "reward_component_totals/delta_v_mean": -1.9916322596559957, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.710538076212009, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.16322596559897, "delta_v_total_min": 71.05380762120076, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1078.81, "constraint_violation.max_vel_constraint.steps_min": 377, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5483852857765555, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.6460494405797235, -3.7335226534784063, -3.7902386897376825, -3.7981671833512545, -3.831292448795673, -3.9459443900815394, -3.7443265858354633, -3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.346904665653953, "mean_inference_ms": 6.50255383007834, "mean_action_processing_ms": 0.31883376848909567, "mean_env_wait_ms": 7.249046423928974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2013625, "agent_timesteps_total": 2013625, "timers": {"sample_time_ms": 32526.899, "sample_throughput": 363.435, "load_time_ms": 5.722, "load_throughput": 2065844.703, "learn_time_ms": 30720.593, "learn_throughput": 384.804, "update_time_ms": 19.352}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0027031777426600456, "policy_loss": -0.00010906723036896437, "vf_loss": 0.002812243765220046, "vf_explained_var": 0.4003550410270691, "kl": 5.1547543989727274e-05, "entropy": 2.7231149673461914, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2013625, "num_agent_steps_sampled": 2013625, "num_steps_trained": 2013625, "num_agent_steps_trained": 2013625}, "done": false, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-03-33", "timestamp": 1690837413, "time_this_iter_s": 60.84494185447693, "time_total_s": 10736.14363360405, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10736.14363360405, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.98620689655172, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.9990685828913444, "episode_reward_mean": -3.389505487247062, "episode_len_mean": 1948.46, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.4176567388224124, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.971848748424653, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.18487484246467, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1071.9, "constraint_violation.max_vel_constraint.steps_min": 375, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5521374810764279, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.74441203798467, -3.8894274151036354, -3.484333279749391, -3.8944294666024204, -3.8990547364723094, -3.866184409208527, -3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3467271088674533, "mean_inference_ms": 6.50249359482318, "mean_action_processing_ms": 0.31893152960203625, "mean_env_wait_ms": 7.252039378677133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2025541, "agent_timesteps_total": 2025541, "timers": {"sample_time_ms": 32428.106, "sample_throughput": 364.264, "load_time_ms": 5.765, "load_throughput": 2049100.723, "learn_time_ms": 30507.343, "learn_throughput": 387.199, "update_time_ms": 20.66}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002010243944823742, "policy_loss": -0.0005253423005342484, "vf_loss": 0.0025355895049870014, "vf_explained_var": 0.6527404189109802, "kl": 0.0002050000475719571, "entropy": 2.6320319175720215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2025541, "num_agent_steps_sampled": 2025541, "num_steps_trained": 2025541, "num_agent_steps_trained": 2025541}, "done": false, "episodes_total": 1015, "training_iteration": 169, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-04-35", "timestamp": 1690837475, "time_this_iter_s": 62.7107675075531, "time_total_s": 10798.854401111603, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10798.854401111603, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.9876404494382, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.9990685828913444, "episode_reward_mean": -3.3640235150066564, "episode_len_mean": 1948.46, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3907406928482192, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9732828221584398, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.32828221584327, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1070.8, "constraint_violation.max_vel_constraint.steps_min": 375, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5515877559389966, "constraint_violation.max_vel_constraint.ratio_min": 0.19490254872563717, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.7558759896599723, -3.748622575187249, -3.7968041633847966, -2.7170128928196187, -3.6910615270575966, -3.8932429020772537, -3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3465145537699188, "mean_inference_ms": 6.502903104947297, "mean_action_processing_ms": 0.31894300915596313, "mean_env_wait_ms": 7.2528269801038014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2037547, "agent_timesteps_total": 2037547, "timers": {"sample_time_ms": 32442.055, "sample_throughput": 364.108, "load_time_ms": 5.674, "load_throughput": 2081906.587, "learn_time_ms": 30751.712, "learn_throughput": 384.122, "update_time_ms": 20.967}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017241997411474586, "policy_loss": -0.0006474088877439499, "vf_loss": 0.0023716064170002937, "vf_explained_var": 0.7762356996536255, "kl": 0.0005079932743683457, "entropy": 2.574483633041382, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2037547, "num_agent_steps_sampled": 2037547, "num_steps_trained": 2037547, "num_agent_steps_trained": 2037547}, "done": false, "episodes_total": 1021, "training_iteration": 170, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-05-42", "timestamp": 1690837542, "time_this_iter_s": 66.30011320114136, "time_total_s": 10865.154514312744, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10865.154514312744, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 99.98210526315789, "ram_util_percent": 47.5}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.9990685828913444, "episode_reward_mean": -3.3766542224816916, "episode_len_mean": 1948.46, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.4024983598120428, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.97415586266965, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.4155862669644, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1073.76, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5530670163088118, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.9707815404441957, -3.7753497578761754, -3.7356759007515716, -3.6572917992853977, -3.7160805417131257, -0.6430812566821299, -3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 684, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3467281417601447, "mean_inference_ms": 6.503098755808372, "mean_action_processing_ms": 0.31896099657999, "mean_env_wait_ms": 7.2536188856648645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2049553, "agent_timesteps_total": 2049553, "timers": {"sample_time_ms": 33422.263, "sample_throughput": 356.065, "load_time_ms": 5.891, "load_throughput": 2020274.45, "learn_time_ms": 31211.23, "learn_throughput": 381.289, "update_time_ms": 20.068}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0012481092708185315, "policy_loss": -0.0007033700821921229, "vf_loss": 0.0019514808664098382, "vf_explained_var": 0.656552255153656, "kl": 0.0002640940947458148, "entropy": 2.5488524436950684, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2049553, "num_agent_steps_sampled": 2049553, "num_steps_trained": 2049553, "num_agent_steps_trained": 2049553}, "done": false, "episodes_total": 1027, "training_iteration": 171, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-06-56", "timestamp": 1690837616, "time_this_iter_s": 73.78774619102478, "time_total_s": 10938.942260503769, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10938.942260503769, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.98952380952382, "ram_util_percent": 47.500952380952384}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.9990685828913444, "episode_reward_mean": -3.3717126677358156, "episode_len_mean": 1954.03, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.38889701932162013, "reward_component_totals/dist_change_reward_min": -0.9986667708445824, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9828156484141979, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.28156484141914, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1076.16, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5534085460860722, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.8899106800316567, -3.9990685828913444, -3.408851598255432, -3.6872800716976135, -3.9761687218311734, -3.520980691783352, -3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3469461353621015, "mean_inference_ms": 6.503170691516264, "mean_action_processing_ms": 0.3189695126392461, "mean_env_wait_ms": 7.25424388677489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2060799, "agent_timesteps_total": 2060799, "timers": {"sample_time_ms": 33353.994, "sample_throughput": 354.515, "load_time_ms": 6.061, "load_throughput": 1951021.335, "learn_time_ms": 31146.552, "learn_throughput": 379.641, "update_time_ms": 20.21}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00358659983612597, "policy_loss": 0.0005293517024256289, "vf_loss": 0.003057250287383795, "vf_explained_var": 0.32470783591270447, "kl": 1.8760155171548831e-06, "entropy": 2.721911668777466, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2060799, "num_agent_steps_sampled": 2060799, "num_steps_trained": 2060799, "num_agent_steps_trained": 2060799}, "done": false, "episodes_total": 1033, "training_iteration": 172, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-07-57", "timestamp": 1690837677, "time_this_iter_s": 60.98897647857666, "time_total_s": 10999.931236982346, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10999.931236982346, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.98965517241379, "ram_util_percent": 47.60000000000001}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.353528570122419, "episode_len_mean": 1954.03, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.36859565515806, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9849329149643615, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.4932914964355, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1058.4, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5445329838671816, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.9040975871339674, -3.5873340296037703, -3.7245815691441315, -3.7024357670873482, -3.648275744457383, -3.7832742812340068, -3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3471671686170035, "mean_inference_ms": 6.503384480062348, "mean_action_processing_ms": 0.3189824472471969, "mean_env_wait_ms": 7.254966442629549, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2072805, "agent_timesteps_total": 2072805, "timers": {"sample_time_ms": 33225.525, "sample_throughput": 355.886, "load_time_ms": 6.11, "load_throughput": 1935345.375, "learn_time_ms": 31313.018, "learn_throughput": 377.622, "update_time_ms": 23.263}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0019066435052081943, "policy_loss": -0.004367285408079624, "vf_loss": 0.002460641087964177, "vf_explained_var": 0.4463326632976532, "kl": 0.00048169592628255486, "entropy": 2.7119998931884766, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2072805, "num_agent_steps_sampled": 2072805, "num_steps_trained": 2072805, "num_agent_steps_trained": 2072805}, "done": false, "episodes_total": 1039, "training_iteration": 173, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-09-03", "timestamp": 1690837743, "time_this_iter_s": 66.43210124969482, "time_total_s": 11066.36333823204, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11066.36333823204, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.9884210526316, "ram_util_percent": 47.60000000000004}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3415554381030588, "episode_len_mean": 1954.03, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.35130885593471733, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9902465821683442, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.0246582168337, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1037.82, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5342481262959672, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.7408106725898467, -2.4612986514681965, -3.931367502903708, -3.8493331298258853, -2.432848215141435, -3.4166099593128463, -2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.347394983005724, "mean_inference_ms": 6.5037734898213815, "mean_action_processing_ms": 0.31900329902395813, "mean_env_wait_ms": 7.255851135497298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2084811, "agent_timesteps_total": 2084811, "timers": {"sample_time_ms": 33188.425, "sample_throughput": 356.284, "load_time_ms": 6.053, "load_throughput": 1953603.566, "learn_time_ms": 31325.436, "learn_throughput": 377.473, "update_time_ms": 22.356}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0027762586250901222, "policy_loss": 0.0002619290607981384, "vf_loss": 0.002514330670237541, "vf_explained_var": 0.48691821098327637, "kl": 0.00015312190225813538, "entropy": 2.7051782608032227, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2084811, "num_agent_steps_sampled": 2084811, "num_steps_trained": 2084811, "num_agent_steps_trained": 2084811}, "done": false, "episodes_total": 1045, "training_iteration": 174, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-10-10", "timestamp": 1690837810, "time_this_iter_s": 65.9554443359375, "time_total_s": 11132.318782567978, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11132.318782567978, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 47.61578947368422}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3679728647252154, "episode_len_mean": 1954.03, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.37779105278355063, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9901818119416668, "reward_component_totals/delta_v_min": -2.1025871928036235, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.01818119416595, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 210.25871928036156, "constraint_violation.max_vel_constraint.steps_mean": 1029.18, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.529930285216507, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-2.7322847824597463, -3.0673164850119097, -3.810690205617897, -3.744707349021933, -3.264146650991205, -3.8735537502452835, -3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3476540096658982, "mean_inference_ms": 6.504164048984979, "mean_action_processing_ms": 0.3190291325295642, "mean_env_wait_ms": 7.25686160418193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2096817, "agent_timesteps_total": 2096817, "timers": {"sample_time_ms": 33375.087, "sample_throughput": 354.291, "load_time_ms": 6.314, "load_throughput": 1872830.48, "learn_time_ms": 31444.343, "learn_throughput": 376.045, "update_time_ms": 22.012}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.003290770575404167, "policy_loss": 0.0006798917311243713, "vf_loss": 0.0026108797173947096, "vf_explained_var": 0.36853572726249695, "kl": 3.4344779123784974e-05, "entropy": 2.7141833305358887, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2096817, "num_agent_steps_sampled": 2096817, "num_steps_trained": 2096817, "num_agent_steps_trained": 2096817}, "done": false, "episodes_total": 1051, "training_iteration": 175, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-11-16", "timestamp": 1690837876, "time_this_iter_s": 66.64044642448425, "time_total_s": 11198.959228992462, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11198.959228992462, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.98842105263158, "ram_util_percent": 49.1536842105263}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.363997918210737, "episode_len_mean": 1954.03, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.37423937795342205, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9897585402573181, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.97585402573114, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1032.12, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5313995505838234, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.696246772908729, -3.788347255200833, -3.8266471187763074, -1.1254042486727207, -2.6693632384341175, -3.3884750548867855, -3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414], "episode_lengths": [2001, 2001, 2001, 1120, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.348000004283861, "mean_inference_ms": 6.504848445900615, "mean_action_processing_ms": 0.319073104905821, "mean_env_wait_ms": 7.258250144327609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2108823, "agent_timesteps_total": 2108823, "timers": {"sample_time_ms": 33907.544, "sample_throughput": 348.728, "load_time_ms": 6.912, "load_throughput": 1710728.113, "learn_time_ms": 31968.549, "learn_throughput": 369.879, "update_time_ms": 23.12}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0022651134058833122, "policy_loss": -0.00030898823752067983, "vf_loss": 0.002574099460616708, "vf_explained_var": 0.47379544377326965, "kl": 3.0327153581310995e-05, "entropy": 2.7263286113739014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2108823, "num_agent_steps_sampled": 2108823, "num_steps_trained": 2108823, "num_agent_steps_trained": 2108823}, "done": false, "episodes_total": 1057, "training_iteration": 176, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-12-29", "timestamp": 1690837949, "time_this_iter_s": 72.30836200714111, "time_total_s": 11271.267590999603, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11271.267590999603, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.99223300970874, "ram_util_percent": 52.39417475728157}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3878022686314786, "episode_len_mean": 1962.84, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.04, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.96, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.38954207745911623, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9982601911723648, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.82601911723577, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1040.51, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1889, "constraint_violation.max_vel_constraint.ratio_mean": 0.5332613295157859, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.9440279860069966}, "hist_stats": {"episode_reward": [-3.5216813639839213, -3.845146734881453, -3.7549259499757186, -3.152031231691712, -3.9644862134540997, -3.242048716447048, -3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.348207547024375, "mean_inference_ms": 6.50620602837318, "mean_action_processing_ms": 0.3191463050785952, "mean_env_wait_ms": 7.260404221021879, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2120829, "agent_timesteps_total": 2120829, "timers": {"sample_time_ms": 34869.605, "sample_throughput": 339.106, "load_time_ms": 7.06, "load_throughput": 1674874.547, "learn_time_ms": 32810.204, "learn_throughput": 360.391, "update_time_ms": 27.087}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0024093494284898043, "policy_loss": 0.00041894547757692635, "vf_loss": 0.0019904053770005703, "vf_explained_var": 0.8531397581100464, "kl": 0.00044257481931708753, "entropy": 2.5384938716888428, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2120829, "num_agent_steps_sampled": 2120829, "num_steps_trained": 2120829, "num_agent_steps_trained": 2120829}, "done": false, "episodes_total": 1063, "training_iteration": 177, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-13-51", "timestamp": 1690838031, "time_this_iter_s": 82.2610719203949, "time_total_s": 11353.528662919998, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11353.528662919998, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.99230769230769, "ram_util_percent": 56.56495726495725}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3779908467866244, "episode_len_mean": 1962.84, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.04, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.96, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3812565796809652, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9967342671056625, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.6734267105655, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1032.99, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5295032085762557, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.7550657907124707, -3.664556044839282, -3.7606462468946744, -3.9390161878563035, -3.7087559433520214, -3.836444870304276, -3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3486003944333043, "mean_inference_ms": 6.508237217745517, "mean_action_processing_ms": 0.3192594944449564, "mean_env_wait_ms": 7.263543400235304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2132835, "agent_timesteps_total": 2132835, "timers": {"sample_time_ms": 36217.31, "sample_throughput": 329.152, "load_time_ms": 6.803, "load_throughput": 1752238.401, "learn_time_ms": 34054.156, "learn_throughput": 350.06, "update_time_ms": 28.533}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00031188142020255327, "policy_loss": -0.002000640146434307, "vf_loss": 0.0023125233128666878, "vf_explained_var": 0.5756889581680298, "kl": 5.493766366271302e-05, "entropy": 2.651078462600708, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2132835, "num_agent_steps_sampled": 2132835, "num_steps_trained": 2132835, "num_agent_steps_trained": 2132835}, "done": false, "episodes_total": 1069, "training_iteration": 178, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-15-18", "timestamp": 1690838118, "time_this_iter_s": 86.79033756256104, "time_total_s": 11440.31900048256, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11440.31900048256, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 99.98467741935484, "ram_util_percent": 59.925000000000004}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3185520572909777, "episode_len_mean": 1962.84, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.04, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.96, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.32019537267377624, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9983566846172054, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.83566846171976, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1056.02, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.541012453953567, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.71871775502762, -3.5775267755971845, -3.590157056346736, -2.781077978649908, -3.329057302081426, -3.23994448748888, -3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3492058971510763, "mean_inference_ms": 6.511063719729319, "mean_action_processing_ms": 0.31941395164850533, "mean_env_wait_ms": 7.268081093016376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2144841, "agent_timesteps_total": 2144841, "timers": {"sample_time_ms": 37708.643, "sample_throughput": 316.373, "load_time_ms": 6.647, "load_throughput": 1794893.705, "learn_time_ms": 35001.184, "learn_throughput": 340.846, "update_time_ms": 26.484}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0010544171091169119, "policy_loss": -0.0018884610617533326, "vf_loss": 0.0029428796842694283, "vf_explained_var": 0.442241907119751, "kl": 2.1227795059530763e-06, "entropy": 2.7462847232818604, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2144841, "num_agent_steps_sampled": 2144841, "num_steps_trained": 2144841, "num_agent_steps_trained": 2144841}, "done": false, "episodes_total": 1075, "training_iteration": 179, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-16-46", "timestamp": 1690838206, "time_this_iter_s": 87.13141679763794, "time_total_s": 11527.450417280197, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11527.450417280197, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 99.9816, "ram_util_percent": 62.53200000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.3264673051692104, "episode_len_mean": 1962.84, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.04, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.96, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.33076840747366903, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.995698897695545, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.56988976955373, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1066.73, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.546364777791648, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.2382751484987127, -3.9248455212868834, -3.9514593644869755, -3.545775272138509, -3.104402025826657, -3.1807170819662294, -2.925506243467739, -3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3500776222546955, "mean_inference_ms": 6.514740691560555, "mean_action_processing_ms": 0.3196247080774708, "mean_env_wait_ms": 7.274111906595903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2156847, "agent_timesteps_total": 2156847, "timers": {"sample_time_ms": 39673.753, "sample_throughput": 300.703, "load_time_ms": 6.756, "load_throughput": 1765714.261, "learn_time_ms": 35801.007, "learn_throughput": 333.231, "update_time_ms": 27.248}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 4.461736170924269e-05, "policy_loss": -0.002406324027106166, "vf_loss": 0.002450940664857626, "vf_explained_var": 0.49619731307029724, "kl": 0.0011386885307729244, "entropy": 2.652916431427002, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2156847, "num_agent_steps_sampled": 2156847, "num_steps_trained": 2156847, "num_agent_steps_trained": 2156847}, "done": false, "episodes_total": 1081, "training_iteration": 180, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-18-20", "timestamp": 1690838300, "time_this_iter_s": 94.00592255592346, "time_total_s": 11621.45633983612, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11621.45633983612, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.97089552238805, "ram_util_percent": 62.88358208955222}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.2871543038993276, "episode_len_mean": 1948.3, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3054986743255638, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9816556295737655, "reward_component_totals/delta_v_min": -2.0966375968853668, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.16556295737584, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.66375968853626, "constraint_violation.max_vel_constraint.steps_mean": 1068.19, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5515445644979292, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.520814332752915, -2.0497477917847498, -3.790994085551314, -3.768824696249733, -3.5945790716606774, -3.1644661257208524, -2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.352029066220935, "mean_inference_ms": 6.520062348583049, "mean_action_processing_ms": 0.3199322368488457, "mean_env_wait_ms": 7.282838408098241, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2169400, "agent_timesteps_total": 2169400, "timers": {"sample_time_ms": 41675.805, "sample_throughput": 287.57, "load_time_ms": 6.872, "load_throughput": 1744084.324, "learn_time_ms": 37038.072, "learn_throughput": 323.578, "update_time_ms": 28.506}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002863813191652298, "policy_loss": -0.00021544266201090068, "vf_loss": 0.0030792541801929474, "vf_explained_var": 0.39863672852516174, "kl": 1.529316432424821e-05, "entropy": 2.727382183074951, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2169400, "num_agent_steps_sampled": 2169400, "num_steps_trained": 2169400, "num_agent_steps_trained": 2169400}, "done": false, "episodes_total": 1088, "training_iteration": 181, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-20-07", "timestamp": 1690838407, "time_this_iter_s": 106.18313789367676, "time_total_s": 11727.639477729797, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11727.639477729797, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.98026315789474, "ram_util_percent": 62.961842105263166}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.998150606015943, "episode_reward_mean": -3.2913131273393117, "episode_len_mean": 1948.3, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3088638957425231, "reward_component_totals/dist_change_reward_min": -0.9576794607813891, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9824492315967914, "reward_component_totals/delta_v_min": -2.093123470495152, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 198.2449231596784, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.31234704951353, "constraint_violation.max_vel_constraint.steps_mean": 1064.86, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5498803965818874, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-2.927578042392261, -3.273710272385867, -2.6669380427237144, -3.998150606015943, -3.752387857142616, -3.297441580276039, -2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.353973511131179, "mean_inference_ms": 6.5253941393466555, "mean_action_processing_ms": 0.32023220752070414, "mean_env_wait_ms": 7.2917640114779525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2181406, "agent_timesteps_total": 2181406, "timers": {"sample_time_ms": 43505.324, "sample_throughput": 277.224, "load_time_ms": 7.371, "load_throughput": 1636158.002, "learn_time_ms": 38573.244, "learn_throughput": 312.67, "update_time_ms": 29.53}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.00021415212540887296, "policy_loss": -0.0024224675726145506, "vf_loss": 0.002636619843542576, "vf_explained_var": 0.4108772277832031, "kl": 0.0001214750373037532, "entropy": 2.7385482788085938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2181406, "num_agent_steps_sampled": 2181406, "num_steps_trained": 2181406, "num_agent_steps_trained": 2181406}, "done": false, "episodes_total": 1094, "training_iteration": 182, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-21-42", "timestamp": 1690838502, "time_this_iter_s": 94.69480466842651, "time_total_s": 11822.334282398224, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11822.334282398224, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.9711111111111, "ram_util_percent": 62.94148148148147}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.992440398146831, "episode_reward_mean": -3.293964347136519, "episode_len_mean": 1948.3, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.315428027488292, "reward_component_totals/dist_change_reward_min": -0.9731625542209682, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.9785363196482293, "reward_component_totals/delta_v_min": -2.093123470495152, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.85363196482223, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.31234704951353, "constraint_violation.max_vel_constraint.steps_mean": 1060.03, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.547466603478439, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-2.7824706615556085, -1.8629096172446318, -3.4611314099725283, -3.697214215243811, -2.4730134423827335, -3.9590971162505832, -0.8289165242752743, -3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 1036, 2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3560998366261094, "mean_inference_ms": 6.531863966800347, "mean_action_processing_ms": 0.32057751529829837, "mean_env_wait_ms": 7.302061159170267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2193412, "agent_timesteps_total": 2193412, "timers": {"sample_time_ms": 45121.809, "sample_throughput": 267.292, "load_time_ms": 7.262, "load_throughput": 1660732.439, "learn_time_ms": 39617.723, "learn_throughput": 304.427, "update_time_ms": 27.49}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015280237421393394, "policy_loss": -0.0007977658533491194, "vf_loss": 0.0023257900029420853, "vf_explained_var": 0.7158434391021729, "kl": 0.0008908567833714187, "entropy": 2.6013383865356445, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2193412, "num_agent_steps_sampled": 2193412, "num_steps_trained": 2193412, "num_agent_steps_trained": 2193412}, "done": false, "episodes_total": 1100, "training_iteration": 183, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-23-15", "timestamp": 1690838595, "time_this_iter_s": 93.06245803833008, "time_total_s": 11915.396740436554, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11915.396740436554, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 99.97424242424242, "ram_util_percent": 62.94772727272726}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.992440398146831, "episode_reward_mean": -3.3069644724638247, "episode_len_mean": 1943.64, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.33478482133358484, "reward_component_totals/dist_change_reward_min": -0.9731625542209682, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.972179651130242, "reward_component_totals/delta_v_min": -2.093123470495152, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.2179651130236, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.31234704951353, "constraint_violation.max_vel_constraint.steps_mean": 1048.57, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5432661777311419, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.929383959169446, -3.6331352200995015, -3.693030373917316, -3.707017745500898, -3.9024887869784397, -3.910983335664076, -0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3586441262588382, "mean_inference_ms": 6.540784019950738, "mean_action_processing_ms": 0.3210541649719892, "mean_env_wait_ms": 7.314853326346172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2205988, "agent_timesteps_total": 2205988, "timers": {"sample_time_ms": 47351.11, "sample_throughput": 255.912, "load_time_ms": 7.328, "load_throughput": 1653587.199, "learn_time_ms": 41066.841, "learn_throughput": 295.073, "update_time_ms": 29.914}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0023584398441016674, "policy_loss": -0.0004904691595584154, "vf_loss": 0.0028489113319665194, "vf_explained_var": 0.4182935059070587, "kl": 0.0001559509983053431, "entropy": 2.700965166091919, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2205988, "num_agent_steps_sampled": 2205988, "num_steps_trained": 2205988, "num_agent_steps_trained": 2205988}, "done": false, "episodes_total": 1107, "training_iteration": 184, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-24-58", "timestamp": 1690838698, "time_this_iter_s": 102.87988805770874, "time_total_s": 12018.276628494263, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12018.276628494263, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.98095238095239, "ram_util_percent": 62.944217687074826}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.4010882151650511, "episode_reward_min": -3.992440398146831, "episode_reward_mean": -3.2860581584634594, "episode_len_mean": 1943.64, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.95, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3114251725144388, "reward_component_totals/dist_change_reward_min": -0.9731625542209682, "reward_component_totals/dist_change_reward_max": 1.2749960026963594, "reward_component_totals/delta_v_mean": -1.974632985949023, "reward_component_totals/delta_v_min": -2.093123470495152, "reward_component_totals/delta_v_max": -0.5478621470431492, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 197.4632985949016, "delta_v_total_min": 54.78621470431484, "delta_v_total_max": 209.31234704951353, "constraint_violation.max_vel_constraint.steps_mean": 1040.66, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5393131542428861, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-0.4010882151650511, -1.1203357286926057, -3.08101382341728, -2.632623040062274, -3.90884718826693, -3.025601233945374, -3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563], "episode_lengths": [535, 1376, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3611590829009292, "mean_inference_ms": 6.549101542300026, "mean_action_processing_ms": 0.32149152313163326, "mean_env_wait_ms": 7.327739725702104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2217994, "agent_timesteps_total": 2217994, "timers": {"sample_time_ms": 48807.487, "sample_throughput": 248.275, "load_time_ms": 7.597, "load_throughput": 1595115.277, "learn_time_ms": 42072.482, "learn_throughput": 288.02, "update_time_ms": 33.122}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0026703516487032175, "policy_loss": -0.00016348868666682392, "vf_loss": 0.002833840437233448, "vf_explained_var": 0.45563945174217224, "kl": 2.312683682248462e-05, "entropy": 2.7177038192749023, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2217994, "num_agent_steps_sampled": 2217994, "num_steps_trained": 2217994, "num_agent_steps_trained": 2217994}, "done": false, "episodes_total": 1113, "training_iteration": 185, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-26-30", "timestamp": 1690838790, "time_this_iter_s": 91.26705741882324, "time_total_s": 12109.543685913086, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12109.543685913086, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.9723076923077, "ram_util_percent": 62.9623076923077}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -3.992440398146831, "episode_reward_mean": -3.3539526212062727, "episode_len_mean": 1964.55, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3610602128516917, "reward_component_totals/dist_change_reward_min": -0.9731625542209682, "reward_component_totals/dist_change_reward_max": 1.1963569461433519, "reward_component_totals/delta_v_mean": -1.9928924083545838, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.28924083545763, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1033.45, "constraint_violation.max_vel_constraint.steps_min": 297, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5285044871788958, "constraint_violation.max_vel_constraint.ratio_min": 0.14842578710644677, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.7705612304540885, -3.8109976049344074, -3.7428304779121913, -3.938198023887656, -3.878243092312507, -3.700464438310726, -3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3639914458250149, "mean_inference_ms": 6.558368327832796, "mean_action_processing_ms": 0.3218751640028809, "mean_env_wait_ms": 7.340629326168003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2230000, "agent_timesteps_total": 2230000, "timers": {"sample_time_ms": 49737.535, "sample_throughput": 243.633, "load_time_ms": 9.585, "load_throughput": 1264261.064, "learn_time_ms": 42979.863, "learn_throughput": 281.939, "update_time_ms": 35.011}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0016716491663828492, "policy_loss": -0.0005762089276686311, "vf_loss": 0.0022478578612208366, "vf_explained_var": 0.6447001099586487, "kl": 0.0003893005196005106, "entropy": 2.60249924659729, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2230000, "num_agent_steps_sampled": 2230000, "num_steps_trained": 2230000, "num_agent_steps_trained": 2230000}, "done": false, "episodes_total": 1119, "training_iteration": 186, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-28-01", "timestamp": 1690838881, "time_this_iter_s": 90.73274254798889, "time_total_s": 12200.276428461075, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12200.276428461075, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.97, "ram_util_percent": 63.0}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -3.992440398146831, "episode_reward_mean": -3.3354129380565296, "episode_len_mean": 1964.55, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.34418111267302387, "reward_component_totals/dist_change_reward_min": -0.9731625542209682, "reward_component_totals/dist_change_reward_max": 1.1963569461433519, "reward_component_totals/delta_v_mean": -1.991231825383508, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.12318253835005, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1049.28, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1712, "constraint_violation.max_vel_constraint.ratio_mean": 0.5364155316566569, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.8555722138930535}, "hist_stats": {"episode_reward": [-3.8839592307898902, -3.7219955344769566, -1.0620974275342194, -3.992440398146831, -3.7499138621990378, -3.957462033915097, -3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506], "episode_lengths": [2001, 2001, 1241, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3664669416197974, "mean_inference_ms": 6.5684518762819355, "mean_action_processing_ms": 0.32240401353252074, "mean_env_wait_ms": 7.35595112580216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2242006, "agent_timesteps_total": 2242006, "timers": {"sample_time_ms": 50479.952, "sample_throughput": 240.05, "load_time_ms": 9.741, "load_throughput": 1243925.851, "learn_time_ms": 43205.951, "learn_throughput": 280.464, "update_time_ms": 32.616}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.0016116529004648328, "policy_loss": -0.0037194977048784494, "vf_loss": 0.0021078442223370075, "vf_explained_var": 0.5907561779022217, "kl": 0.0009545285138301551, "entropy": 2.5805540084838867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2242006, "num_agent_steps_sampled": 2242006, "num_steps_trained": 2242006, "num_agent_steps_trained": 2242006}, "done": false, "episodes_total": 1125, "training_iteration": 187, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-29-33", "timestamp": 1690838973, "time_this_iter_s": 92.01356506347656, "time_total_s": 12292.289993524551, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12292.289993524551, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 99.98015267175572, "ram_util_percent": 63.0}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.3011220483124992, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3017799755141871, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -1.9993420727983156, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.93420727983084, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1040.7, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5297271647357058, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.009422454039644, -3.2327691463302815, -3.233373750062026, -3.783740114319032, -3.6872360761347416, -3.3896505596920705, -3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3691339867616665, "mean_inference_ms": 6.579394430853683, "mean_action_processing_ms": 0.3229748373824863, "mean_env_wait_ms": 7.372680317357387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2253890, "agent_timesteps_total": 2253890, "timers": {"sample_time_ms": 50816.838, "sample_throughput": 238.218, "load_time_ms": 9.898, "load_throughput": 1222966.555, "learn_time_ms": 43485.092, "learn_throughput": 278.383, "update_time_ms": 34.838}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0028484307695180178, "policy_loss": 1.4389986972673796e-05, "vf_loss": 0.0028340413700789213, "vf_explained_var": 0.39432409405708313, "kl": 3.4460550523363054e-05, "entropy": 2.723752498626709, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2253890, "num_agent_steps_sampled": 2253890, "num_steps_trained": 2253890, "num_agent_steps_trained": 2253890}, "done": false, "episodes_total": 1131, "training_iteration": 188, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-31-06", "timestamp": 1690839066, "time_this_iter_s": 93.06247687339783, "time_total_s": 12385.35247039795, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12385.35247039795, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.9796992481203, "ram_util_percent": 63.060902255639114}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.30978446074229, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.3095926617140704, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.000191799028221, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.01917990282146, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1039.81, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5292823871245114, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.1932688277303445, -3.3765812572126706, -3.801337704998125, -3.50208014346451, -3.5517237053269617, -3.7191262080532823, -2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3720096003531637, "mean_inference_ms": 6.591294683600047, "mean_action_processing_ms": 0.3235920815331217, "mean_env_wait_ms": 7.390516170500047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2265896, "agent_timesteps_total": 2265896, "timers": {"sample_time_ms": 50936.839, "sample_throughput": 237.657, "load_time_ms": 10.07, "load_throughput": 1202176.078, "learn_time_ms": 44033.847, "learn_throughput": 274.914, "update_time_ms": 35.579}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002896591555327177, "policy_loss": 0.0002263005735585466, "vf_loss": 0.002670291345566511, "vf_explained_var": 0.4081479012966156, "kl": 1.2240309843036812e-05, "entropy": 2.720940113067627, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2265896, "num_agent_steps_sampled": 2265896, "num_steps_trained": 2265896, "num_agent_steps_trained": 2265896}, "done": false, "episodes_total": 1137, "training_iteration": 189, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-32-40", "timestamp": 1690839160, "time_this_iter_s": 93.84892249107361, "time_total_s": 12479.201392889023, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12479.201392889023, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.9731343283582, "ram_util_percent": 63.10000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.291979823204203, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.291840611448211, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.0001392117559944, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.01392117559874, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1027.39, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5230754905727872, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-2.9357953785696767, -3.642622636312061, -3.955974593266997, -3.9872651343548666, -3.3837440745764633, -3.5585772229130486, -3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3750726456691589, "mean_inference_ms": 6.604030430254174, "mean_action_processing_ms": 0.32425277293840193, "mean_env_wait_ms": 7.409608993967132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2277902, "agent_timesteps_total": 2277902, "timers": {"sample_time_ms": 50782.482, "sample_throughput": 238.379, "load_time_ms": 10.418, "load_throughput": 1161940.95, "learn_time_ms": 44042.485, "learn_throughput": 274.86, "update_time_ms": 37.836}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0017877374775707722, "policy_loss": -0.0007040132186375558, "vf_loss": 0.002491750055924058, "vf_explained_var": 0.46309027075767517, "kl": 0.00014915477368049324, "entropy": 2.6861705780029297, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2277902, "num_agent_steps_sampled": 2277902, "num_steps_trained": 2277902, "num_agent_steps_trained": 2277902}, "done": false, "episodes_total": 1143, "training_iteration": 190, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-34-13", "timestamp": 1690839253, "time_this_iter_s": 92.57186198234558, "time_total_s": 12571.773254871368, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12571.773254871368, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.97938931297709, "ram_util_percent": 63.100000000000016}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.267974711272324, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.26796051338136556, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.0000141978909607, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.00141978909534, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1025.72, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5222409078641416, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.843647228368181, -3.744802539977946, -2.3850523013579856, -3.719198566873466, -3.9291723141545263, -2.4118969767800627, -3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3788235481823796, "mean_inference_ms": 6.617366283278771, "mean_action_processing_ms": 0.32495974357473206, "mean_env_wait_ms": 7.4300071249753294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2289908, "agent_timesteps_total": 2289908, "timers": {"sample_time_ms": 51502.59, "sample_throughput": 233.984, "load_time_ms": 10.077, "load_throughput": 1195854.851, "learn_time_ms": 43992.93, "learn_throughput": 273.926, "update_time_ms": 39.501}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0007480945205315948, "policy_loss": -0.0019535112660378218, "vf_loss": 0.0027016077656298876, "vf_explained_var": 0.40089645981788635, "kl": 4.541896123555489e-05, "entropy": 2.707350254058838, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2289908, "num_agent_steps_sampled": 2289908, "num_steps_trained": 2289908, "num_agent_steps_trained": 2289908}, "done": false, "episodes_total": 1149, "training_iteration": 191, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-36-06", "timestamp": 1690839366, "time_this_iter_s": 112.92214965820312, "time_total_s": 12684.695404529572, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12684.695404529572, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 99.98333333333333, "ram_util_percent": 63.13765432098765}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.25832608105606, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.2593892069490363, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -1.9989368741070268, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.89368741070194, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1014.91, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5168386090135668, "constraint_violation.max_vel_constraint.ratio_min": 0.19440279860069964, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.8937275544048187, -3.756156858329414, -3.3062179306853445, -2.3280127539692144, -3.8913131979139486, -3.7165315637582976, -3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3826954542021967, "mean_inference_ms": 6.63121068422774, "mean_action_processing_ms": 0.3256978835163281, "mean_env_wait_ms": 7.451216762645827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2301914, "agent_timesteps_total": 2301914, "timers": {"sample_time_ms": 51539.071, "sample_throughput": 233.819, "load_time_ms": 9.977, "load_throughput": 1207808.17, "learn_time_ms": 44118.627, "learn_throughput": 273.145, "update_time_ms": 40.021}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0019619998056441545, "policy_loss": -0.0006234627799130976, "vf_loss": 0.0025854622945189476, "vf_explained_var": 0.39511021971702576, "kl": 3.874382673529908e-05, "entropy": 2.6981618404388428, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2301914, "num_agent_steps_sampled": 2301914, "num_steps_trained": 2301914, "num_agent_steps_trained": 2301914}, "done": false, "episodes_total": 1155, "training_iteration": 192, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-37-43", "timestamp": 1690839463, "time_this_iter_s": 96.41023588180542, "time_total_s": 12781.105640411377, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12781.105640411377, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.97664233576641, "ram_util_percent": 63.199999999999996}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.2370379274244776, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.2380570153659247, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -1.9989809120585553, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 199.8980912058549, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1026.3, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5225307629366054, "constraint_violation.max_vel_constraint.ratio_min": 0.2288855572213893, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.687719069243336, -3.9451242153834043, -3.718403809330114, -3.7452840604508824, -3.1931616325395447, -2.408895111801572, -3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3866240434238475, "mean_inference_ms": 6.645414432678133, "mean_action_processing_ms": 0.32645138301048104, "mean_env_wait_ms": 7.472906965926062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2313920, "agent_timesteps_total": 2313920, "timers": {"sample_time_ms": 51464.43, "sample_throughput": 234.158, "load_time_ms": 10.025, "load_throughput": 1202040.439, "learn_time_ms": 44410.943, "learn_throughput": 271.348, "update_time_ms": 38.752}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0026152569334954023, "policy_loss": -0.0002510654157958925, "vf_loss": 0.0028663212433457375, "vf_explained_var": 0.40790319442749023, "kl": 3.364062649779953e-05, "entropy": 2.7231199741363525, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2313920, "num_agent_steps_sampled": 2313920, "num_steps_trained": 2313920, "num_agent_steps_trained": 2313920}, "done": false, "episodes_total": 1161, "training_iteration": 193, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-39-18", "timestamp": 1690839558, "time_this_iter_s": 95.16664218902588, "time_total_s": 12876.272282600403, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12876.272282600403, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.97426470588235, "ram_util_percent": 63.19999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.2186875066164737, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.21776194313104888, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.0009255634854277, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.09255634854202, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 1018.05, "constraint_violation.max_vel_constraint.steps_min": 335, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.5184078244058707, "constraint_violation.max_vel_constraint.ratio_min": 0.2288855572213893, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-3.7936154671584275, -3.6398179446680556, -3.083817778068833, -2.305590058877489, -3.269375996048505, -2.1594659982681423, -2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3904848709549267, "mean_inference_ms": 6.659725645838547, "mean_action_processing_ms": 0.32721779238691684, "mean_env_wait_ms": 7.494746167320603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2325926, "agent_timesteps_total": 2325926, "timers": {"sample_time_ms": 50570.11, "sample_throughput": 237.172, "load_time_ms": 9.727, "load_throughput": 1233075.143, "learn_time_ms": 44463.262, "learn_throughput": 269.746, "update_time_ms": 39.246}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002852523932233453, "policy_loss": 0.00013676790695171803, "vf_loss": 0.0027157545555382967, "vf_explained_var": 0.4487627446651459, "kl": 0.00011572311632335186, "entropy": 2.7118730545043945, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2325926, "num_agent_steps_sampled": 2325926, "num_steps_trained": 2325926, "num_agent_steps_trained": 2325926}, "done": false, "episodes_total": 1167, "training_iteration": 194, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-40-53", "timestamp": 1690839653, "time_this_iter_s": 94.53909993171692, "time_total_s": 12970.81138253212, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12970.81138253212, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.97037037037036, "ram_util_percent": 63.19999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.235521125416275, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.23461478490364102, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.000906340512637, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.09063405126304, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 990.35, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1586, "constraint_violation.max_vel_constraint.ratio_mean": 0.504564745945101, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7926036981509246}, "hist_stats": {"episode_reward": [-2.9417422399969997, -2.960614063134431, -3.006707378039029, -3.8325626426051937, -3.7092909300881294, -3.3680793040261663, -3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.394283897528096, "mean_inference_ms": 6.674147626819279, "mean_action_processing_ms": 0.3279838138216498, "mean_env_wait_ms": 7.516363741968422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2337932, "agent_timesteps_total": 2337932, "timers": {"sample_time_ms": 50708.953, "sample_throughput": 236.522, "load_time_ms": 9.564, "load_throughput": 1254026.352, "learn_time_ms": 44609.084, "learn_throughput": 268.865, "update_time_ms": 40.285}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0015181052731350064, "policy_loss": -0.000939861114602536, "vf_loss": 0.002457967260852456, "vf_explained_var": 0.5398206114768982, "kl": 9.385876182932407e-05, "entropy": 2.6581366062164307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2337932, "num_agent_steps_sampled": 2337932, "num_steps_trained": 2337932, "num_agent_steps_trained": 2337932}, "done": false, "episodes_total": 1173, "training_iteration": 195, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-42-27", "timestamp": 1690839747, "time_this_iter_s": 94.14697480201721, "time_total_s": 13064.958357334137, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13064.958357334137, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 99.97185185185185, "ram_util_percent": 63.19999999999999}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.40457532054121037, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.2227766408854266, "episode_len_mean": 1970.93, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.22172996143286752, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.0010466794525623, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5815459585686529, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 200.1046679452555, "delta_v_total_min": 58.154595856865235, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 970.26, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1537, "constraint_violation.max_vel_constraint.ratio_mean": 0.4945247659351061, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7681159420289855}, "hist_stats": {"episode_reward": [-3.2265929827994686, -3.884772905457039, -3.8501231866777785, -2.8760653681799213, -2.8890137315743143, -0.40457532054121037, -3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175, -2.791089258484482, -3.7702887797855165, -3.9048655321008887, -2.584294251814419, -2.800803397929399, -2.6932068846904125], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 547, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3979915718590572, "mean_inference_ms": 6.688581617013957, "mean_action_processing_ms": 0.3287408411829444, "mean_env_wait_ms": 7.537861485308679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2349938, "agent_timesteps_total": 2349938, "timers": {"sample_time_ms": 51157.078, "sample_throughput": 234.45, "load_time_ms": 6.976, "load_throughput": 1719374.919, "learn_time_ms": 44725.295, "learn_throughput": 268.166, "update_time_ms": 41.676}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002491628983989358, "policy_loss": -0.0002287453244207427, "vf_loss": 0.002720374148339033, "vf_explained_var": 0.45862841606140137, "kl": 0.00017949705943465233, "entropy": 2.6899373531341553, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2349938, "num_agent_steps_sampled": 2349938, "num_steps_trained": 2349938, "num_agent_steps_trained": 2349938}, "done": false, "episodes_total": 1179, "training_iteration": 196, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-44-04", "timestamp": 1690839844, "time_this_iter_s": 96.33368587493896, "time_total_s": 13161.292043209076, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13161.292043209076, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 99.97299270072992, "ram_util_percent": 63.199999999999996}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.5363021653213798, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.21815644876632, "episode_len_mean": 1985.47, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.20218515193435307, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2063931890706066, "reward_component_totals/delta_v_mean": -2.015971296831969, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5857269110778968, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.59712968319624, "delta_v_total_min": 58.572691107789616, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 965.56, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1537, "constraint_violation.max_vel_constraint.ratio_mean": 0.4877257888240273, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7681159420289855}, "hist_stats": {"episode_reward": [-3.2115455083846194, -3.0300793644520345, -3.678278050873403, -3.2427448177279454, -3.714517147750956, -2.4112314356873057, -3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175, -2.791089258484482, -3.7702887797855165, -3.9048655321008887, -2.584294251814419, -2.800803397929399, -2.6932068846904125, -2.009145190240471, -3.7615663776717625, -3.6890774816122853, -2.536259833583702, -2.151874585471938, -2.521200814738836], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4010152610560902, "mean_inference_ms": 6.70294159769296, "mean_action_processing_ms": 0.32948159433363466, "mean_env_wait_ms": 7.558865278444152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2361944, "agent_timesteps_total": 2361944, "timers": {"sample_time_ms": 51180.124, "sample_throughput": 234.345, "load_time_ms": 6.7, "load_throughput": 1790121.747, "learn_time_ms": 44966.574, "learn_throughput": 266.727, "update_time_ms": 42.337}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0020009633153676987, "policy_loss": -0.000857969862408936, "vf_loss": 0.0028589353896677494, "vf_explained_var": 0.4132866859436035, "kl": 1.7131969798356295e-05, "entropy": 2.716384172439575, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2361944, "num_agent_steps_sampled": 2361944, "num_steps_trained": 2361944, "num_agent_steps_trained": 2361944}, "done": false, "episodes_total": 1185, "training_iteration": 197, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-45-39", "timestamp": 1690839939, "time_this_iter_s": 94.59648156166077, "time_total_s": 13255.888524770737, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13255.888524770737, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.96962962962962, "ram_util_percent": 63.22666666666668}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.5363021653213798, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.1990355807956616, "episode_len_mean": 1984.81, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.1845255813942898, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2249275920490887, "reward_component_totals/delta_v_mean": -2.0145099994013744, "reward_component_totals/delta_v_min": -2.0928045266866784, "reward_component_totals/delta_v_max": -0.5857269110778968, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.4509999401367, "delta_v_total_min": 58.572691107789616, "delta_v_total_max": 209.28045266866602, "constraint_violation.max_vel_constraint.steps_mean": 952.69, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1537, "constraint_violation.max_vel_constraint.ratio_mean": 0.4814910534785218, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7681159420289855}, "hist_stats": {"episode_reward": [-3.095076721372221, -3.8618409548160795, -3.9798973703641876, -3.8174384183850028, -3.7546168981452235, -2.642908891456732, -3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175, -2.791089258484482, -3.7702887797855165, -3.9048655321008887, -2.584294251814419, -2.800803397929399, -2.6932068846904125, -2.009145190240471, -3.7615663776717625, -3.6890774816122853, -2.536259833583702, -2.151874585471938, -2.521200814738836, -3.793948981036765, -3.593646715428756, -3.1615995640828443, -2.782176846061038, -1.7791529844005476, -2.2657844368005184], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1935, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4040266451769574, "mean_inference_ms": 6.717200108510419, "mean_action_processing_ms": 0.3302216322523604, "mean_env_wait_ms": 7.579728106608108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2373884, "agent_timesteps_total": 2373884, "timers": {"sample_time_ms": 51320.184, "sample_throughput": 233.814, "load_time_ms": 7.308, "load_throughput": 1641915.114, "learn_time_ms": 44983.753, "learn_throughput": 266.75, "update_time_ms": 45.448}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.002058575162664056, "policy_loss": -0.0007279893616214395, "vf_loss": 0.002786562079563737, "vf_explained_var": 0.33675190806388855, "kl": 6.838140689069405e-05, "entropy": 2.7115654945373535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2373884, "num_agent_steps_sampled": 2373884, "num_steps_trained": 2373884, "num_agent_steps_trained": 2373884}, "done": false, "episodes_total": 1191, "training_iteration": 198, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-47-14", "timestamp": 1690840034, "time_this_iter_s": 94.69146847724915, "time_total_s": 13350.579993247986, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13350.579993247986, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.97481481481482, "ram_util_percent": 63.10000000000003}, "trial_id": "80031_00000"}
{"episode_reward_max": -0.5363021653213798, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.1776215598227817, "episode_len_mean": 1984.81, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.03, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.97, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.1631706845861898, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2249275920490887, "reward_component_totals/delta_v_mean": -2.014450875236595, "reward_component_totals/delta_v_min": -2.088913815071186, "reward_component_totals/delta_v_max": -0.5857269110778968, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 201.4450875236588, "delta_v_total_min": 58.572691107789616, "delta_v_total_max": 208.89138150711793, "constraint_violation.max_vel_constraint.steps_mean": 950.22, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1537, "constraint_violation.max_vel_constraint.ratio_mean": 0.48025667066992606, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7681159420289855}, "hist_stats": {"episode_reward": [-3.9011735893752157, -3.1470816826369292, -2.918108900658069, -2.5388473239383367, -3.7640075634680894, -0.5363021653213798, -3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175, -2.791089258484482, -3.7702887797855165, -3.9048655321008887, -2.584294251814419, -2.800803397929399, -2.6932068846904125, -2.009145190240471, -3.7615663776717625, -3.6890774816122853, -2.536259833583702, -2.151874585471938, -2.521200814738836, -3.793948981036765, -3.593646715428756, -3.1615995640828443, -2.782176846061038, -1.7791529844005476, -2.2657844368005184, -2.8512789794702575, -3.663126285206835, -2.7596526310971417, -2.9407266566987555, -3.421183315715041, -3.3744092890634247], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 570, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1935, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4069725974765301, "mean_inference_ms": 6.731150144741132, "mean_action_processing_ms": 0.33094919468882067, "mean_env_wait_ms": 7.600286996210879, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2385890, "agent_timesteps_total": 2385890, "timers": {"sample_time_ms": 51225.665, "sample_throughput": 234.246, "load_time_ms": 7.651, "load_throughput": 1568257.015, "learn_time_ms": 44953.967, "learn_throughput": 266.926, "update_time_ms": 45.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": -0.00024132557155098766, "policy_loss": -0.0026419279165565968, "vf_loss": 0.0024006010498851538, "vf_explained_var": 0.7069939970970154, "kl": 0.001041710376739502, "entropy": 2.6279454231262207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2385890, "num_agent_steps_sampled": 2385890, "num_steps_trained": 2385890, "num_agent_steps_trained": 2385890}, "done": false, "episodes_total": 1197, "training_iteration": 199, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-48-47", "timestamp": 1690840127, "time_this_iter_s": 92.57331705093384, "time_total_s": 13443.15331029892, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13443.15331029892, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.97878787878787, "ram_util_percent": 63.10000000000002}, "trial_id": "80031_00000"}
{"episode_reward_max": -1.7107057434936555, "episode_reward_min": -4.009620291120171, "episode_reward_mean": -3.1817004614955597, "episode_len_mean": 1999.12, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.02, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.98, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.15212678000593205, "reward_component_totals/dist_change_reward_min": -0.9932237546407847, "reward_component_totals/dist_change_reward_max": 1.2249275920490887, "reward_component_totals/delta_v_mean": -2.0295736814896306, "reward_component_totals/delta_v_min": -2.088913815071186, "reward_component_totals/delta_v_max": -1.7576353120803845, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 202.9573681489624, "delta_v_total_min": 175.76353120803822, "delta_v_total_max": 208.89138150711793, "constraint_violation.max_vel_constraint.steps_mean": 966.72, "constraint_violation.max_vel_constraint.steps_min": 311, "constraint_violation.max_vel_constraint.steps_max": 1537, "constraint_violation.max_vel_constraint.ratio_mean": 0.4836847461058923, "constraint_violation.max_vel_constraint.ratio_min": 0.15542228885557222, "constraint_violation.max_vel_constraint.ratio_max": 0.7681159420289855}, "hist_stats": {"episode_reward": [-3.164753013931862, -3.093877252473921, -3.3534069556815806, -3.9135712448405897, -3.4333128867178067, -3.38964946882366, -3.3487445080897364, -3.6900920803767594, -3.905849703640503, -2.9177593736446563, -3.5548944691825817, -2.354172900676531, -3.807503972289913, -3.6704156264249947, -3.758964829702875, -3.813003705553986, -3.094165497679831, -3.7348715697703883, -3.674213930912459, -3.716414471730218, -3.746510392137155, -3.0211506906071506, -2.81488321828177, -3.570112448680924, -2.5575225926596854, -1.7107057434936555, -2.2759352184228887, -4.009620291120171, -3.4270099144671615, -3.537202828912463, -3.8826072666587197, -3.841030329817185, -3.4158039190252585, -3.0987790846759724, -3.656146500349717, -3.716683028602243, -2.479332680744507, -2.947843362287582, -3.8543528863000858, -2.709295634693115, -2.1968564299010707, -3.875164579646585, -3.48508784135238, -2.748365716921529, -2.889177587759674, -3.868815691223962, -3.725404797723143, -3.814586181525512, -3.7615723109575585, -2.652794944606988, -2.956057202801629, -2.158491468270998, -2.91555141633666, -2.9357129926757777, -3.8321127215991058, -3.3460876364882672, -2.6684456228584894, -3.065234105944482, -2.352436524461197, -3.728782933554413, -2.1284153253515865, -3.540944366114692, -3.7565231009272653, -3.3564435675392668, -3.8141423033038544, -3.607017545384447, -2.1416260674389043, -3.2827533039599146, -3.1535648308989934, -3.9359410720835175, -2.791089258484482, -3.7702887797855165, -3.9048655321008887, -2.584294251814419, -2.800803397929399, -2.6932068846904125, -2.009145190240471, -3.7615663776717625, -3.6890774816122853, -2.536259833583702, -2.151874585471938, -2.521200814738836, -3.793948981036765, -3.593646715428756, -3.1615995640828443, -2.782176846061038, -1.7791529844005476, -2.2657844368005184, -2.8512789794702575, -3.663126285206835, -2.7596526310971417, -2.9407266566987555, -3.421183315715041, -3.3744092890634247, -3.3978067954707436, -3.210349087509375, -3.390138341585507, -1.9770568658259098, -2.3788622095035103, -2.8591980927807814], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1879, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1935, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4098745231371377, "mean_inference_ms": 6.7449001244971045, "mean_action_processing_ms": 0.3316733088394529, "mean_env_wait_ms": 7.620596491974166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2397896, "agent_timesteps_total": 2397896, "timers": {"sample_time_ms": 51211.77, "sample_throughput": 234.309, "load_time_ms": 7.283, "load_throughput": 1647591.143, "learn_time_ms": 44868.414, "learn_throughput": 267.435, "update_time_ms": 44.886}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 1.0000000116860974e-07, "total_loss": 0.0035625796299427748, "policy_loss": 0.0004932094598188996, "vf_loss": 0.0030693684238940477, "vf_explained_var": 0.40064486861228943, "kl": 1.3575428283729707e-06, "entropy": 2.7304515838623047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2397896, "num_agent_steps_sampled": 2397896, "num_steps_trained": 2397896, "num_agent_steps_trained": 2397896}, "done": true, "episodes_total": 1203, "training_iteration": 200, "experiment_id": "24631616d6bd462b9bef0dc9361d1f15", "date": "2023-07-31_14-50-19", "timestamp": 1690840219, "time_this_iter_s": 91.58295512199402, "time_total_s": 13534.736265420914, "pid": 3340372, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-07, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13534.736265420914, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 99.97328244274809, "ram_util_percent": 63.17022900763358}, "trial_id": "80031_00000"}
