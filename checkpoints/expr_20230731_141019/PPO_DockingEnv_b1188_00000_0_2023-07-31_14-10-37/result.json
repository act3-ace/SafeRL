{"episode_reward_max": -3.801279160038309, "episode_reward_min": -3.906790602502561, "episode_reward_mean": -3.868041636231275, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.7860437416030971, "reward_component_totals/dist_change_reward_min": -0.8221965123810681, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.0819978946281843, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.0715022702018433, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19978946281765, "delta_v_total_min": 207.15022702018368, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1262.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 984, "constraint_violation.max_vel_constraint.steps_max": 1657, "constraint_violation.max_vel_constraint.ratio_mean": 0.630767949358654, "constraint_violation.max_vel_constraint.ratio_min": 0.4917541229385307, "constraint_violation.max_vel_constraint.ratio_max": 0.8280859570214892}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.88849904304578, "mean_inference_ms": 7.920206784011125, "mean_action_processing_ms": 0.429247662578866, "mean_env_wait_ms": 10.126304038953196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 12006, "agent_timesteps_total": 12006, "timers": {"sample_time_ms": 51548.566, "sample_throughput": 232.907, "load_time_ms": 396.096, "load_throughput": 30310.798, "learn_time_ms": 40123.263, "learn_throughput": 299.228, "update_time_ms": 29.079}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999717180685e-10, "total_loss": 0.004509405232965946, "policy_loss": -0.00013923502410762012, "vf_loss": 0.004648556467145681, "vf_explained_var": 0.45095399022102356, "kl": 4.2008906575574656e-07, "entropy": 2.7271060943603516, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 12006, "num_agent_steps_sampled": 12006, "num_steps_trained": 12006, "num_agent_steps_trained": 12006}, "done": false, "episodes_total": 6, "training_iteration": 1, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-13-41", "timestamp": 1690838021, "time_this_iter_s": 92.68204927444458, "time_total_s": 92.68204927444458, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 92.68204927444458, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 99.99323308270677, "ram_util_percent": 55.685714285714276}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.801279160038309, "episode_reward_min": -4.037530194473474, "episode_reward_mean": -3.9100526665484487, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.838057988037891, "reward_component_totals/dist_change_reward_min": -0.9770711120984975, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.071994678510564, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.037486376961079, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.19946785105563, "delta_v_total_min": 203.7486376961068, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1314.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6567549558554057, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.588842150896088, "mean_inference_ms": 8.18498391053487, "mean_action_processing_ms": 0.43244634279389166, "mean_env_wait_ms": 10.288279439196028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 24012, "agent_timesteps_total": 24012, "timers": {"sample_time_ms": 48758.096, "sample_throughput": 246.236, "load_time_ms": 201.456, "load_throughput": 59596.225, "learn_time_ms": 38550.043, "learn_throughput": 311.439, "update_time_ms": 46.229}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999717180685e-10, "total_loss": 0.005431381519883871, "policy_loss": 0.0006254938780330122, "vf_loss": 0.00480581633746624, "vf_explained_var": 0.2076234668493271, "kl": 7.354294098149694e-07, "entropy": 2.7036640644073486, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 24012, "num_agent_steps_sampled": 24012, "num_steps_trained": 24012, "num_agent_steps_trained": 24012}, "done": false, "episodes_total": 12, "training_iteration": 2, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-15-04", "timestamp": 1690838104, "time_this_iter_s": 83.0549111366272, "time_total_s": 175.73696041107178, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 175.73696041107178, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.98644067796612, "ram_util_percent": 59.5135593220339}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.041753657078203, "episode_reward_mean": -3.906796610484337, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381490685728248, "reward_component_totals/dist_change_reward_min": -0.9770711120984975, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.068647541911518, "reward_component_totals/delta_v_min": -2.1088772449394098, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 206.86475419115104, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 210.88772449394034, "constraint_violation.max_vel_constraint.steps_mean": 1306.7777777777778, "constraint_violation.max_vel_constraint.steps_min": 702, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6530623577100338, "constraint_violation.max_vel_constraint.ratio_min": 0.35082458770614694, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283455525610433, "mean_inference_ms": 8.408031917773709, "mean_action_processing_ms": 0.4335631328442051, "mean_env_wait_ms": 10.452621958119142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 36018, "agent_timesteps_total": 36018, "timers": {"sample_time_ms": 48532.134, "sample_throughput": 247.382, "load_time_ms": 136.19, "load_throughput": 88155.933, "learn_time_ms": 39550.256, "learn_throughput": 303.563, "update_time_ms": 37.993}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003853817470371723, "policy_loss": -0.00014777449541725218, "vf_loss": 0.0040015787817537785, "vf_explained_var": 0.25320491194725037, "kl": 2.575332302967581e-07, "entropy": 2.747438430786133, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 36018, "num_agent_steps_sampled": 36018, "num_steps_trained": 36018, "num_agent_steps_trained": 36018}, "done": false, "episodes_total": 18, "training_iteration": 3, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-16-34", "timestamp": 1690838194, "time_this_iter_s": 89.69926357269287, "time_total_s": 265.43622398376465, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.43622398376465, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.98139534883721, "ram_util_percent": 62.28372093023256}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.041753657078203, "episode_reward_mean": -3.908811616352221, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354649620658213, "reward_component_totals/dist_change_reward_min": -0.9770711120984975, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.073346654286405, "reward_component_totals/delta_v_min": -2.118717274069795, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.33466542863974, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 211.87172740697866, "constraint_violation.max_vel_constraint.steps_mean": 1246.1666666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.6227719473596535, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3276855611987535, "mean_inference_ms": 8.58359418766817, "mean_action_processing_ms": 0.4351692877528519, "mean_env_wait_ms": 10.585760299034037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 48024, "agent_timesteps_total": 48024, "timers": {"sample_time_ms": 48681.299, "sample_throughput": 246.624, "load_time_ms": 103.778, "load_throughput": 115689.321, "learn_time_ms": 40442.111, "learn_throughput": 296.869, "update_time_ms": 38.586}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027826805599033833, "policy_loss": -0.0004753575485665351, "vf_loss": 0.003258036682382226, "vf_explained_var": 0.08411917835474014, "kl": 4.65486031941964e-08, "entropy": 2.7982685565948486, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 48024, "num_agent_steps_sampled": 48024, "num_steps_trained": 48024, "num_agent_steps_trained": 48024}, "done": false, "episodes_total": 24, "training_iteration": 4, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-18-07", "timestamp": 1690838287, "time_this_iter_s": 92.35290670394897, "time_total_s": 357.7891306877136, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 357.7891306877136, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.9763358778626, "ram_util_percent": 62.870229007633576}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.917270083597665, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8432546718051372, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.72742210969892, "reward_component_totals/delta_v_mean": -2.074015411792534, "reward_component_totals/delta_v_min": -2.118717274069795, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4015411792526, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 211.87172740697866, "constraint_violation.max_vel_constraint.steps_mean": 1189.4, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5944027986006996, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.263837573754186, "mean_inference_ms": 8.752882490840143, "mean_action_processing_ms": 0.43782884357142515, "mean_env_wait_ms": 10.70956392111671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 60030, "agent_timesteps_total": 60030, "timers": {"sample_time_ms": 49603.721, "sample_throughput": 242.038, "load_time_ms": 84.535, "load_throughput": 142024.049, "learn_time_ms": 41114.512, "learn_throughput": 292.014, "update_time_ms": 35.485}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999717180685e-10, "total_loss": 0.004312026780098677, "policy_loss": 0.0005023562698625028, "vf_loss": 0.003809662302955985, "vf_explained_var": 0.351184219121933, "kl": 8.798119210950972e-07, "entropy": 2.7230563163757324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 60030, "num_agent_steps_sampled": 60030, "num_steps_trained": 60030, "num_agent_steps_trained": 60030}, "done": false, "episodes_total": 30, "training_iteration": 5, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-19-44", "timestamp": 1690838384, "time_this_iter_s": 97.18244934082031, "time_total_s": 454.97158002853394, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 454.97158002853394, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 99.97553956834531, "ram_util_percent": 62.94820143884892}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.908771051182685, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348519568632677, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.7221792452385553, "reward_component_totals/delta_v_mean": -2.0739190943194243, "reward_component_totals/delta_v_min": -2.118717274069795, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3919094319417, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 211.87172740697866, "constraint_violation.max_vel_constraint.steps_mean": 1189.6666666666667, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5945360653006831, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2214316940360073, "mean_inference_ms": 8.874419473740012, "mean_action_processing_ms": 0.4433106701707852, "mean_env_wait_ms": 10.807905249587582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 72036, "agent_timesteps_total": 72036, "timers": {"sample_time_ms": 49549.857, "sample_throughput": 242.301, "load_time_ms": 71.562, "load_throughput": 167771.135, "learn_time_ms": 41472.65, "learn_throughput": 289.492, "update_time_ms": 35.754}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999717180685e-10, "total_loss": 0.004140947479754686, "policy_loss": 0.00035070115700364113, "vf_loss": 0.0037902432959526777, "vf_explained_var": 0.192019984126091, "kl": 5.54650171125104e-07, "entropy": 2.7351670265197754, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 72036, "num_agent_steps_sampled": 72036, "num_steps_trained": 72036, "num_agent_steps_trained": 72036}, "done": false, "episodes_total": 36, "training_iteration": 6, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-21-17", "timestamp": 1690838477, "time_this_iter_s": 92.67506647109985, "time_total_s": 547.6466464996338, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 547.6466464996338, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.97251908396944, "ram_util_percent": 62.9473282442748}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.9135648887237755, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.839412757332119, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.7221792452385553, "reward_component_totals/delta_v_mean": -2.074152131391663, "reward_component_totals/delta_v_min": -2.118717274069795, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41521313916556, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 211.87172740697866, "constraint_violation.max_vel_constraint.steps_mean": 1184.5714285714287, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5919897194260012, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1881012309402763, "mean_inference_ms": 8.962463982674231, "mean_action_processing_ms": 0.4469782343384263, "mean_env_wait_ms": 10.881403004541175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 84042, "agent_timesteps_total": 84042, "timers": {"sample_time_ms": 49592.116, "sample_throughput": 242.095, "load_time_ms": 62.405, "load_throughput": 192388.933, "learn_time_ms": 41815.034, "learn_throughput": 287.122, "update_time_ms": 35.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002003864385187626, "policy_loss": -0.0014809645945206285, "vf_loss": 0.003484829794615507, "vf_explained_var": 0.13089367747306824, "kl": 2.9774784593428194e-07, "entropy": 2.7478556632995605, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 84042, "num_agent_steps_sampled": 84042, "num_steps_trained": 84042, "num_agent_steps_trained": 84042}, "done": false, "episodes_total": 42, "training_iteration": 7, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-22-51", "timestamp": 1690838571, "time_this_iter_s": 93.82635617256165, "time_total_s": 641.4730026721954, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 641.4730026721954, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.97555555555554, "ram_util_percent": 62.95777777777777}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.917290319403397, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8411894058233061, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.7221792452385553, "reward_component_totals/delta_v_mean": -2.076100913580097, "reward_component_totals/delta_v_min": -2.1303150271375983, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61009135800893, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.03150271375895, "constraint_violation.max_vel_constraint.steps_mean": 1171.5833333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5854989172080626, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1613228440114356, "mean_inference_ms": 9.038368680184194, "mean_action_processing_ms": 0.4495313994229573, "mean_env_wait_ms": 10.943035141009773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 96048, "agent_timesteps_total": 96048, "timers": {"sample_time_ms": 49739.678, "sample_throughput": 241.377, "load_time_ms": 55.301, "load_throughput": 217102.255, "learn_time_ms": 41835.875, "learn_throughput": 286.979, "update_time_ms": 33.944}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0029089043382555246, "policy_loss": -0.0002951093774754554, "vf_loss": 0.003204013453796506, "vf_explained_var": 0.08768496662378311, "kl": 1.981563997333069e-07, "entropy": 2.782996416091919, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 96048, "num_agent_steps_sampled": 96048, "num_steps_trained": 96048, "num_agent_steps_trained": 96048}, "done": false, "episodes_total": 48, "training_iteration": 8, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-24-24", "timestamp": 1690838664, "time_this_iter_s": 92.85953879356384, "time_total_s": 734.3325414657593, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 734.3325414657593, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.97878787878787, "ram_util_percent": 62.93030303030302}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.9177807234894857, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840373112063108, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.7221792452385553, "reward_component_totals/delta_v_mean": -2.0774076114263837, "reward_component_totals/delta_v_min": -2.1303150271375983, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74076114263764, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.03150271375895, "constraint_violation.max_vel_constraint.steps_mean": 1147.111111111111, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.573268921095008, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.139910312149261, "mean_inference_ms": 9.094961144449355, "mean_action_processing_ms": 0.4515083759870741, "mean_env_wait_ms": 10.986736019262183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 108054, "agent_timesteps_total": 108054, "timers": {"sample_time_ms": 49385.58, "sample_throughput": 243.107, "load_time_ms": 49.731, "load_throughput": 241420.427, "learn_time_ms": 41986.004, "learn_throughput": 285.952, "update_time_ms": 32.521}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002814596751704812, "policy_loss": -0.0004910154384560883, "vf_loss": 0.0033056132961064577, "vf_explained_var": 0.06495288014411926, "kl": 8.2275090562689e-07, "entropy": 2.755622148513794, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 108054, "num_agent_steps_sampled": 108054, "num_steps_trained": 108054, "num_agent_steps_trained": 108054}, "done": false, "episodes_total": 54, "training_iteration": 9, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-25-54", "timestamp": 1690838754, "time_this_iter_s": 89.88510966300964, "time_total_s": 824.2176511287689, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 824.2176511287689, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 99.97131782945736, "ram_util_percent": 62.95116279069767}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7885983599649107, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.9221754039123122, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8424143452407072, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.7221792452385553, "reward_component_totals/delta_v_mean": -2.079761058671611, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9761058671603, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1128.3, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5638680659670163, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1215818173597154, "mean_inference_ms": 9.13777949215035, "mean_action_processing_ms": 0.4526884397560203, "mean_env_wait_ms": 11.016025704210424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 120060, "agent_timesteps_total": 120060, "timers": {"sample_time_ms": 49335.71, "sample_throughput": 243.353, "load_time_ms": 45.219, "load_throughput": 265505.388, "learn_time_ms": 42206.235, "learn_throughput": 284.46, "update_time_ms": 34.687}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0028131117578595877, "policy_loss": -0.00025867647491395473, "vf_loss": 0.0030717882327735424, "vf_explained_var": -0.008754244074225426, "kl": 4.0820470559310706e-08, "entropy": 2.8049404621124268, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 120060, "num_agent_steps_sampled": 120060, "num_steps_trained": 120060, "num_agent_steps_trained": 120060}, "done": false, "episodes_total": 60, "training_iteration": 10, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-27-28", "timestamp": 1690838848, "time_this_iter_s": 93.18554019927979, "time_total_s": 917.4031913280487, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 917.4031913280487, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.97368421052632, "ram_util_percent": 63.0}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.084495378186198, "episode_reward_mean": -3.9158738806706137, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8346083236265341, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0812655570440857, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.12655570440782, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1154.4545454545455, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5769388033256099, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1206150383458953, "mean_inference_ms": 9.16945252893841, "mean_action_processing_ms": 0.4535918913735852, "mean_env_wait_ms": 11.039253559920123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 132066, "agent_timesteps_total": 132066, "timers": {"sample_time_ms": 50319.769, "sample_throughput": 238.594, "load_time_ms": 6.383, "load_throughput": 1880950.763, "learn_time_ms": 42517.572, "learn_throughput": 282.377, "update_time_ms": 36.994}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031920529436320066, "policy_loss": -0.00010140328231500462, "vf_loss": 0.003293458605185151, "vf_explained_var": -0.0449679009616375, "kl": 1.6606758208581596e-06, "entropy": 2.7634353637695312, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 132066, "num_agent_steps_sampled": 132066, "num_steps_trained": 132066, "num_agent_steps_trained": 132066}, "done": false, "episodes_total": 66, "training_iteration": 11, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-29-13", "timestamp": 1690838953, "time_this_iter_s": 104.74015617370605, "time_total_s": 1022.1433475017548, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1022.1433475017548, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.97599999999998, "ram_util_percent": 63.0}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.0855647523861816, "episode_reward_mean": -3.9158070176975133, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8365736214855318, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.079233396211988, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.92333962119804, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1146.9583333333333, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.573192570381476, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1195714215776613, "mean_inference_ms": 9.20163432176473, "mean_action_processing_ms": 0.454396032802465, "mean_env_wait_ms": 11.06199578523636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 144072, "agent_timesteps_total": 144072, "timers": {"sample_time_ms": 50904.444, "sample_throughput": 235.854, "load_time_ms": 6.599, "load_throughput": 1819308.208, "learn_time_ms": 43099.457, "learn_throughput": 278.565, "update_time_ms": 33.558}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003483516862615943, "policy_loss": 0.00015624420484527946, "vf_loss": 0.0033272725995630026, "vf_explained_var": 0.05644766613841057, "kl": 1.5342913002314162e-06, "entropy": 2.708388090133667, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 144072, "num_agent_steps_sampled": 144072, "num_steps_trained": 144072, "num_agent_steps_trained": 144072}, "done": false, "episodes_total": 72, "training_iteration": 12, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-30-48", "timestamp": 1690839048, "time_this_iter_s": 94.75009775161743, "time_total_s": 1116.8934452533722, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1116.8934452533722, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.97910447761193, "ram_util_percent": 63.040298507462694}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.0855647523861816, "episode_reward_mean": -3.919929668473303, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8409183393289386, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0790113291443704, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90113291443632, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1161.0384615384614, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5802291162111253, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.117724776359086, "mean_inference_ms": 9.229212860008609, "mean_action_processing_ms": 0.45517912855837894, "mean_env_wait_ms": 11.082940243229451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 156078, "agent_timesteps_total": 156078, "timers": {"sample_time_ms": 51144.835, "sample_throughput": 234.745, "load_time_ms": 8.214, "load_throughput": 1461693.821, "learn_time_ms": 43091.341, "learn_throughput": 278.617, "update_time_ms": 34.755}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003310091095045209, "policy_loss": 0.0002307262911926955, "vf_loss": 0.003079364076256752, "vf_explained_var": -0.03778495639562607, "kl": 9.117622994381236e-07, "entropy": 2.693885564804077, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 156078, "num_agent_steps_sampled": 156078, "num_steps_trained": 156078, "num_agent_steps_trained": 156078}, "done": false, "episodes_total": 78, "training_iteration": 13, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-32-20", "timestamp": 1690839140, "time_this_iter_s": 92.1448483467102, "time_total_s": 1209.0382936000824, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1209.0382936000824, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 99.97651515151513, "ram_util_percent": 63.10000000000002}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.0855647523861816, "episode_reward_mean": -3.9158981130812185, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8369380583036587, "reward_component_totals/dist_change_reward_min": -0.9910339589415876, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.078960054777566, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89600547775586, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1152.5238095238096, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5759739178030033, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1157822756207674, "mean_inference_ms": 9.253701395005946, "mean_action_processing_ms": 0.45584244955639325, "mean_env_wait_ms": 11.101580517709221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 168084, "agent_timesteps_total": 168084, "timers": {"sample_time_ms": 51219.954, "sample_throughput": 234.401, "load_time_ms": 8.161, "load_throughput": 1471156.778, "learn_time_ms": 42977.47, "learn_throughput": 279.356, "update_time_ms": 33.687}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003926179837435484, "policy_loss": 0.000789279758464545, "vf_loss": 0.003136900719255209, "vf_explained_var": 0.01595371775329113, "kl": -1.7875384505927627e-09, "entropy": 2.8111586570739746, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 168084, "num_agent_steps_sampled": 168084, "num_steps_trained": 168084, "num_agent_steps_trained": 168084}, "done": false, "episodes_total": 84, "training_iteration": 14, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-33-52", "timestamp": 1690839232, "time_this_iter_s": 91.98333311080933, "time_total_s": 1301.0216267108917, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1301.0216267108917, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.98015267175572, "ram_util_percent": 63.100000000000016}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9165570566583074, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8379475251033986, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0786095315549145, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86095315549073, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1155.6444444444444, "constraint_violation.max_vel_constraint.steps_min": 403, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.577533455494475, "constraint_violation.max_vel_constraint.ratio_min": 0.2013993003498251, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.113176765435993, "mean_inference_ms": 9.274533098151124, "mean_action_processing_ms": 0.45637694415325086, "mean_env_wait_ms": 11.11734915589237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 180090, "agent_timesteps_total": 180090, "timers": {"sample_time_ms": 50658.104, "sample_throughput": 237.001, "load_time_ms": 8.007, "load_throughput": 1499509.08, "learn_time_ms": 43202.269, "learn_throughput": 277.902, "update_time_ms": 35.304}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023220391012728214, "policy_loss": -0.0005624518380500376, "vf_loss": 0.002884490881115198, "vf_explained_var": -0.01470228936523199, "kl": 2.3319866215842922e-07, "entropy": 2.7668910026550293, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 180090, "num_agent_steps_sampled": 180090, "num_steps_trained": 180090, "num_agent_steps_trained": 180090}, "done": false, "episodes_total": 90, "training_iteration": 15, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-35-26", "timestamp": 1690839326, "time_this_iter_s": 93.81734824180603, "time_total_s": 1394.8389749526978, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1394.8389749526978, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.97985074626865, "ram_util_percent": 63.10447761194031}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9142423730899263, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8358634713930612, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0783789016968712, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8378901696864, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1154.0625, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5767428785607197, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.801279160038309, -3.895120301604101, -3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1103101294303896, "mean_inference_ms": 9.291936714931644, "mean_action_processing_ms": 0.45697318707813767, "mean_env_wait_ms": 11.134048189105203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 192096, "agent_timesteps_total": 192096, "timers": {"sample_time_ms": 50717.206, "sample_throughput": 236.724, "load_time_ms": 8.265, "load_throughput": 1452695.383, "learn_time_ms": 43752.007, "learn_throughput": 274.41, "update_time_ms": 35.503}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999717180685e-10, "total_loss": 0.004160042852163315, "policy_loss": 0.0010177117073908448, "vf_loss": 0.00314233242534101, "vf_explained_var": 0.06585735827684402, "kl": 4.9443992793385405e-06, "entropy": 2.6943976879119873, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 192096, "num_agent_steps_sampled": 192096, "num_steps_trained": 192096, "num_agent_steps_trained": 192096}, "done": false, "episodes_total": 96, "training_iteration": 16, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-37-06", "timestamp": 1690839426, "time_this_iter_s": 98.78267908096313, "time_total_s": 1493.621654033661, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1493.621654033661, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.97676056338028, "ram_util_percent": 63.19999999999998}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.914854297412881, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8368354868386699, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.078018810574217, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.801881057421, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1146.54, "constraint_violation.max_vel_constraint.steps_min": 400, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.572983508245877, "constraint_violation.max_vel_constraint.ratio_min": 0.19990004997501248, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-3.8648782659831182, -3.8749385257013964, -3.8652429615581623, -3.906790602502561, -4.037530194473474, -3.984018503888759, -4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0420291332937177, "mean_inference_ms": 9.349067557674566, "mean_action_processing_ms": 0.4578377042095604, "mean_env_wait_ms": 11.166167672249253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 204102, "agent_timesteps_total": 204102, "timers": {"sample_time_ms": 50826.677, "sample_throughput": 236.215, "load_time_ms": 8.155, "load_throughput": 1472206.222, "learn_time_ms": 43966.771, "learn_throughput": 273.07, "update_time_ms": 38.868}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0021874222438782454, "policy_loss": -0.000543202564585954, "vf_loss": 0.002730621723458171, "vf_explained_var": 0.028770610690116882, "kl": 8.888622460290208e-08, "entropy": 2.771700620651245, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 204102, "num_agent_steps_sampled": 204102, "num_steps_trained": 204102, "num_agent_steps_trained": 204102}, "done": false, "episodes_total": 102, "training_iteration": 17, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-38-43", "timestamp": 1690839523, "time_this_iter_s": 97.23271799087524, "time_total_s": 1590.8543720245361, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1590.8543720245361, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.97266187050359, "ram_util_percent": 63.199999999999996}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.912747140365619, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8351117947928911, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0776353455727334, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76353455727266, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1136.84, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1968, "constraint_violation.max_vel_constraint.ratio_mean": 0.5681359320339829, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9835082458770614}, "hist_stats": {"episode_reward": [-4.0097609061928745, -3.919386397479208, -3.871245291019182, -3.8904408881402315, -3.9058917892988685, -4.041753657078203, -3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.029853332925224, "mean_inference_ms": 9.431065929233615, "mean_action_processing_ms": 0.4598763758346563, "mean_env_wait_ms": 11.240856081207276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 216108, "agent_timesteps_total": 216108, "timers": {"sample_time_ms": 51106.666, "sample_throughput": 234.92, "load_time_ms": 8.588, "load_throughput": 1398070.281, "learn_time_ms": 44410.992, "learn_throughput": 270.338, "update_time_ms": 43.26}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017981218406930566, "policy_loss": -0.0008768151747062802, "vf_loss": 0.002674937015399337, "vf_explained_var": 0.1699579358100891, "kl": 3.537698773925513e-07, "entropy": 2.7477850914001465, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 216108, "num_agent_steps_sampled": 216108, "num_steps_trained": 216108, "num_agent_steps_trained": 216108}, "done": false, "episodes_total": 108, "training_iteration": 18, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-40-24", "timestamp": 1690839624, "time_this_iter_s": 100.30863809585571, "time_total_s": 1691.1630101203918, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1691.1630101203918, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.96993006993006, "ram_util_percent": 63.19999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9166387167374324, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8382836587394331, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0783550579980057, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.027099255075062, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8355057997998, "delta_v_total_min": 202.70992550750523, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1126.17, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5628035982008995, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8910028768054437, -3.7885983599649107, -3.7948340880994893, -3.9796262188897593, -3.84570446937482, -3.9084745877142257, -3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.027303879945641, "mean_inference_ms": 9.492773726731247, "mean_action_processing_ms": 0.462366268732651, "mean_env_wait_ms": 11.30067344106083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 228114, "agent_timesteps_total": 228114, "timers": {"sample_time_ms": 51715.918, "sample_throughput": 232.153, "load_time_ms": 8.582, "load_throughput": 1398901.416, "learn_time_ms": 44485.09, "learn_throughput": 269.888, "update_time_ms": 42.176}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0037269226741045713, "policy_loss": 0.000768468133173883, "vf_loss": 0.002958455355837941, "vf_explained_var": 0.05716126412153244, "kl": 6.94671484779974e-07, "entropy": 2.759127616882324, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 228114, "num_agent_steps_sampled": 228114, "num_steps_trained": 228114, "num_agent_steps_trained": 228114}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-42-01", "timestamp": 1690839721, "time_this_iter_s": 96.66623139381409, "time_total_s": 1787.829241514206, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1787.829241514206, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.9735294117647, "ram_util_percent": 63.19999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9228941630479106, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8438935588857959, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.079000604162121, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90006041621135, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1115.67, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5575562218890554, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8853833002101377, -4.018657631176067, -3.8901849555803643, -3.940734859679636, -4.015090737463605, -3.8569026652941294, -4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.030069806529644, "mean_inference_ms": 9.535146110064636, "mean_action_processing_ms": 0.46452889303893774, "mean_env_wait_ms": 11.343810585977415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 240120, "agent_timesteps_total": 240120, "timers": {"sample_time_ms": 51879.214, "sample_throughput": 231.422, "load_time_ms": 8.818, "load_throughput": 1361502.772, "learn_time_ms": 44625.607, "learn_throughput": 269.038, "update_time_ms": 40.621}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023787126410752535, "policy_loss": -0.00030676668393425643, "vf_loss": 0.0026854807510972023, "vf_explained_var": 0.10155674815177917, "kl": 4.957465193911048e-07, "entropy": 2.749478816986084, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 240120, "num_agent_steps_sampled": 240120, "num_steps_trained": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 120, "training_iteration": 20, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-43-37", "timestamp": 1690839817, "time_this_iter_s": 96.33819699287415, "time_total_s": 1884.16743850708, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1884.16743850708, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.97391304347826, "ram_util_percent": 63.19999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9229563948493933, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442530089638399, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0787033858855604, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.87033858855528, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1118.01, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5587256371814093, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.084495378186198, -4.031586538536549, -3.8385013431187573, -3.8800470528774067, -3.951770236942461, -3.843551162393067, -3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0395429176641584, "mean_inference_ms": 9.560529089253748, "mean_action_processing_ms": 0.4666960675385637, "mean_env_wait_ms": 11.37839205028336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 252126, "agent_timesteps_total": 252126, "timers": {"sample_time_ms": 52361.996, "sample_throughput": 229.288, "load_time_ms": 9.441, "load_throughput": 1271739.48, "learn_time_ms": 44594.768, "learn_throughput": 269.224, "update_time_ms": 42.301}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0008776066242717206, "policy_loss": -0.001734827528707683, "vf_loss": 0.002612432697787881, "vf_explained_var": 0.2149791121482849, "kl": 2.235246711279615e-06, "entropy": 2.731937885284424, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 252126, "num_agent_steps_sampled": 252126, "num_steps_trained": 252126, "num_agent_steps_trained": 252126}, "done": false, "episodes_total": 126, "training_iteration": 21, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-45-27", "timestamp": 1690839927, "time_this_iter_s": 109.37693619728088, "time_total_s": 1993.544374704361, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1993.544374704361, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.97051282051282, "ram_util_percent": 63.234615384615395}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.92332642223639, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453420932889278, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0779843289474687, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79843289474607, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1121.06, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5602498750624687, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.893492730857799, -3.805131249959317, -3.8647089837469073, -3.839000970747182, -3.9913219932284854, -3.8544307704629617, -3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.047444157256211, "mean_inference_ms": 9.571549813896024, "mean_action_processing_ms": 0.46819150867052783, "mean_env_wait_ms": 11.400726275687482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 264132, "agent_timesteps_total": 264132, "timers": {"sample_time_ms": 52081.478, "sample_throughput": 230.523, "load_time_ms": 9.353, "load_throughput": 1283679.31, "learn_time_ms": 44672.81, "learn_throughput": 268.754, "update_time_ms": 43.661}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0034837359562516212, "policy_loss": 0.0007198082748800516, "vf_loss": 0.002763929544016719, "vf_explained_var": 0.07959026843309402, "kl": 7.783052780041544e-08, "entropy": 2.780308246612549, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 264132, "num_agent_steps_sampled": 264132, "num_steps_trained": 264132, "num_agent_steps_trained": 264132}, "done": false, "episodes_total": 132, "training_iteration": 22, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-47-00", "timestamp": 1690840020, "time_this_iter_s": 92.81832599639893, "time_total_s": 2086.36270070076, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2086.36270070076, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.97443609022555, "ram_util_percent": 63.10000000000002}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9294590572482617, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8514794196646696, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0779796375835975, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.797963758359, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1103.04, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5512443778110945, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.851261215591055, -3.989101073730926, -3.939123396142201, -4.028729034666259, -3.940292052960925, -3.8794438422592665, -3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0548560858315175, "mean_inference_ms": 9.579305518518993, "mean_action_processing_ms": 0.46826657463392146, "mean_env_wait_ms": 11.417452168611694, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 276138, "agent_timesteps_total": 276138, "timers": {"sample_time_ms": 51977.251, "sample_throughput": 230.986, "load_time_ms": 7.803, "load_throughput": 1538655.633, "learn_time_ms": 44983.36, "learn_throughput": 266.899, "update_time_ms": 44.479}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001448159571737051, "policy_loss": -0.0013182840775698423, "vf_loss": 0.002766446443274617, "vf_explained_var": 0.03666994720697403, "kl": 1.934096616196257e-07, "entropy": 2.771077871322632, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 276138, "num_agent_steps_sampled": 276138, "num_steps_trained": 276138, "num_agent_steps_trained": 276138}, "done": false, "episodes_total": 138, "training_iteration": 23, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-48-34", "timestamp": 1690840114, "time_this_iter_s": 94.19963574409485, "time_total_s": 2180.5623364448547, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2180.5623364448547, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.97985074626865, "ram_util_percent": 63.10000000000002}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.931689076817664, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8527348013983516, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.078954275419318, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8954275419311, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1086.33, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5428935532233882, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.911790888524048, -3.860158749129578, -4.05094815787295, -4.017576314217699, -3.8696433218567883, -3.89339494791738, -3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0629467091141067, "mean_inference_ms": 9.585007307667553, "mean_action_processing_ms": 0.46849368836748356, "mean_env_wait_ms": 11.433803535046916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 288144, "agent_timesteps_total": 288144, "timers": {"sample_time_ms": 51947.922, "sample_throughput": 231.116, "load_time_ms": 7.846, "load_throughput": 1530281.303, "learn_time_ms": 44989.897, "learn_throughput": 266.86, "update_time_ms": 43.906}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031524915248155594, "policy_loss": 0.0002477034577168524, "vf_loss": 0.0029047869611531496, "vf_explained_var": 0.022012244910001755, "kl": 2.846242068699212e-07, "entropy": 2.790149211883545, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 288144, "num_agent_steps_sampled": 288144, "num_steps_trained": 288144, "num_agent_steps_trained": 288144}, "done": false, "episodes_total": 144, "training_iteration": 24, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-50-06", "timestamp": 1690840206, "time_this_iter_s": 91.83036160469055, "time_total_s": 2272.3926980495453, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2272.3926980495453, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.97348484848484, "ram_util_percent": 63.15757575757575}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9296183070390276, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8519877922484155, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.077630514790618, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76305147906103, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1079.72, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5395902048975513, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.896066213696064, -3.9574359998479887, -3.9815650859512806, -3.9321181677996773, -3.794052294115078, -3.999113236277279, -3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.070670656566121, "mean_inference_ms": 9.589013721610499, "mean_action_processing_ms": 0.46880416628937105, "mean_env_wait_ms": 11.448745111770231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 300150, "agent_timesteps_total": 300150, "timers": {"sample_time_ms": 52043.582, "sample_throughput": 230.691, "load_time_ms": 8.697, "load_throughput": 1380478.368, "learn_time_ms": 44289.873, "learn_throughput": 271.078, "update_time_ms": 43.579}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002674487652257085, "policy_loss": 0.0001934846950462088, "vf_loss": 0.00248100608587265, "vf_explained_var": 0.25386670231819153, "kl": 2.9407335659925593e-06, "entropy": 2.7383577823638916, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 300150, "num_agent_steps_sampled": 300150, "num_steps_trained": 300150, "num_agent_steps_trained": 300150}, "done": false, "episodes_total": 150, "training_iteration": 25, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-51-34", "timestamp": 1690840294, "time_this_iter_s": 87.85932683944702, "time_total_s": 2360.2520248889923, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2360.2520248889923, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 99.97500000000001, "ram_util_percent": 59.44274193548385}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9281282868470386, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8503231154045119, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.077805171442532, "reward_component_totals/delta_v_min": -2.135808964620038, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7805171442524, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 213.58089646200295, "constraint_violation.max_vel_constraint.steps_mean": 1074.63, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5370464767616192, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9005265683494943, -4.01006467721333, -4.031013707829411, -4.035594682521905, -3.943777876847892, -3.9863830272020646, -3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0777746433625373, "mean_inference_ms": 9.590282514122974, "mean_action_processing_ms": 0.4689317685229174, "mean_env_wait_ms": 11.460974580433435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 312156, "agent_timesteps_total": 312156, "timers": {"sample_time_ms": 51131.796, "sample_throughput": 234.805, "load_time_ms": 8.416, "load_throughput": 1426542.676, "learn_time_ms": 43011.251, "learn_throughput": 279.136, "update_time_ms": 42.328}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0022589864674955606, "policy_loss": -0.0005442331312224269, "vf_loss": 0.002803219249472022, "vf_explained_var": 0.14593146741390228, "kl": 9.566335279487248e-08, "entropy": 2.7857091426849365, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 312156, "num_agent_steps_sampled": 312156, "num_steps_trained": 312156, "num_agent_steps_trained": 312156}, "done": false, "episodes_total": 156, "training_iteration": 26, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-52-52", "timestamp": 1690840372, "time_this_iter_s": 76.89052987098694, "time_total_s": 2437.1425547599792, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2437.1425547599792, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.98288288288288, "ram_util_percent": 55.43243243243244}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.3782280015896142, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9238025650175707, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8465151599036967, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": -0.301073122019611, "reward_component_totals/delta_v_mean": -2.0772874051138794, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72874051138723, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1102.1, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.550800584670071, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9350727988695917, -3.847454697755399, -4.02623548725723, -3.3782280015896142, -3.9124716944201188, -3.967529027709258, -3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0748831707196804, "mean_inference_ms": 9.592845243487789, "mean_action_processing_ms": 0.469227509537216, "mean_env_wait_ms": 11.473779928662461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 324156, "agent_timesteps_total": 324156, "timers": {"sample_time_ms": 50264.381, "sample_throughput": 238.845, "load_time_ms": 8.51, "load_throughput": 1410816.473, "learn_time_ms": 42075.263, "learn_throughput": 285.332, "update_time_ms": 36.78}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003148874966427684, "policy_loss": 0.0005202969769015908, "vf_loss": 0.002628576708957553, "vf_explained_var": 0.5244821310043335, "kl": 3.109285444224952e-06, "entropy": 2.6774086952209473, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 324156, "num_agent_steps_sampled": 324156, "num_steps_trained": 324156, "num_agent_steps_trained": 324156}, "done": false, "episodes_total": 162, "training_iteration": 27, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-54-11", "timestamp": 1690840451, "time_this_iter_s": 79.14823269844055, "time_total_s": 2516.29078745842, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2516.29078745842, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.97964601769911, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9196554614725216, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8422037784469653, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.0774516830255623, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.0282495649655727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74516830255547, "delta_v_total_min": 202.82495649655613, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1078.52, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.539016476724044, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.787728512105046, -4.0855647523861816, -3.9614799538020637, -3.7756552095377653, -3.8552702484886194, -4.036284545854993, -3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.071480032664356, "mean_inference_ms": 9.589560192373385, "mean_action_processing_ms": 0.46923704186470333, "mean_env_wait_ms": 11.480427887721152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 336162, "agent_timesteps_total": 336162, "timers": {"sample_time_ms": 48862.811, "sample_throughput": 245.696, "load_time_ms": 8.192, "load_throughput": 1465415.003, "learn_time_ms": 41284.144, "learn_throughput": 290.799, "update_time_ms": 31.807}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0038643034640699625, "policy_loss": 0.0006870940560474992, "vf_loss": 0.003177206264808774, "vf_explained_var": 0.1941690593957901, "kl": 1.257610904303874e-07, "entropy": 2.7645130157470703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 336162, "num_agent_steps_sampled": 336162, "num_steps_trained": 336162, "num_agent_steps_trained": 336162}, "done": false, "episodes_total": 168, "training_iteration": 28, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-55-30", "timestamp": 1690840530, "time_this_iter_s": 78.22847414016724, "time_total_s": 2594.519261598587, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2594.519261598587, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.98125000000002, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.917537148040072, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8388618395001066, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.07867530853997, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.0319169562558383, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86753085399624, "delta_v_total_min": 203.19169562558287, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1083.94, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5417251224012054, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9918862963721615, -3.9204598334516056, -4.06171152577557, -3.950796416753709, -3.8535289943514996, -3.8476112176235744, -3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0676150081577824, "mean_inference_ms": 9.580208354758854, "mean_action_processing_ms": 0.4690897558449039, "mean_env_wait_ms": 11.48150105176991, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 348168, "agent_timesteps_total": 348168, "timers": {"sample_time_ms": 47805.388, "sample_throughput": 251.131, "load_time_ms": 8.427, "load_throughput": 1424639.124, "learn_time_ms": 40458.886, "learn_throughput": 296.731, "update_time_ms": 33.866}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003158220089972019, "policy_loss": 0.0006498866132460535, "vf_loss": 0.002508331323042512, "vf_explained_var": 0.3440002202987671, "kl": 1.5423678405568353e-06, "entropy": 2.7483932971954346, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 348168, "num_agent_steps_sampled": 348168, "num_steps_trained": 348168, "num_agent_steps_trained": 348168}, "done": false, "episodes_total": 174, "training_iteration": 29, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-56-48", "timestamp": 1690840608, "time_this_iter_s": 77.91628932952881, "time_total_s": 2672.435550928116, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2672.435550928116, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.98392857142858, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.08916428509893, "episode_reward_mean": -3.9182885118101582, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8398536198108956, "reward_component_totals/dist_change_reward_min": -0.9997473658973113, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.078434891999268, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.0319169562558383, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.843489199926, "delta_v_total_min": 203.19169562558287, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1068.08, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5337990854196961, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.9049163884987674, -3.8255268451675795, -3.8066400248481536, -3.942703887415183, -4.08916428509893, -3.8838669868242603, -3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.063417647912677, "mean_inference_ms": 9.567414216165897, "mean_action_processing_ms": 0.468741033765298, "mean_env_wait_ms": 11.477781027559272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 360174, "agent_timesteps_total": 360174, "timers": {"sample_time_ms": 46662.01, "sample_throughput": 257.284, "load_time_ms": 8.291, "load_throughput": 1448048.601, "learn_time_ms": 39302.442, "learn_throughput": 305.462, "update_time_ms": 32.636}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 9.999999717180685e-10, "total_loss": 0.00358519796282053, "policy_loss": 0.001029851962812245, "vf_loss": 0.0025553470477461815, "vf_explained_var": 0.30884531140327454, "kl": 4.5516637214859657e-07, "entropy": 2.731984853744507, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 360174, "num_agent_steps_sampled": 360174, "num_steps_trained": 360174, "num_agent_steps_trained": 360174}, "done": false, "episodes_total": 180, "training_iteration": 30, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-58-02", "timestamp": 1690840682, "time_this_iter_s": 73.25172233581543, "time_total_s": 2745.6872732639313, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2745.6872732639313, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 99.9817307692308, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9164268526275943, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8387438963800684, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.077682956247532, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.0319169562558383, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7682956247524, "delta_v_total_min": 203.19169562558287, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1096.69, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5480969364941588, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8445639841151493, -3.8408281659681553, -3.9717386790043285, -3.9245314994144627, -3.8503926846267076, -3.923637281235334, -3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0615258303709836, "mean_inference_ms": 9.551503556037039, "mean_action_processing_ms": 0.46833253598558017, "mean_env_wait_ms": 11.471644688959714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 372180, "agent_timesteps_total": 372180, "timers": {"sample_time_ms": 45048.528, "sample_throughput": 266.499, "load_time_ms": 7.385, "load_throughput": 1625553.956, "learn_time_ms": 38830.221, "learn_throughput": 309.177, "update_time_ms": 29.829}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031665514688938856, "policy_loss": 0.0006394623196683824, "vf_loss": 0.002527087926864624, "vf_explained_var": 0.37521761655807495, "kl": 3.614407830809796e-07, "entropy": 2.7545032501220703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 372180, "num_agent_steps_sampled": 372180, "num_steps_trained": 372180, "num_agent_steps_trained": 372180}, "done": false, "episodes_total": 186, "training_iteration": 31, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_14-59-30", "timestamp": 1690840770, "time_this_iter_s": 88.44269490242004, "time_total_s": 2834.1299681663513, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2834.1299681663513, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.98110236220472, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.916574929252286, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840086436314405, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.076488492937886, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64884929378786, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1079.78, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5396461618814653, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.8004384082192453, -3.791997441366319, -4.045914191137728, -3.864752710799923, -4.061079720856396, -3.8024453213099125, -3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0594011599472157, "mean_inference_ms": 9.532851694958174, "mean_action_processing_ms": 0.4678483194941823, "mean_env_wait_ms": 11.461406445735529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 384186, "agent_timesteps_total": 384186, "timers": {"sample_time_ms": 44309.529, "sample_throughput": 270.944, "load_time_ms": 7.256, "load_throughput": 1654595.25, "learn_time_ms": 38401.942, "learn_throughput": 312.625, "update_time_ms": 29.131}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014232046669349074, "policy_loss": -0.0009997377637773752, "vf_loss": 0.0024229425471276045, "vf_explained_var": 0.2650969624519348, "kl": 3.0963471431277867e-07, "entropy": 2.7423558235168457, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 384186, "num_agent_steps_sampled": 384186, "num_steps_trained": 384186, "num_agent_steps_trained": 384186}, "done": false, "episodes_total": 192, "training_iteration": 32, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-00-52", "timestamp": 1690840852, "time_this_iter_s": 81.14363265037537, "time_total_s": 2915.2736008167267, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2915.2736008167267, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.97982456140352, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9169606159017025, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8409997292966201, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.075960886605088, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.596088660508, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1086.15, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5428295701773174, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.782741603778578, -3.8636956649283336, -4.037683879533613, -3.8669151958907872, -3.9759445271246205, -3.942898492129678, -3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0569182460932964, "mean_inference_ms": 9.512156690114045, "mean_action_processing_ms": 0.4671296175153777, "mean_env_wait_ms": 11.445294120704354, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 396192, "agent_timesteps_total": 396192, "timers": {"sample_time_ms": 43358.878, "sample_throughput": 276.884, "load_time_ms": 7.256, "load_throughput": 1654600.687, "learn_time_ms": 37642.243, "learn_throughput": 318.934, "update_time_ms": 28.689}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003112462582066655, "policy_loss": 0.000390821136534214, "vf_loss": 0.0027216426096856594, "vf_explained_var": 0.2977507710456848, "kl": 4.338911594459205e-07, "entropy": 2.7226948738098145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 396192, "num_agent_steps_sampled": 396192, "num_steps_trained": 396192, "num_agent_steps_trained": 396192}, "done": false, "episodes_total": 198, "training_iteration": 33, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-02-09", "timestamp": 1690840929, "time_this_iter_s": 77.06479835510254, "time_total_s": 2992.338399171829, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2992.338399171829, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.9772727272727, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9155271402456653, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8402078004209512, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.075319339824719, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53193398247123, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1084.12, "constraint_violation.max_vel_constraint.steps_min": 352, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5418150774236942, "constraint_violation.max_vel_constraint.ratio_min": 0.175912043978011, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-3.909511683841659, -3.8349169768395015, -3.814870019863051, -3.8445416495826885, -4.000064991222508, -3.989224889046088, -4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053611629464703, "mean_inference_ms": 9.487007817356504, "mean_action_processing_ms": 0.46618860348785746, "mean_env_wait_ms": 11.422567995242543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 408198, "agent_timesteps_total": 408198, "timers": {"sample_time_ms": 42428.208, "sample_throughput": 282.958, "load_time_ms": 8.38, "load_throughput": 1432619.899, "learn_time_ms": 37145.046, "learn_throughput": 323.203, "update_time_ms": 31.768}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0024320855736732483, "policy_loss": 1.6374493498005904e-05, "vf_loss": 0.0024157112929970026, "vf_explained_var": 0.3636454641819, "kl": 1.8215667978438432e-06, "entropy": 2.7000815868377686, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 408198, "num_agent_steps_sampled": 408198, "num_steps_trained": 408198, "num_agent_steps_trained": 408198}, "done": false, "episodes_total": 204, "training_iteration": 34, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-03-27", "timestamp": 1690841007, "time_this_iter_s": 77.60306572914124, "time_total_s": 3069.9414649009705, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3069.9414649009705, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.97837837837837, "ram_util_percent": 55.300000000000004}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.91530312229634, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8404975108851098, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.074805611411237, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48056114112296, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1103.95, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1980, "constraint_violation.max_vel_constraint.ratio_mean": 0.5517251224012054, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9895052473763118}, "hist_stats": {"episode_reward": [-4.052513455431138, -3.933544442268502, -4.003807307287936, -4.048481481133762, -4.019371944875737, -3.879815957886172, -4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.049903664900993, "mean_inference_ms": 9.45712185592048, "mean_action_processing_ms": 0.4650852790117431, "mean_env_wait_ms": 11.394886704086948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 420204, "agent_timesteps_total": 420204, "timers": {"sample_time_ms": 41640.661, "sample_throughput": 288.31, "load_time_ms": 7.596, "load_throughput": 1580590.599, "learn_time_ms": 36752.096, "learn_throughput": 326.659, "update_time_ms": 30.207}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0019273770740255713, "policy_loss": -0.0006677341880276799, "vf_loss": 0.0025951103307306767, "vf_explained_var": 0.3280734121799469, "kl": 5.756625114372582e-07, "entropy": 2.770982265472412, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 420204, "num_agent_steps_sampled": 420204, "num_steps_trained": 420204, "num_agent_steps_trained": 420204}, "done": false, "episodes_total": 210, "training_iteration": 35, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-04-43", "timestamp": 1690841083, "time_this_iter_s": 76.00120115280151, "time_total_s": 3145.942666053772, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3145.942666053772, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.97981651376146, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9127638824339863, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.838690278398611, "reward_component_totals/dist_change_reward_min": -0.996887060670095, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.074073604035381, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.40736040353738, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1081.32, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5404157770738691, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-4.005269465481018, -4.082228404251771, -3.826419033070956, -4.020680426330813, -4.031440508078072, -4.061206011376829, -3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0459868911982864, "mean_inference_ms": 9.423685743979574, "mean_action_processing_ms": 0.46372188326084685, "mean_env_wait_ms": 11.362116322002604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 432210, "agent_timesteps_total": 432210, "timers": {"sample_time_ms": 41710.664, "sample_throughput": 287.826, "load_time_ms": 7.592, "load_throughput": 1581265.634, "learn_time_ms": 37008.18, "learn_throughput": 324.399, "update_time_ms": 31.048}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030875972006469965, "policy_loss": 0.00043923791963607073, "vf_loss": 0.002648359863087535, "vf_explained_var": 0.2655750513076782, "kl": 1.2728851288557053e-06, "entropy": 2.7603986263275146, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 432210, "num_agent_steps_sampled": 432210, "num_steps_trained": 432210, "num_agent_steps_trained": 432210}, "done": false, "episodes_total": 216, "training_iteration": 36, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-06-03", "timestamp": 1690841163, "time_this_iter_s": 80.12821102142334, "time_total_s": 3226.0708770751953, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3226.0708770751953, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.98070175438598, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9079600227217703, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8335821671690392, "reward_component_totals/dist_change_reward_min": -0.9968466991549864, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.0743778555527363, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43778555527294, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1076.28, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.537897036444184, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.866881978667553, -3.867933012974782, -3.8854490189992332, -3.900266799455805, -4.059684579264257, -3.984063327845469, -3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0367504375947014, "mean_inference_ms": 9.390172938534839, "mean_action_processing_ms": 0.46209466326473836, "mean_env_wait_ms": 11.323008741795919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 444216, "agent_timesteps_total": 444216, "timers": {"sample_time_ms": 41628.845, "sample_throughput": 288.406, "load_time_ms": 7.341, "load_throughput": 1635455.31, "learn_time_ms": 36911.459, "learn_throughput": 325.265, "update_time_ms": 33.963}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014907356817275286, "policy_loss": -0.000917511060833931, "vf_loss": 0.002408248372375965, "vf_explained_var": 0.3398769795894623, "kl": 1.3752780887443805e-06, "entropy": 2.744385242462158, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 444216, "num_agent_steps_sampled": 444216, "num_steps_trained": 444216, "num_agent_steps_trained": 444216}, "done": false, "episodes_total": 222, "training_iteration": 37, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-07-21", "timestamp": 1690841241, "time_this_iter_s": 77.33143424987793, "time_total_s": 3303.4023113250732, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3303.4023113250732, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.97567567567567, "ram_util_percent": 55.306306306306276}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.087145339654033, "episode_reward_mean": -3.9056660917804162, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8309195422674759, "reward_component_totals/dist_change_reward_min": -0.9968466991549864, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.074746549512946, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.47465495129393, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1073.59, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.536552708608102, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.900923786113577, -3.798695315094485, -4.024262031752059, -3.8993254106842583, -3.951460755425768, -4.087145339654033, -3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.027723535067789, "mean_inference_ms": 9.355140566632723, "mean_action_processing_ms": 0.4604506850144609, "mean_env_wait_ms": 11.2811684745511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 456222, "agent_timesteps_total": 456222, "timers": {"sample_time_ms": 41753.655, "sample_throughput": 287.544, "load_time_ms": 7.363, "load_throughput": 1630482.953, "learn_time_ms": 36756.16, "learn_throughput": 326.639, "update_time_ms": 34.171}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017796516185626388, "policy_loss": -0.0008290301193483174, "vf_loss": 0.0026086843572556973, "vf_explained_var": 0.25717493891716003, "kl": 3.523103089264623e-07, "entropy": 2.7676568031311035, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 456222, "num_agent_steps_sampled": 456222, "num_steps_trained": 456222, "num_agent_steps_trained": 456222}, "done": false, "episodes_total": 228, "training_iteration": 38, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-08-39", "timestamp": 1690841319, "time_this_iter_s": 77.89722943305969, "time_total_s": 3381.299540758133, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3381.299540758133, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.98198198198196, "ram_util_percent": 55.36486486486486}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9058122894083125, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8304420550783165, "reward_component_totals/dist_change_reward_min": -0.9968466991549864, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.0753702343300016, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5370234329995, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1081.63, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1944, "constraint_violation.max_vel_constraint.ratio_mean": 0.5405706996125997, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9715142428785607}, "hist_stats": {"episode_reward": [-3.974195577731164, -3.9163808411557115, -4.061017998981842, -3.871149687241229, -4.019272996184085, -4.02386422600378, -4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0187777090408434, "mean_inference_ms": 9.318434599656404, "mean_action_processing_ms": 0.45868202891294196, "mean_env_wait_ms": 11.236880738443656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 468228, "agent_timesteps_total": 468228, "timers": {"sample_time_ms": 41635.658, "sample_throughput": 288.359, "load_time_ms": 7.15, "load_throughput": 1679052.983, "learn_time_ms": 36847.835, "learn_throughput": 325.826, "update_time_ms": 34.107}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0010191986802965403, "policy_loss": -0.0014716386795043945, "vf_loss": 0.0024908354971557856, "vf_explained_var": 0.47314897179603577, "kl": 1.8457911892255652e-06, "entropy": 2.704073905944824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 468228, "num_agent_steps_sampled": 468228, "num_steps_trained": 468228, "num_agent_steps_trained": 468228}, "done": false, "episodes_total": 234, "training_iteration": 39, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-09-57", "timestamp": 1690841397, "time_this_iter_s": 77.678879737854, "time_total_s": 3458.978420495987, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3458.978420495987, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.98198198198199, "ram_util_percent": 55.363063063063066}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9074238706132083, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8314782344341615, "reward_component_totals/dist_change_reward_min": -0.9968466991549864, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.0759456361790534, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59456361790456, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1105.32, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5524097800723697, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.019185324172279, -3.8285726111031453, -4.057530911203839, -3.902526503623802, -3.9356208668079864, -3.8836180650235486, -3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.009734735760146, "mean_inference_ms": 9.281265360632348, "mean_action_processing_ms": 0.4568655335931114, "mean_env_wait_ms": 11.190146886395603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 480234, "agent_timesteps_total": 480234, "timers": {"sample_time_ms": 41773.572, "sample_throughput": 287.407, "load_time_ms": 7.076, "load_throughput": 1696635.282, "learn_time_ms": 36925.357, "learn_throughput": 325.142, "update_time_ms": 34.277}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0026922726538032293, "policy_loss": -4.753245957545005e-05, "vf_loss": 0.0027398052625358105, "vf_explained_var": 0.41693639755249023, "kl": 5.211901452639722e-07, "entropy": 2.758183240890503, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 480234, "num_agent_steps_sampled": 480234, "num_steps_trained": 480234, "num_agent_steps_trained": 480234}, "done": false, "episodes_total": 240, "training_iteration": 40, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-11-12", "timestamp": 1690841472, "time_this_iter_s": 75.3893780708313, "time_total_s": 3534.3677985668182, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3534.3677985668182, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.97943925233646, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.910373407781299, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8335674898904345, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.07680591789087, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6805917890863, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1116.01, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5577521089079521, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.905689572926006, -3.8397275103058166, -4.012274140887334, -3.819505245704118, -3.94890570484844, -4.054764517416041, -3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.002703939122797, "mean_inference_ms": 9.241011595596962, "mean_action_processing_ms": 0.45505077888316414, "mean_env_wait_ms": 11.141019493482403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 492240, "agent_timesteps_total": 492240, "timers": {"sample_time_ms": 41790.544, "sample_throughput": 287.29, "load_time_ms": 7.431, "load_throughput": 1615766.393, "learn_time_ms": 36973.496, "learn_throughput": 324.719, "update_time_ms": 32.352}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0024202135391533375, "policy_loss": -0.0003876724513247609, "vf_loss": 0.002807882847264409, "vf_explained_var": 0.13509806990623474, "kl": 5.083844598630094e-07, "entropy": 2.7879648208618164, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 492240, "num_agent_steps_sampled": 492240, "num_steps_trained": 492240, "num_agent_steps_trained": 492240}, "done": false, "episodes_total": 246, "training_iteration": 41, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-12-42", "timestamp": 1690841562, "time_this_iter_s": 89.05464029312134, "time_total_s": 3623.4224388599396, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3623.4224388599396, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.98110236220474, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.912731637341298, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8352883093625502, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.077443327978754, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.74433279787462, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1108.73, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5541139279984069, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.6726911105866176, -3.8371473365569053, -3.8281481908868895, -4.069692118193553, -3.938553621636057, -3.8397824819384994, -3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9957960086067512, "mean_inference_ms": 9.200242605483012, "mean_action_processing_ms": 0.4532930414773943, "mean_env_wait_ms": 11.091949174316307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 504246, "agent_timesteps_total": 504246, "timers": {"sample_time_ms": 41548.844, "sample_throughput": 288.961, "load_time_ms": 8.145, "load_throughput": 1474011.838, "learn_time_ms": 36568.03, "learn_throughput": 328.32, "update_time_ms": 30.284}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0016031304839998484, "policy_loss": -0.000982095254585147, "vf_loss": 0.002585223177447915, "vf_explained_var": 0.4682769477367401, "kl": 2.7773592137236847e-06, "entropy": 2.7435100078582764, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 504246, "num_agent_steps_sampled": 504246, "num_steps_trained": 504246, "num_agent_steps_trained": 504246}, "done": false, "episodes_total": 252, "training_iteration": 42, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-13-56", "timestamp": 1690841636, "time_this_iter_s": 74.61189937591553, "time_total_s": 3698.034338235855, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3698.034338235855, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.98584905660377, "ram_util_percent": 55.346226415094335}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9149884796505607, "episode_len_mean": 2000.94, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8379215683753753, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.077066911275191, "reward_component_totals/delta_v_min": -2.201836251864822, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.70669112751847, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 220.18362518648198, "constraint_violation.max_vel_constraint.steps_mean": 1100.21, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.549856056933939, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9795763515954583, -3.972345259195553, -3.7627675097484, -3.981763132903295, -3.946426315760119, -3.9302195571712613, -3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394], "episode_lengths": [2001, 1995, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9891641532936768, "mean_inference_ms": 9.161617460309156, "mean_action_processing_ms": 0.4516078907478754, "mean_env_wait_ms": 11.04491949366557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 516252, "agent_timesteps_total": 516252, "timers": {"sample_time_ms": 41539.091, "sample_throughput": 289.029, "load_time_ms": 8.159, "load_throughput": 1471509.293, "learn_time_ms": 36588.942, "learn_throughput": 328.132, "update_time_ms": 31.117}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0009557611192576587, "policy_loss": -0.0016632112674415112, "vf_loss": 0.002618972444906831, "vf_explained_var": 0.11272253841161728, "kl": 1.9701478493061586e-07, "entropy": 2.7709550857543945, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 516252, "num_agent_steps_sampled": 516252, "num_steps_trained": 516252, "num_agent_steps_trained": 516252}, "done": false, "episodes_total": 258, "training_iteration": 43, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-15-14", "timestamp": 1690841714, "time_this_iter_s": 77.2592191696167, "time_total_s": 3775.293557405472, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3775.293557405472, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.98018018018017, "ram_util_percent": 55.32882882882884}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.06351722988922, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9162191659975707, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8401305890524072, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": 0.04318217547298964, "reward_component_totals/delta_v_mean": -2.0760885769451694, "reward_component_totals/delta_v_min": -2.138184456676247, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6088576945162, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 213.8184456676237, "constraint_violation.max_vel_constraint.steps_mean": 1076.58, "constraint_violation.max_vel_constraint.steps_min": 361, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5380209895052473, "constraint_violation.max_vel_constraint.ratio_min": 0.18040979510244878, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.847148977003004, -3.06351722988922, -3.939558970635087, -3.9254103026376814, -3.9042027859518535, -3.7897307190358838, -3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9829386346174982, "mean_inference_ms": 9.125426918344015, "mean_action_processing_ms": 0.4499807819040449, "mean_env_wait_ms": 10.99932458294604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 528258, "agent_timesteps_total": 528258, "timers": {"sample_time_ms": 41431.029, "sample_throughput": 289.783, "load_time_ms": 7.108, "load_throughput": 1689021.132, "learn_time_ms": 36630.145, "learn_throughput": 327.763, "update_time_ms": 29.513}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0036678730975836515, "policy_loss": 0.0008885273127816617, "vf_loss": 0.002779345028102398, "vf_explained_var": 0.1299665868282318, "kl": 2.272026478067346e-07, "entropy": 2.783113479614258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 528258, "num_agent_steps_sampled": 528258, "num_steps_trained": 528258, "num_agent_steps_trained": 528258}, "done": false, "episodes_total": 264, "training_iteration": 44, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-16-31", "timestamp": 1690841791, "time_this_iter_s": 76.84736680984497, "time_total_s": 3852.1409242153168, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3852.1409242153168, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.98272727272727, "ram_util_percent": 55.377272727272725}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7624400317945312, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.927054099976242, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8512176489330561, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.075836451043192, "reward_component_totals/delta_v_min": -2.138184456676247, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5836451043185, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 213.8184456676237, "constraint_violation.max_vel_constraint.steps_mean": 1075.2, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5373313343328335, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9806363821694872, -3.8278714717219415, -3.90831565738182, -3.8793948626686117, -3.844482792629359, -4.026110604309162, -4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9769636955440324, "mean_inference_ms": 9.092261546586037, "mean_action_processing_ms": 0.448425416661855, "mean_env_wait_ms": 10.954742111130804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 540264, "agent_timesteps_total": 540264, "timers": {"sample_time_ms": 41529.935, "sample_throughput": 289.093, "load_time_ms": 7.274, "load_throughput": 1650442.423, "learn_time_ms": 36658.508, "learn_throughput": 327.509, "update_time_ms": 31.529}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0016595873748883605, "policy_loss": -0.0007247805478982627, "vf_loss": 0.0023843669332563877, "vf_explained_var": 0.3380901515483856, "kl": 6.494047397609393e-07, "entropy": 2.7495524883270264, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 540264, "num_agent_steps_sampled": 540264, "num_steps_trained": 540264, "num_agent_steps_trained": 540264}, "done": false, "episodes_total": 270, "training_iteration": 45, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-17-48", "timestamp": 1690841868, "time_this_iter_s": 77.29544711112976, "time_total_s": 3929.4363713264465, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3929.4363713264465, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.98636363636363, "ram_util_percent": 55.3181818181818}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7624400317945312, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.923543591133805, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8486693210622214, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.074874270071589, "reward_component_totals/delta_v_min": -2.138184456676247, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48742700715823, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 213.8184456676237, "constraint_violation.max_vel_constraint.steps_mean": 1060.01, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5297401299350325, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.006789452252428, -3.923931923410286, -3.9833459805952183, -3.9164699081403436, -3.8486721398408275, -3.891029782560371, -3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9713794194342176, "mean_inference_ms": 9.061860276020644, "mean_action_processing_ms": 0.4469063553991803, "mean_env_wait_ms": 10.912100861001305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 552270, "agent_timesteps_total": 552270, "timers": {"sample_time_ms": 41482.844, "sample_throughput": 289.421, "load_time_ms": 7.33, "load_throughput": 1637998.166, "learn_time_ms": 36311.573, "learn_throughput": 330.638, "update_time_ms": 30.073}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002615399658679962, "policy_loss": 0.00011606137559283525, "vf_loss": 0.0024993375409394503, "vf_explained_var": 0.35291996598243713, "kl": 1.6789417713880539e-06, "entropy": 2.7266528606414795, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 552270, "num_agent_steps_sampled": 552270, "num_steps_trained": 552270, "num_agent_steps_trained": 552270}, "done": false, "episodes_total": 276, "training_iteration": 46, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-19-05", "timestamp": 1690841945, "time_this_iter_s": 76.1655023097992, "time_total_s": 4005.6018736362457, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4005.6018736362457, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.35871559633027}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7624400317945312, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9174501941225817, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8425733186852844, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.074876875437303, "reward_component_totals/delta_v_min": -2.138184456676247, "reward_component_totals/delta_v_max": -2.021695412248382, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48768754372958, "delta_v_total_min": 202.16954122483713, "delta_v_total_max": 213.8184456676237, "constraint_violation.max_vel_constraint.steps_mean": 1030.32, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5149025487256371, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.822226126166122, -4.060258258415498, -3.8483025649130247, -3.796163627700661, -3.771346227901002, -4.023167152427433, -3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.963441388081479, "mean_inference_ms": 9.034688203988882, "mean_action_processing_ms": 0.44546608788921693, "mean_env_wait_ms": 10.870389277994883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 564276, "agent_timesteps_total": 564276, "timers": {"sample_time_ms": 41364.244, "sample_throughput": 290.251, "load_time_ms": 7.573, "load_throughput": 1585402.226, "learn_time_ms": 36291.001, "learn_throughput": 330.826, "update_time_ms": 29.9}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003223265055567026, "policy_loss": 0.0006831848295405507, "vf_loss": 0.002540083834901452, "vf_explained_var": 0.2484470009803772, "kl": 3.101028767105163e-07, "entropy": 2.7740464210510254, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 564276, "num_agent_steps_sampled": 564276, "num_steps_trained": 564276, "num_agent_steps_trained": 564276}, "done": false, "episodes_total": 282, "training_iteration": 47, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-20-21", "timestamp": 1690842021, "time_this_iter_s": 75.92560648918152, "time_total_s": 4081.5274801254272, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4081.5274801254272, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.38073394495413}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7624400317945312, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9232385231560234, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8457313195686325, "reward_component_totals/dist_change_reward_min": -0.9946794955997457, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.077507203587396, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.75072035873887, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1010.88, "constraint_violation.max_vel_constraint.steps_min": 398, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5051874062968515, "constraint_violation.max_vel_constraint.ratio_min": 0.19890054972513743, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-3.9195504626889437, -3.8964456351405707, -3.7624400317945312, -3.9975504468807888, -4.042665473924952, -3.83296027391989, -4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9558204619004094, "mean_inference_ms": 9.008942704920878, "mean_action_processing_ms": 0.44403891939233486, "mean_env_wait_ms": 10.829363584213151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 576282, "agent_timesteps_total": 576282, "timers": {"sample_time_ms": 41241.382, "sample_throughput": 291.115, "load_time_ms": 7.862, "load_throughput": 1527083.917, "learn_time_ms": 36296.191, "learn_throughput": 330.779, "update_time_ms": 31.132}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 9.999999717180685e-10, "total_loss": 0.00325898383744061, "policy_loss": 0.0006616346072405577, "vf_loss": 0.0025973476003855467, "vf_explained_var": 0.5743238925933838, "kl": 4.938868642057059e-06, "entropy": 2.731102228164673, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 576282, "num_agent_steps_sampled": 576282, "num_steps_trained": 576282, "num_agent_steps_trained": 576282}, "done": false, "episodes_total": 288, "training_iteration": 48, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-21-38", "timestamp": 1690842098, "time_this_iter_s": 76.78514957427979, "time_total_s": 4158.312629699707, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4158.312629699707, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.9851851851852, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7629911922911923, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.925267277064949, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8466703797911924, "reward_component_totals/dist_change_reward_min": -0.9937353746548495, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.078596897273763, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85968972737552, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1012.51, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1958, "constraint_violation.max_vel_constraint.ratio_mean": 0.5060019990004997, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9785107446276862}, "hist_stats": {"episode_reward": [-4.020769248769438, -3.8366494437830676, -3.9020714937263197, -3.770080524507468, -3.968635077784138, -3.871198189211371, -3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.948713413251854, "mean_inference_ms": 8.985457347003045, "mean_action_processing_ms": 0.442691330864298, "mean_env_wait_ms": 10.789932846865913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 588288, "agent_timesteps_total": 588288, "timers": {"sample_time_ms": 41161.12, "sample_throughput": 291.683, "load_time_ms": 8.079, "load_throughput": 1486166.323, "learn_time_ms": 36349.707, "learn_throughput": 330.292, "update_time_ms": 30.863}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003521293168887496, "policy_loss": 0.0009790515759959817, "vf_loss": 0.0025422447361052036, "vf_explained_var": 0.2921476364135742, "kl": 2.688618110369134e-07, "entropy": 2.7786879539489746, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 588288, "num_agent_steps_sampled": 588288, "num_steps_trained": 588288, "num_agent_steps_trained": 588288}, "done": false, "episodes_total": 294, "training_iteration": 49, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-22-55", "timestamp": 1690842175, "time_this_iter_s": 77.39940643310547, "time_total_s": 4235.7120361328125, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4235.7120361328125, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.98648648648648, "ram_util_percent": 55.300000000000004}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7629911922911923, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.930450051906224, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8501424487784687, "reward_component_totals/dist_change_reward_min": -0.9965790308781819, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.0803076031277614, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0307603127754, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1038.56, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5190204897551224, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.816025232788482, -3.9939532437868444, -3.8846657108056295, -3.792054343405468, -3.823506438922206, -3.7629911922911923, -3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9419594249959031, "mean_inference_ms": 8.963435875425631, "mean_action_processing_ms": 0.44140062416218584, "mean_env_wait_ms": 10.752386592610835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 600294, "agent_timesteps_total": 600294, "timers": {"sample_time_ms": 41110.161, "sample_throughput": 292.045, "load_time_ms": 8.172, "load_throughput": 1469092.373, "learn_time_ms": 36464.414, "learn_throughput": 329.253, "update_time_ms": 30.509}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0021279817447066307, "policy_loss": -0.0006613869918510318, "vf_loss": 0.0027893707156181335, "vf_explained_var": 0.38441622257232666, "kl": 5.838541383695883e-08, "entropy": 2.7510077953338623, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 600294, "num_agent_steps_sampled": 600294, "num_steps_trained": 600294, "num_agent_steps_trained": 600294}, "done": false, "episodes_total": 300, "training_iteration": 50, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-24-12", "timestamp": 1690842252, "time_this_iter_s": 76.05962014198303, "time_total_s": 4311.7716562747955, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4311.7716562747955, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.97981651376146, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.773505571889914, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9322819430258433, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8519594314641337, "reward_component_totals/dist_change_reward_min": -0.9965790308781819, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.080322511561715, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0322511561707, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1026.72, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5131034482758621, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9243322297088747, -4.051900526417867, -3.9394559525394013, -3.868542075583562, -3.9616869809501014, -3.852257078080427, -3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9371127400370471, "mean_inference_ms": 8.942675776247032, "mean_action_processing_ms": 0.44015253421797934, "mean_env_wait_ms": 10.716652065045498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 612300, "agent_timesteps_total": 612300, "timers": {"sample_time_ms": 40977.249, "sample_throughput": 292.992, "load_time_ms": 7.811, "load_throughput": 1537021.293, "learn_time_ms": 36327.882, "learn_throughput": 330.49, "update_time_ms": 30.978}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0028578678611665964, "policy_loss": 0.0005635482375510037, "vf_loss": 0.0022943171206861734, "vf_explained_var": 0.4049724042415619, "kl": 1.9589042494772e-06, "entropy": 2.7405340671539307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 612300, "num_agent_steps_sampled": 612300, "num_steps_trained": 612300, "num_agent_steps_trained": 612300}, "done": false, "episodes_total": 306, "training_iteration": 51, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-25-39", "timestamp": 1690842339, "time_this_iter_s": 86.38992977142334, "time_total_s": 4398.161586046219, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4398.161586046219, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.9780487804878, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.773505571889914, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.93049315361411, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.850375507482696, "reward_component_totals/dist_change_reward_min": -0.9965790308781819, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.08011764613142, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.01176461314117, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1040.39, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5199350324837582, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9978279290026393, -3.9265707993158445, -4.074974738847626, -3.87029307645112, -3.9985554286027876, -3.8608658025616114, -3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9324206152453405, "mean_inference_ms": 8.92328193299567, "mean_action_processing_ms": 0.43893206671246754, "mean_env_wait_ms": 10.682224279099541, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 624306, "agent_timesteps_total": 624306, "timers": {"sample_time_ms": 41124.959, "sample_throughput": 291.94, "load_time_ms": 6.969, "load_throughput": 1722666.465, "learn_time_ms": 36535.231, "learn_throughput": 328.614, "update_time_ms": 32.807}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017868918366730213, "policy_loss": -0.0008203297620639205, "vf_loss": 0.002607224974781275, "vf_explained_var": 0.2582985460758209, "kl": 3.1548302104056347e-07, "entropy": 2.7788259983062744, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 624306, "num_agent_steps_sampled": 624306, "num_steps_trained": 624306, "num_agent_steps_trained": 624306}, "done": false, "episodes_total": 312, "training_iteration": 52, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-26-57", "timestamp": 1690842417, "time_this_iter_s": 78.15709686279297, "time_total_s": 4476.318682909012, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4476.318682909012, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.98482142857142, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.773505571889914, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.925953836135177, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8451814632809272, "reward_component_totals/dist_change_reward_min": -0.9965790308781819, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.080772372854256, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0245177933573792, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.07723728542484, "delta_v_total_min": 202.45177933573717, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1053.63, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.526551724137931, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8403066346582397, -4.040690630482963, -3.9673785020496917, -3.8390608790125578, -3.7953536113132245, -4.015457417622993, -3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9279503605528476, "mean_inference_ms": 8.905265293512226, "mean_action_processing_ms": 0.4377053573215111, "mean_env_wait_ms": 10.648885951537547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 636312, "agent_timesteps_total": 636312, "timers": {"sample_time_ms": 41149.051, "sample_throughput": 291.769, "load_time_ms": 6.779, "load_throughput": 1771150.294, "learn_time_ms": 36602.607, "learn_throughput": 328.009, "update_time_ms": 30.62}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0008645164780318737, "policy_loss": -0.0014772639842703938, "vf_loss": 0.002341779414564371, "vf_explained_var": 0.32099324464797974, "kl": 2.1938654981568106e-07, "entropy": 2.78133487701416, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 636312, "num_agent_steps_sampled": 636312, "num_steps_trained": 636312, "num_agent_steps_trained": 636312}, "done": false, "episodes_total": 318, "training_iteration": 53, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-28-15", "timestamp": 1690842495, "time_this_iter_s": 78.10480785369873, "time_total_s": 4554.423490762711, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4554.423490762711, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.300000000000004}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.773505571889914, "episode_reward_min": -4.104683624766544, "episode_reward_mean": -3.9273768180115223, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8446733056344814, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.082703512377047, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.27035123770395, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1056.03, "constraint_violation.max_vel_constraint.steps_min": 373, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5277511244377812, "constraint_violation.max_vel_constraint.ratio_min": 0.18640679660169915, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.8100665934497115, -3.9572737009391457, -3.8527630748565764, -3.9039712248900846, -4.073479166274783, -4.104683624766544, -3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9235321571931876, "mean_inference_ms": 8.887719567573193, "mean_action_processing_ms": 0.4365333272920825, "mean_env_wait_ms": 10.616405902257078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 648318, "agent_timesteps_total": 648318, "timers": {"sample_time_ms": 41101.854, "sample_throughput": 292.104, "load_time_ms": 6.716, "load_throughput": 1787655.092, "learn_time_ms": 36429.683, "learn_throughput": 329.566, "update_time_ms": 29.122}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0008082466083578765, "policy_loss": -0.0016277054091915488, "vf_loss": 0.002435952192172408, "vf_explained_var": 0.625633180141449, "kl": 2.2700887711835094e-06, "entropy": 2.707925319671631, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 648318, "num_agent_steps_sampled": 648318, "num_steps_trained": 648318, "num_agent_steps_trained": 648318}, "done": false, "episodes_total": 324, "training_iteration": 54, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-29-30", "timestamp": 1690842570, "time_this_iter_s": 74.63070011138916, "time_total_s": 4629.0541908741, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4629.0541908741, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.98317757009346, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.773505571889914, "episode_reward_min": -4.091368937696036, "episode_reward_mean": -3.9281544220376095, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8452432120400769, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.0829112099975386, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.29112099975305, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1040.94, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5202098950524737, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.773505571889914, -3.8522147853818156, -3.9504673918333655, -3.922081861367372, -3.967302885457773, -4.0585290647259225, -3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9192176210986576, "mean_inference_ms": 8.870435519098741, "mean_action_processing_ms": 0.4353598562049318, "mean_env_wait_ms": 10.58467536308156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 660324, "agent_timesteps_total": 660324, "timers": {"sample_time_ms": 40999.82, "sample_throughput": 292.831, "load_time_ms": 6.399, "load_throughput": 1876367.078, "learn_time_ms": 36607.707, "learn_throughput": 327.964, "update_time_ms": 27.504}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003683953545987606, "policy_loss": 0.0009647146216593683, "vf_loss": 0.0027192390989512205, "vf_explained_var": 0.012437067925930023, "kl": 1.3569270151947421e-09, "entropy": 2.8099286556243896, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 660324, "num_agent_steps_sampled": 660324, "num_steps_trained": 660324, "num_agent_steps_trained": 660324}, "done": false, "episodes_total": 330, "training_iteration": 55, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-30-48", "timestamp": 1690842648, "time_this_iter_s": 78.05978536605835, "time_total_s": 4707.113976240158, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4707.113976240158, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.97727272727273, "ram_util_percent": 55.35818181818179}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7765288070574208, "episode_reward_min": -4.091368937696036, "episode_reward_mean": -3.930123301279087, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8475783673823291, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.0825449338967634, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.2544933896756, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1034.17, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5168265867066466, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.999117315738517, -3.9556339921961827, -4.07243880839641, -3.974017381272597, -4.091368937696036, -4.026694018540332, -4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9151435550877993, "mean_inference_ms": 8.854115530420515, "mean_action_processing_ms": 0.43422992421715323, "mean_env_wait_ms": 10.55348389112162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 672330, "agent_timesteps_total": 672330, "timers": {"sample_time_ms": 40916.869, "sample_throughput": 293.424, "load_time_ms": 6.184, "load_throughput": 1941385.187, "learn_time_ms": 36691.77, "learn_throughput": 327.212, "update_time_ms": 27.987}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031723203137516975, "policy_loss": 0.0005382302915677428, "vf_loss": 0.00263409037142992, "vf_explained_var": 0.39218735694885254, "kl": 1.7855531950772274e-06, "entropy": 2.7560336589813232, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 672330, "num_agent_steps_sampled": 672330, "num_steps_trained": 672330, "num_agent_steps_trained": 672330}, "done": false, "episodes_total": 336, "training_iteration": 56, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-32-05", "timestamp": 1690842725, "time_this_iter_s": 76.20968842506409, "time_total_s": 4783.323664665222, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4783.323664665222, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.98348623853212, "ram_util_percent": 55.42844036697247}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7765288070574208, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.926447857508904, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8435921966590965, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7063862007931805, "reward_component_totals/delta_v_mean": -2.082855660849813, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.28556608498053, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1025.0, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5122438780609696, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.057648687003924, -3.9085802791634956, -4.035106591937879, -3.8026094844019314, -3.926368349524796, -3.8487871455118903, -4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9093842809529549, "mean_inference_ms": 8.839146631498531, "mean_action_processing_ms": 0.4331897986151871, "mean_env_wait_ms": 10.524262594996587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 684336, "agent_timesteps_total": 684336, "timers": {"sample_time_ms": 41034.576, "sample_throughput": 292.583, "load_time_ms": 6.401, "load_throughput": 1875717.083, "learn_time_ms": 36637.352, "learn_throughput": 327.698, "update_time_ms": 29.882}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0037568225525319576, "policy_loss": 0.001195593737065792, "vf_loss": 0.0025612283498048782, "vf_explained_var": 0.5221798419952393, "kl": 9.281155257667706e-07, "entropy": 2.731903314590454, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 684336, "num_agent_steps_sampled": 684336, "num_steps_trained": 684336, "num_agent_steps_trained": 684336}, "done": false, "episodes_total": 342, "training_iteration": 57, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-33-21", "timestamp": 1690842801, "time_this_iter_s": 76.51796293258667, "time_total_s": 4859.841627597809, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4859.841627597809, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.9790909090909, "ram_util_percent": 55.430909090909054}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7765288070574208, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.9248040300605767, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8428616199342512, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7117513273009454, "reward_component_totals/delta_v_mean": -2.0819424101263317, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.19424101263238, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1035.76, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5176211894052973, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.037800576758159, -4.078523731045069, -4.042746106351871, -3.8824637388958596, -3.7765288070574208, -3.9182167396469256, -4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9039325507832556, "mean_inference_ms": 8.824957491131524, "mean_action_processing_ms": 0.43217244397679666, "mean_env_wait_ms": 10.496436946923554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 696342, "agent_timesteps_total": 696342, "timers": {"sample_time_ms": 41217.546, "sample_throughput": 291.284, "load_time_ms": 6.338, "load_throughput": 1894409.477, "learn_time_ms": 36397.412, "learn_throughput": 329.859, "update_time_ms": 30.621}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0009261607774533331, "policy_loss": -0.001458725892007351, "vf_loss": 0.002384886145591736, "vf_explained_var": 0.30019932985305786, "kl": 1.0305885211892019e-07, "entropy": 2.762180805206299, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 696342, "num_agent_steps_sampled": 696342, "num_steps_trained": 696342, "num_agent_steps_trained": 696342}, "done": false, "episodes_total": 348, "training_iteration": 58, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-34-38", "timestamp": 1690842878, "time_this_iter_s": 76.16111183166504, "time_total_s": 4936.002739429474, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4936.002739429474, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.98256880733943, "ram_util_percent": 55.39999999999997}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7802365897818415, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.922077436241911, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8402712894210306, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.7117513273009454, "reward_component_totals/delta_v_mean": -2.081806146820887, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.18061468208782, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1056.11, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5277911044477761, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.02475341889411, -3.901153145037634, -3.830148615203321, -3.9608983648854394, -4.0048119130130555, -3.9647176875951002, -3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.898773163470476, "mean_inference_ms": 8.811853222749571, "mean_action_processing_ms": 0.4311989316101069, "mean_env_wait_ms": 10.469600169363805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 708348, "agent_timesteps_total": 708348, "timers": {"sample_time_ms": 41400.221, "sample_throughput": 289.998, "load_time_ms": 6.064, "load_throughput": 1979839.19, "learn_time_ms": 36359.269, "learn_throughput": 330.205, "update_time_ms": 35.033}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003027819562703371, "policy_loss": 0.0003436373663134873, "vf_loss": 0.0026841838844120502, "vf_explained_var": 0.37944313883781433, "kl": 7.407369366774219e-07, "entropy": 2.754645586013794, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 708348, "num_agent_steps_sampled": 708348, "num_steps_trained": 708348, "num_agent_steps_trained": 708348}, "done": false, "episodes_total": 354, "training_iteration": 59, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-35-57", "timestamp": 1690842957, "time_this_iter_s": 78.81798005104065, "time_total_s": 5014.8207194805145, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5014.8207194805145, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.98125000000002, "ram_util_percent": 55.42589285714285}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7802365897818415, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.9194309145185797, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8377167172956939, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.704558524247353, "reward_component_totals/delta_v_mean": -2.0817141972228925, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.17141972228836, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1071.02, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5352423788105948, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.863647697472401, -4.025023545917097, -3.996277420521761, -3.8416884965556806, -3.9725973149970057, -3.7936395408501165, -4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.893927569088498, "mean_inference_ms": 8.799403352465719, "mean_action_processing_ms": 0.43027467999168567, "mean_env_wait_ms": 10.444133158400957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 720354, "agent_timesteps_total": 720354, "timers": {"sample_time_ms": 41487.401, "sample_throughput": 289.389, "load_time_ms": 6.781, "load_throughput": 1770533.789, "learn_time_ms": 36242.837, "learn_throughput": 331.265, "update_time_ms": 35.111}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0015549848321825266, "policy_loss": -0.000907775538507849, "vf_loss": 0.0024627603124827147, "vf_explained_var": 0.44880273938179016, "kl": 4.5133094772609184e-07, "entropy": 2.721545934677124, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 720354, "num_agent_steps_sampled": 720354, "num_steps_trained": 720354, "num_agent_steps_trained": 720354}, "done": false, "episodes_total": 360, "training_iteration": 60, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-37-13", "timestamp": 1690843033, "time_this_iter_s": 75.81011581420898, "time_total_s": 5090.6308352947235, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5090.6308352947235, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.98440366972477, "ram_util_percent": 55.45321100917429}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7802365897818415, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.9241002873800643, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8419210183687489, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.704558524247353, "reward_component_totals/delta_v_mean": -2.082179269011322, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.21792690113142, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1074.44, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5369515242378811, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-4.032532237214382, -3.97728601191396, -3.8394445771466597, -3.9375627008977796, -3.7853762996652733, -3.949908825787354, -3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8906434849599634, "mean_inference_ms": 8.787400568069485, "mean_action_processing_ms": 0.42942389116994817, "mean_env_wait_ms": 10.420232086627143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 732360, "agent_timesteps_total": 732360, "timers": {"sample_time_ms": 41804.321, "sample_throughput": 287.195, "load_time_ms": 7.495, "load_throughput": 1601970.263, "learn_time_ms": 36247.993, "learn_throughput": 331.218, "update_time_ms": 36.057}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 9.999999717180685e-10, "total_loss": 0.00274634943343699, "policy_loss": 0.0001953163300640881, "vf_loss": 0.0025510333944112062, "vf_explained_var": 0.4962141811847687, "kl": 4.715947170552681e-07, "entropy": 2.720076084136963, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 732360, "num_agent_steps_sampled": 732360, "num_steps_trained": 732360, "num_agent_steps_trained": 732360}, "done": false, "episodes_total": 366, "training_iteration": 61, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-38-43", "timestamp": 1690843123, "time_this_iter_s": 89.639240026474, "time_total_s": 5180.2700753211975, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5180.2700753211975, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.9859375, "ram_util_percent": 55.399999999999984}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7802365897818415, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.923173068635225, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8416737096717594, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.704558524247353, "reward_component_totals/delta_v_mean": -2.081499358963473, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.1499358963465, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1087.04, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5432483758120941, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.889174673205358, -3.8659731075662718, -3.784961051429181, -3.840366928983208, -3.8140109708113816, -3.8102514037466833, -3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8876415518412357, "mean_inference_ms": 8.77547878492857, "mean_action_processing_ms": 0.4286152903678754, "mean_env_wait_ms": 10.397636517591737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 744366, "agent_timesteps_total": 744366, "timers": {"sample_time_ms": 41773.923, "sample_throughput": 287.404, "load_time_ms": 7.651, "load_throughput": 1569109.82, "learn_time_ms": 36189.2, "learn_throughput": 331.756, "update_time_ms": 36.427}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002195688895881176, "policy_loss": -0.00024962681345641613, "vf_loss": 0.0024453175719827414, "vf_explained_var": 0.42804160714149475, "kl": 5.475025233181441e-08, "entropy": 2.723924398422241, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 744366, "num_agent_steps_sampled": 744366, "num_steps_trained": 744366, "num_agent_steps_trained": 744366}, "done": false, "episodes_total": 372, "training_iteration": 62, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-40-00", "timestamp": 1690843200, "time_this_iter_s": 77.34101176261902, "time_total_s": 5257.6110870838165, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5257.6110870838165, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.98272727272727, "ram_util_percent": 55.419090909090876}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7592240900555347, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.924058864790888, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420462863541593, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.704558524247353, "reward_component_totals/delta_v_mean": -2.0820125784367356, "reward_component_totals/delta_v_min": -2.171298992931841, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.2012578436728, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 217.12989929318346, "constraint_violation.max_vel_constraint.steps_mean": 1067.93, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5336981509245377, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.7974750601559544, -3.79409490256058, -3.8196043730385627, -3.925462775364003, -4.051937965404754, -4.030769974308068, -3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8850019099663289, "mean_inference_ms": 8.763562510585484, "mean_action_processing_ms": 0.42785906594634854, "mean_env_wait_ms": 10.37635367772287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 756372, "agent_timesteps_total": 756372, "timers": {"sample_time_ms": 42002.378, "sample_throughput": 285.841, "load_time_ms": 7.998, "load_throughput": 1501086.951, "learn_time_ms": 36072.589, "learn_throughput": 332.829, "update_time_ms": 36.693}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001057301415130496, "policy_loss": -0.0014860889641568065, "vf_loss": 0.0025433918926864862, "vf_explained_var": 0.23684240877628326, "kl": 4.2659581822590553e-07, "entropy": 2.7308621406555176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 756372, "num_agent_steps_sampled": 756372, "num_steps_trained": 756372, "num_agent_steps_trained": 756372}, "done": false, "episodes_total": 378, "training_iteration": 63, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-41-20", "timestamp": 1690843280, "time_this_iter_s": 79.20431065559387, "time_total_s": 5336.81539773941, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5336.81539773941, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.98761061946901, "ram_util_percent": 55.47610619469025}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7592240900555347, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.9238577941182124, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8439461452432384, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.704558524247353, "reward_component_totals/delta_v_mean": -2.079911648874982, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.99116488749743, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1095.88, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5476661669165418, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.9505344591023803, -4.018384533372216, -3.8741490541888144, -3.974520874491673, -3.876764617046053, -3.902995658470483, -3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8827035358485489, "mean_inference_ms": 8.751552686154405, "mean_action_processing_ms": 0.42715951694164045, "mean_env_wait_ms": 10.357003214688444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 768378, "agent_timesteps_total": 768378, "timers": {"sample_time_ms": 42390.279, "sample_throughput": 283.225, "load_time_ms": 8.072, "load_throughput": 1487404.227, "learn_time_ms": 36103.492, "learn_throughput": 332.544, "update_time_ms": 36.716}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0018384329741820693, "policy_loss": -0.00039619806921109557, "vf_loss": 0.0022346305195242167, "vf_explained_var": 0.4929482340812683, "kl": 5.00641453982098e-06, "entropy": 2.6732733249664307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 768378, "num_agent_steps_sampled": 768378, "num_steps_trained": 768378, "num_agent_steps_trained": 768378}, "done": false, "episodes_total": 384, "training_iteration": 64, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-42-39", "timestamp": 1690843359, "time_this_iter_s": 78.84497618675232, "time_total_s": 5415.660373926163, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5415.660373926163, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.496428571428574}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.580560695235687, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.921970420559187, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8419616268018322, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.5010685004341291, "reward_component_totals/delta_v_mean": -2.080008793757363, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00087937573545, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1102.29, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1971, "constraint_violation.max_vel_constraint.ratio_mean": 0.5508695652173913, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9850074962518741}, "hist_stats": {"episode_reward": [-3.837097411139184, -4.048173743361104, -3.9154187697422187, -4.074037515483212, -3.9304427623981146, -3.9265299614597353, -4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8807355505124534, "mean_inference_ms": 8.740127684038422, "mean_action_processing_ms": 0.42649787722342347, "mean_env_wait_ms": 10.339050650361532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 780384, "agent_timesteps_total": 780384, "timers": {"sample_time_ms": 42845.002, "sample_throughput": 280.219, "load_time_ms": 8.1, "load_throughput": 1482211.856, "learn_time_ms": 36025.008, "learn_throughput": 333.268, "update_time_ms": 38.895}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023072955664247274, "policy_loss": -0.0004024065856356174, "vf_loss": 0.002709703054279089, "vf_explained_var": 0.2562562823295593, "kl": 5.77845611360317e-08, "entropy": 2.787799119949341, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 780384, "num_agent_steps_sampled": 780384, "num_steps_trained": 780384, "num_agent_steps_trained": 780384}, "done": false, "episodes_total": 390, "training_iteration": 65, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-44-01", "timestamp": 1690843441, "time_this_iter_s": 81.83305835723877, "time_total_s": 5497.4934322834015, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5497.4934322834015, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.97948717948718, "ram_util_percent": 55.5136752136752}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.580560695235687, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.9184263912137625, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8387766171541138, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": -0.5010685004341291, "reward_component_totals/delta_v_mean": -2.0796497740596567, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9649774059649, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1100.28, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5498650674662668, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.050800925295108, -3.965896413644088, -4.034048468894593, -3.979962930217644, -3.8034476924799394, -3.900224029031425, -3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8789900920652034, "mean_inference_ms": 8.72931102582142, "mean_action_processing_ms": 0.42588614672957237, "mean_env_wait_ms": 10.32242480878625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 792390, "agent_timesteps_total": 792390, "timers": {"sample_time_ms": 43267.843, "sample_throughput": 277.481, "load_time_ms": 8.326, "load_throughput": 1441925.987, "learn_time_ms": 35955.725, "learn_throughput": 333.911, "update_time_ms": 38.618}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0020092343911528587, "policy_loss": -0.00042340008076280355, "vf_loss": 0.002432635286822915, "vf_explained_var": 0.4191107749938965, "kl": 8.942424187807774e-07, "entropy": 2.729572296142578, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 792390, "num_agent_steps_sampled": 792390, "num_steps_trained": 792390, "num_agent_steps_trained": 792390}, "done": false, "episodes_total": 396, "training_iteration": 66, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-45-21", "timestamp": 1690843521, "time_this_iter_s": 79.72854804992676, "time_total_s": 5577.221980333328, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5577.221980333328, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.36842105263156}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.8950812975885922, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8143966439781093, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0806846536104913, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.0311537013947976, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0684653610484, "delta_v_total_min": 203.11537013947967, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1105.85, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5526486756621689, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.9742698462663544, -3.8396884934341298, -3.795843152560402, -3.9429120601895056, -3.868254947740022, -3.9630978905945993, -4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.875716353268676, "mean_inference_ms": 8.719450186661641, "mean_action_processing_ms": 0.42530819692103106, "mean_env_wait_ms": 10.306242424330346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 804396, "agent_timesteps_total": 804396, "timers": {"sample_time_ms": 43118.293, "sample_throughput": 278.443, "load_time_ms": 8.469, "load_throughput": 1417559.42, "learn_time_ms": 35923.111, "learn_throughput": 334.214, "update_time_ms": 35.66}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001519421930424869, "policy_loss": -0.0010678907856345177, "vf_loss": 0.002587314462289214, "vf_explained_var": 0.4072955250740051, "kl": 2.8883266622869996e-07, "entropy": 2.76112961769104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 804396, "num_agent_steps_sampled": 804396, "num_steps_trained": 804396, "num_agent_steps_trained": 804396}, "done": false, "episodes_total": 402, "training_iteration": 67, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-46-36", "timestamp": 1690843596, "time_this_iter_s": 74.68238806724548, "time_total_s": 5651.904368400574, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5651.904368400574, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.98504672897198, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.8940371934481885, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8149837670374379, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0790534264107583, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.905342641075, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1111.47, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5554572713643178, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.020283326239888, -3.8756253453442477, -3.8258663664799637, -3.8661680257081708, -3.8423110838728105, -3.8717214696879587, -3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.872746589622953, "mean_inference_ms": 8.710078353533563, "mean_action_processing_ms": 0.4247487017909454, "mean_env_wait_ms": 10.290794159567383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 816402, "agent_timesteps_total": 816402, "timers": {"sample_time_ms": 43060.8, "sample_throughput": 278.815, "load_time_ms": 7.935, "load_throughput": 1513120.869, "learn_time_ms": 35956.787, "learn_throughput": 333.901, "update_time_ms": 33.79}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002768450416624546, "policy_loss": 0.0003906414785888046, "vf_loss": 0.0023778106551617384, "vf_explained_var": 0.3702109456062317, "kl": 8.596307452535257e-07, "entropy": 2.7351107597351074, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 816402, "num_agent_steps_sampled": 816402, "num_steps_trained": 816402, "num_agent_steps_trained": 816402}, "done": false, "episodes_total": 408, "training_iteration": 68, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-47-52", "timestamp": 1690843672, "time_this_iter_s": 75.8880078792572, "time_total_s": 5727.792376279831, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5727.792376279831, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.98073394495412, "ram_util_percent": 55.39541284403667}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.8947283370272596, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8162731674314863, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0784551695957814, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.84551695957737, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1104.46, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5519540229885058, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.827821546809651, -3.890241135201704, -3.8566452273650187, -3.986415563951277, -3.957102010920595, -3.8832029017609067, -3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8700046846249225, "mean_inference_ms": 8.701303446353823, "mean_action_processing_ms": 0.42423090280279785, "mean_env_wait_ms": 10.276338803815623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 828408, "agent_timesteps_total": 828408, "timers": {"sample_time_ms": 43015.505, "sample_throughput": 279.109, "load_time_ms": 7.965, "load_throughput": 1507377.632, "learn_time_ms": 35700.465, "learn_throughput": 336.298, "update_time_ms": 33.373}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0020361512433737516, "policy_loss": -0.00010404022759757936, "vf_loss": 0.0021401909179985523, "vf_explained_var": 0.55747389793396, "kl": 1.9348826754139736e-06, "entropy": 2.6628973484039307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 828408, "num_agent_steps_sampled": 828408, "num_steps_trained": 828408, "num_agent_steps_trained": 828408}, "done": false, "episodes_total": 414, "training_iteration": 69, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-49-08", "timestamp": 1690843748, "time_this_iter_s": 75.80224609375, "time_total_s": 5803.594622373581, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5803.594622373581, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.98148148148148, "ram_util_percent": 55.30277777777778}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.08993776020552, "episode_reward_mean": -3.8940387700878705, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8150681064132022, "reward_component_totals/dist_change_reward_min": -0.9999224905386078, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0789706636746756, "reward_component_totals/delta_v_min": -2.1618961732089517, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89706636746683, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 216.1896173208944, "constraint_violation.max_vel_constraint.steps_mean": 1095.08, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5472663668165917, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.909479130271963, -4.08993776020552, -3.9077125329172935, -3.893111526697843, -3.860300095872187, -3.997368968538594, -3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.867486873469071, "mean_inference_ms": 8.692598761001102, "mean_action_processing_ms": 0.42377934060408307, "mean_env_wait_ms": 10.263186778441282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 840414, "agent_timesteps_total": 840414, "timers": {"sample_time_ms": 43143.046, "sample_throughput": 278.284, "load_time_ms": 8.398, "load_throughput": 1429709.918, "learn_time_ms": 35641.431, "learn_throughput": 336.855, "update_time_ms": 33.016}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0034574191085994244, "policy_loss": 0.0007414580904878676, "vf_loss": 0.0027159603778272867, "vf_explained_var": 0.364863783121109, "kl": 1.8281486973137362e-06, "entropy": 2.7521533966064453, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 840414, "num_agent_steps_sampled": 840414, "num_steps_trained": 840414, "num_agent_steps_trained": 840414}, "done": false, "episodes_total": 420, "training_iteration": 70, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-50-24", "timestamp": 1690843824, "time_this_iter_s": 76.42752003669739, "time_total_s": 5880.022142410278, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5880.022142410278, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.97614678899082, "ram_util_percent": 55.358715596330285}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.895583027423052, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8180220594064715, "reward_component_totals/dist_change_reward_min": -0.9993389318240866, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.077560968016588, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7560968016581, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1110.2, "constraint_violation.max_vel_constraint.steps_min": 322, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5548225887056472, "constraint_violation.max_vel_constraint.ratio_min": 0.16091954022988506, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.857186944594231, -4.032907892320042, -4.026327560425637, -4.005906326034827, -3.8344843788682947, -3.9224992568236576, -3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8665298209166195, "mean_inference_ms": 8.684024701411083, "mean_action_processing_ms": 0.4233669869912707, "mean_env_wait_ms": 10.251279164538339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 852420, "agent_timesteps_total": 852420, "timers": {"sample_time_ms": 43210.045, "sample_throughput": 277.852, "load_time_ms": 8.174, "load_throughput": 1468809.56, "learn_time_ms": 35568.769, "learn_throughput": 337.543, "update_time_ms": 33.059}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033159605227410793, "policy_loss": 0.0007824182393960655, "vf_loss": 0.0025335405953228474, "vf_explained_var": 0.30080297589302063, "kl": 1.5580376100388094e-07, "entropy": 2.76340913772583, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 852420, "num_agent_steps_sampled": 852420, "num_steps_trained": 852420, "num_agent_steps_trained": 852420}, "done": false, "episodes_total": 426, "training_iteration": 71, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-51-54", "timestamp": 1690843914, "time_this_iter_s": 89.56437563896179, "time_total_s": 5969.58651804924, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5969.58651804924, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.98188976377953, "ram_util_percent": 55.33622047244092}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.894997679592907, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8183082944132336, "reward_component_totals/dist_change_reward_min": -0.9993389318240866, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.076689385179682, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66893851796746, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1131.49, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5654622688655673, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.953002912678785, -4.037553092641376, -3.974478265426618, -3.9989715783651976, -3.986039828929732, -3.8459047596344256, -3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8656302535651528, "mean_inference_ms": 8.676141218041145, "mean_action_processing_ms": 0.4230079255228938, "mean_env_wait_ms": 10.240270190843056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 864426, "agent_timesteps_total": 864426, "timers": {"sample_time_ms": 43328.242, "sample_throughput": 277.094, "load_time_ms": 8.036, "load_throughput": 1494019.208, "learn_time_ms": 35364.227, "learn_throughput": 339.496, "update_time_ms": 31.262}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017773211002349854, "policy_loss": -0.000673894421197474, "vf_loss": 0.002451215172186494, "vf_explained_var": 0.30053141713142395, "kl": 1.0598025710351067e-06, "entropy": 2.7545251846313477, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 864426, "num_agent_steps_sampled": 864426, "num_steps_trained": 864426, "num_agent_steps_trained": 864426}, "done": false, "episodes_total": 432, "training_iteration": 72, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-53-11", "timestamp": 1690843991, "time_this_iter_s": 76.36498737335205, "time_total_s": 6045.951505422592, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6045.951505422592, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.377064220183456}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.8902729391730784, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8138677106397354, "reward_component_totals/dist_change_reward_min": -0.9993389318240866, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0764052285333507, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64052285333437, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1121.07, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5602548725637181, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.929520772625816, -3.978366667067937, -4.032611901552973, -3.979282147010866, -3.8908810499148063, -3.8920723376679733, -3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.864775706803833, "mean_inference_ms": 8.668007282519392, "mean_action_processing_ms": 0.4226728858058669, "mean_env_wait_ms": 10.22988038048483, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 876432, "agent_timesteps_total": 876432, "timers": {"sample_time_ms": 43028.332, "sample_throughput": 279.025, "load_time_ms": 7.845, "load_throughput": 1530458.037, "learn_time_ms": 35363.26, "learn_throughput": 339.505, "update_time_ms": 31.211}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002812386257573962, "policy_loss": 0.00047828792594373226, "vf_loss": 0.002334099728614092, "vf_explained_var": 0.3681824505329132, "kl": 2.298291292390786e-06, "entropy": 2.7303500175476074, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 876432, "num_agent_steps_sampled": 876432, "num_steps_trained": 876432, "num_agent_steps_trained": 876432}, "done": false, "episodes_total": 438, "training_iteration": 73, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-54-27", "timestamp": 1690844067, "time_this_iter_s": 76.19594168663025, "time_total_s": 6122.147447109222, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6122.147447109222, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.97247706422019, "ram_util_percent": 55.30825688073394}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.886447684900007, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8114276795795017, "reward_component_totals/dist_change_reward_min": -0.9993389318240866, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0750200053205132, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5020005320506, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1133.8, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5666166916541729, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9318100491151053, -3.8403368354349308, -4.079380930796587, -3.7802365897818415, -3.819592003302602, -3.8958478432308215, -3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8639555528780931, "mean_inference_ms": 8.659707715962137, "mean_action_processing_ms": 0.42235043292575297, "mean_env_wait_ms": 10.219875509663337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 888438, "agent_timesteps_total": 888438, "timers": {"sample_time_ms": 42894.38, "sample_throughput": 279.897, "load_time_ms": 7.927, "load_throughput": 1514481.532, "learn_time_ms": 35179.09, "learn_throughput": 341.282, "update_time_ms": 32.346}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0022284011356532574, "policy_loss": -0.00024255381140392274, "vf_loss": 0.0024709554854780436, "vf_explained_var": 0.322622686624527, "kl": 5.227623773862433e-07, "entropy": 2.763373613357544, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 888438, "num_agent_steps_sampled": 888438, "num_steps_trained": 888438, "num_agent_steps_trained": 888438}, "done": false, "episodes_total": 444, "training_iteration": 74, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-55-43", "timestamp": 1690844143, "time_this_iter_s": 75.70602917671204, "time_total_s": 6197.853476285934, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6197.853476285934, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.97777777777777, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.8881803123186263, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.812054875050015, "reward_component_totals/dist_change_reward_min": -0.989886425384721, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0761254372686184, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61254372686108, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1153.61, "constraint_violation.max_vel_constraint.steps_min": 349, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5765167416291854, "constraint_violation.max_vel_constraint.ratio_min": 0.1744127936031984, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9874922441160607, -3.7982114628530868, -4.019092383254258, -3.9433843811318443, -3.933279514934614, -4.015595468618433, -3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.863223010265157, "mean_inference_ms": 8.65156274722146, "mean_action_processing_ms": 0.4220472546883967, "mean_env_wait_ms": 10.210383709860368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 900444, "agent_timesteps_total": 900444, "timers": {"sample_time_ms": 42376.781, "sample_throughput": 283.316, "load_time_ms": 7.816, "load_throughput": 1536046.103, "learn_time_ms": 35069.945, "learn_throughput": 342.344, "update_time_ms": 28.408}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0029928882140666246, "policy_loss": 0.0005290163098834455, "vf_loss": 0.0024638723116368055, "vf_explained_var": 0.4868699312210083, "kl": 1.5034726175144897e-06, "entropy": 2.747587203979492, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 900444, "num_agent_steps_sampled": 900444, "num_steps_trained": 900444, "num_agent_steps_trained": 900444}, "done": false, "episodes_total": 450, "training_iteration": 75, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-56-59", "timestamp": 1690844219, "time_this_iter_s": 75.46036982536316, "time_total_s": 6273.313846111298, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6273.313846111298, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.97407407407408, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.88784731150713, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.811472928357093, "reward_component_totals/dist_change_reward_min": -0.989886425384721, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0763743831500445, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.63743831500366, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1142.77, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5710994502748626, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.837150234437332, -3.7862896937651707, -3.8272125995775803, -4.022303460962404, -3.8984934318515547, -4.0484631715511625, -3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8625842933400367, "mean_inference_ms": 8.64363858935727, "mean_action_processing_ms": 0.42176148283613285, "mean_env_wait_ms": 10.201274202448591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 912450, "agent_timesteps_total": 912450, "timers": {"sample_time_ms": 42092.447, "sample_throughput": 285.229, "load_time_ms": 7.795, "load_throughput": 1540194.519, "learn_time_ms": 35125.907, "learn_throughput": 341.799, "update_time_ms": 29.437}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0035085994750261307, "policy_loss": 0.00016393311670981348, "vf_loss": 0.003344666911289096, "vf_explained_var": 0.15527643263339996, "kl": 1.7058474099940213e-07, "entropy": 2.7775681018829346, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 912450, "num_agent_steps_sampled": 912450, "num_steps_trained": 912450, "num_agent_steps_trained": 912450}, "done": false, "episodes_total": 456, "training_iteration": 76, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-58-17", "timestamp": 1690844297, "time_this_iter_s": 77.50057816505432, "time_total_s": 6350.814424276352, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6350.814424276352, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.97297297297298, "ram_util_percent": 55.300000000000004}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.082940487016076, "episode_reward_mean": -3.8880938310081574, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.81281180457074, "reward_component_totals/dist_change_reward_min": -0.989886425384721, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.075282026437425, "reward_component_totals/delta_v_min": -2.1336777328451473, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5282026437418, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.36777328451393, "constraint_violation.max_vel_constraint.steps_mean": 1141.99, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5707096451774113, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9538789669246017, -3.916711065612529, -4.059324179506604, -4.082940487016076, -3.7917729879233937, -3.9177066788764803, -3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8606483060486854, "mean_inference_ms": 8.63610392867622, "mean_action_processing_ms": 0.42147333299700873, "mean_env_wait_ms": 10.192431264009064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 924456, "agent_timesteps_total": 924456, "timers": {"sample_time_ms": 42256.159, "sample_throughput": 284.124, "load_time_ms": 7.471, "load_throughput": 1606954.565, "learn_time_ms": 35021.901, "learn_throughput": 342.814, "update_time_ms": 27.854}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017962600104510784, "policy_loss": -0.0005754256271757185, "vf_loss": 0.0023716858122497797, "vf_explained_var": 0.30400779843330383, "kl": 1.660933719449531e-07, "entropy": 2.749358892440796, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 924456, "num_agent_steps_sampled": 924456, "num_steps_trained": 924456, "num_agent_steps_trained": 924456}, "done": false, "episodes_total": 462, "training_iteration": 77, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_15-59-32", "timestamp": 1690844372, "time_this_iter_s": 75.26304125785828, "time_total_s": 6426.07746553421, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6426.07746553421, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.98224299065421, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.068818744053592, "episode_reward_mean": -3.8828455443933154, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8076537657970774, "reward_component_totals/dist_change_reward_min": -0.9840589023129497, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0751917785962455, "reward_component_totals/delta_v_min": -2.130145134776832, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.51917785962385, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 213.01451347768258, "constraint_violation.max_vel_constraint.steps_mean": 1152.23, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5758270864567716, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.787793017346481, -3.886539971874178, -4.0212523286763355, -4.024323793444664, -3.7592240900555347, -3.920393930337327, -3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8589239642082473, "mean_inference_ms": 8.628374661518484, "mean_action_processing_ms": 0.42120329516947963, "mean_env_wait_ms": 10.184418932441965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 936462, "agent_timesteps_total": 936462, "timers": {"sample_time_ms": 42461.123, "sample_throughput": 282.753, "load_time_ms": 7.779, "load_throughput": 1543395.066, "learn_time_ms": 35086.568, "learn_throughput": 342.182, "update_time_ms": 26.471}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0032231714576482773, "policy_loss": 0.0006316632498055696, "vf_loss": 0.0025915089063346386, "vf_explained_var": 0.48605817556381226, "kl": 9.701827821118059e-07, "entropy": 2.7114768028259277, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 936462, "num_agent_steps_sampled": 936462, "num_steps_trained": 936462, "num_agent_steps_trained": 936462}, "done": false, "episodes_total": 468, "training_iteration": 78, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-00-51", "timestamp": 1690844451, "time_this_iter_s": 78.58533883094788, "time_total_s": 6504.662804365158, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6504.662804365158, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.96785714285716, "ram_util_percent": 55.35446428571428}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.8849780790957826, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8075876892321364, "reward_component_totals/dist_change_reward_min": -0.9840589023129497, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.077390389863653, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73903898636456, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1151.95, "constraint_violation.max_vel_constraint.steps_min": 480, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5756871564217891, "constraint_violation.max_vel_constraint.ratio_min": 0.239880059970015, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.8058613685074603, -3.9584101916782446, -3.787723884684059, -3.8617042860457165, -3.791280409716262, -3.8146005816762476, -3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8573945012382598, "mean_inference_ms": 8.620744029304259, "mean_action_processing_ms": 0.4209719516267127, "mean_env_wait_ms": 10.177537004016767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 948468, "agent_timesteps_total": 948468, "timers": {"sample_time_ms": 42604.423, "sample_throughput": 281.802, "load_time_ms": 7.854, "load_throughput": 1528641.494, "learn_time_ms": 35446.379, "learn_throughput": 338.709, "update_time_ms": 22.476}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0021387520246207714, "policy_loss": -0.0003150498087052256, "vf_loss": 0.0024538037832826376, "vf_explained_var": 0.5789552927017212, "kl": 7.949682185426354e-06, "entropy": 2.7171733379364014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 948468, "num_agent_steps_sampled": 948468, "num_steps_trained": 948468, "num_agent_steps_trained": 948468}, "done": false, "episodes_total": 474, "training_iteration": 79, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-02-12", "timestamp": 1690844532, "time_this_iter_s": 80.83964896202087, "time_total_s": 6585.502453327179, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6585.502453327179, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.97586206896553, "ram_util_percent": 55.409482758620676}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.8938441803083066, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.815218920977442, "reward_component_totals/dist_change_reward_min": -0.9840589023129497, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.078625259330872, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86252593308646, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1150.23, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5748275862068966, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.983402204003844, -4.039824778127418, -3.889504602025538, -3.880625408015108, -3.882725036330334, -3.580560695235687, -3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8559567240795696, "mean_inference_ms": 8.613153915812967, "mean_action_processing_ms": 0.4207409718174141, "mean_env_wait_ms": 10.171266503833484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 960474, "agent_timesteps_total": 960474, "timers": {"sample_time_ms": 42703.06, "sample_throughput": 281.151, "load_time_ms": 6.647, "load_throughput": 1806328.066, "learn_time_ms": 35590.997, "learn_throughput": 337.332, "update_time_ms": 22.763}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0038746932987123728, "policy_loss": 0.0010868128156289458, "vf_loss": 0.002787880366668105, "vf_explained_var": 0.134579598903656, "kl": 5.709608075221695e-08, "entropy": 2.7885282039642334, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 960474, "num_agent_steps_sampled": 960474, "num_steps_trained": 960474, "num_agent_steps_trained": 960474}, "done": false, "episodes_total": 480, "training_iteration": 80, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-03-31", "timestamp": 1690844611, "time_this_iter_s": 78.86512184143066, "time_total_s": 6664.36757516861, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6664.36757516861, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.97500000000001, "ram_util_percent": 55.42499999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.897475304529676, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8184884957309687, "reward_component_totals/dist_change_reward_min": -0.9840589023129497, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.078986808798714, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89868087987065, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1134.87, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.567151424287856, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9368501108156924, -4.002389967204124, -3.986463838351198, -4.019622192832039, -3.905197794365554, -3.693000366553279, -3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.855486921057714, "mean_inference_ms": 8.605391317322109, "mean_action_processing_ms": 0.42050213643628503, "mean_env_wait_ms": 10.165196008977283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 972480, "agent_timesteps_total": 972480, "timers": {"sample_time_ms": 42435.201, "sample_throughput": 282.925, "load_time_ms": 6.255, "load_throughput": 1919371.165, "learn_time_ms": 35465.673, "learn_throughput": 338.525, "update_time_ms": 22.104}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033067893236875534, "policy_loss": 0.0008504429133608937, "vf_loss": 0.002456346759572625, "vf_explained_var": 0.4745408892631531, "kl": 5.161334684089525e-06, "entropy": 2.6975927352905273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 972480, "num_agent_steps_sampled": 972480, "num_steps_trained": 972480, "num_agent_steps_trained": 972480}, "done": false, "episodes_total": 486, "training_iteration": 81, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-04-57", "timestamp": 1690844697, "time_this_iter_s": 85.62547779083252, "time_total_s": 6749.993052959442, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6749.993052959442, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 99.97723577235773, "ram_util_percent": 55.33983739837398}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.897280439491646, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8196339705105414, "reward_component_totals/dist_change_reward_min": -0.9926844716318103, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.077646468981111, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76464689811033, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1134.36, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1954, "constraint_violation.max_vel_constraint.ratio_mean": 0.5668965517241379, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9765117441279361}, "hist_stats": {"episode_reward": [-3.9955217586891836, -3.8367211467583626, -3.975523908886169, -3.9713322537885936, -3.959246071839046, -3.9034416677972734, -2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8550318133428652, "mean_inference_ms": 8.59739692018373, "mean_action_processing_ms": 0.4202648607751457, "mean_env_wait_ms": 10.15914554047768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 984486, "agent_timesteps_total": 984486, "timers": {"sample_time_ms": 42484.708, "sample_throughput": 282.596, "load_time_ms": 6.371, "load_throughput": 1884420.879, "learn_time_ms": 35502.161, "learn_throughput": 338.177, "update_time_ms": 22.971}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0016274196095764637, "policy_loss": -0.0005712664569728076, "vf_loss": 0.002198687056079507, "vf_explained_var": 0.43107396364212036, "kl": 1.95336906472221e-06, "entropy": 2.6924924850463867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 984486, "num_agent_steps_sampled": 984486, "num_steps_trained": 984486, "num_agent_steps_trained": 984486}, "done": false, "episodes_total": 492, "training_iteration": 82, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-06-14", "timestamp": 1690844774, "time_this_iter_s": 77.18610692024231, "time_total_s": 6827.179159879684, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6827.179159879684, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.97727272727273, "ram_util_percent": 55.34181818181816}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.6960499810619725, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.8959590277168745, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8183999073086813, "reward_component_totals/dist_change_reward_min": -0.9926844716318103, "reward_component_totals/dist_change_reward_max": 0.4068151527699223, "reward_component_totals/delta_v_mean": -2.0775591204082007, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.75591204081928, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1128.52, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5639780109945027, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-2.6960499810619725, -4.021565154643498, -3.8396673437163282, -2.9799008779876512, -3.9532707826077376, -3.822642692227462, -3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.85465584291406, "mean_inference_ms": 8.589451633868693, "mean_action_processing_ms": 0.4200356945258341, "mean_env_wait_ms": 10.153617020125388, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 996492, "agent_timesteps_total": 996492, "timers": {"sample_time_ms": 42719.765, "sample_throughput": 281.041, "load_time_ms": 6.167, "load_throughput": 1946947.121, "learn_time_ms": 35393.048, "learn_throughput": 339.219, "update_time_ms": 22.374}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0034297476522624493, "policy_loss": 0.0007540482911281288, "vf_loss": 0.002675697673112154, "vf_explained_var": 0.473025918006897, "kl": 1.1945063533858047e-06, "entropy": 2.7271456718444824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 996492, "num_agent_steps_sampled": 996492, "num_steps_trained": 996492, "num_agent_steps_trained": 996492}, "done": false, "episodes_total": 498, "training_iteration": 83, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-07-32", "timestamp": 1690844852, "time_this_iter_s": 77.43593764305115, "time_total_s": 6904.615097522736, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6904.615097522736, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.98108108108106, "ram_util_percent": 55.394594594594565}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7472976747170335, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.9167982437824156, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8387443209494134, "reward_component_totals/dist_change_reward_min": -0.9926844716318103, "reward_component_totals/dist_change_reward_max": -0.63335430503043, "reward_component_totals/delta_v_mean": -2.078053922833009, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.023994625359777, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80539228330014, "delta_v_total_min": 202.39946253597705, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1117.15, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.558295852073963, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.7913752613840517, -3.7615128877834607, -4.010245417777822, -3.9406089349640316, -3.888630501248885, -3.822123379857147, -4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8543110586495044, "mean_inference_ms": 8.582069762115623, "mean_action_processing_ms": 0.41982903441547237, "mean_env_wait_ms": 10.148550533867512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1008498, "agent_timesteps_total": 1008498, "timers": {"sample_time_ms": 43038.438, "sample_throughput": 278.96, "load_time_ms": 6.112, "load_throughput": 1964231.784, "learn_time_ms": 35480.124, "learn_throughput": 338.387, "update_time_ms": 22.957}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002617518650367856, "policy_loss": -0.00017868439317680895, "vf_loss": 0.002796201268211007, "vf_explained_var": 0.34616249799728394, "kl": 2.351842340431176e-06, "entropy": 2.746335506439209, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1008498, "num_agent_steps_sampled": 1008498, "num_steps_trained": 1008498, "num_agent_steps_trained": 1008498}, "done": false, "episodes_total": 504, "training_iteration": 84, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-08-52", "timestamp": 1690844932, "time_this_iter_s": 79.72084760665894, "time_total_s": 6984.3359451293945, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6984.3359451293945, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.97894736842107, "ram_util_percent": 55.37719298245613}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.915909083052163, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8353356251256546, "reward_component_totals/dist_change_reward_min": -0.9926844716318103, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0805734579265156, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05734579265078, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1101.26, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5503548225887056, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.06228580559718, -3.8704514535721284, -3.845548910839752, -3.882049924125124, -3.9636525300793437, -3.7617589261063835, -3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.853981498498447, "mean_inference_ms": 8.574685594964217, "mean_action_processing_ms": 0.41964909202309314, "mean_env_wait_ms": 10.143977675792884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1020504, "agent_timesteps_total": 1020504, "timers": {"sample_time_ms": 43251.02, "sample_throughput": 277.589, "load_time_ms": 6.146, "load_throughput": 1953495.404, "learn_time_ms": 35524.775, "learn_throughput": 337.961, "update_time_ms": 24.994}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0021774438209831715, "policy_loss": -0.0004984302213415504, "vf_loss": 0.0026758762542158365, "vf_explained_var": 0.08773223310709, "kl": 7.039496807692558e-08, "entropy": 2.7869298458099365, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1020504, "num_agent_steps_sampled": 1020504, "num_steps_trained": 1020504, "num_agent_steps_trained": 1020504}, "done": false, "episodes_total": 510, "training_iteration": 85, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-10-10", "timestamp": 1690845010, "time_this_iter_s": 78.13820600509644, "time_total_s": 7062.474151134491, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7062.474151134491, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 99.97232142857145, "ram_util_percent": 55.427678571428565}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.9157850429502843, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8353870499802385, "reward_component_totals/dist_change_reward_min": -0.9926844716318103, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0803979929700525, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.03979929700455, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1112.84, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5561419290354823, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.919631856560926, -3.8404844418548363, -3.837063269148554, -4.0098806683201405, -3.914387105521814, -3.9681302783684003, -4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8536712185147222, "mean_inference_ms": 8.567107384159813, "mean_action_processing_ms": 0.41947471565747557, "mean_env_wait_ms": 10.139793486719348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1032510, "agent_timesteps_total": 1032510, "timers": {"sample_time_ms": 43476.735, "sample_throughput": 276.148, "load_time_ms": 5.972, "load_throughput": 2010380.456, "learn_time_ms": 35393.815, "learn_throughput": 339.212, "update_time_ms": 23.344}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031586161348968744, "policy_loss": 0.0005858821095898747, "vf_loss": 0.002572733676061034, "vf_explained_var": 0.24964265525341034, "kl": 5.906112505726924e-07, "entropy": 2.768883466720581, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1032510, "num_agent_steps_sampled": 1032510, "num_steps_trained": 1032510, "num_agent_steps_trained": 1032510}, "done": false, "episodes_total": 516, "training_iteration": 86, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-11-29", "timestamp": 1690845089, "time_this_iter_s": 78.37227201461792, "time_total_s": 7140.846423149109, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7140.846423149109, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 99.97909090909091, "ram_util_percent": 55.45363636363633}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.916210694557234, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8370454286305177, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.079165265926722, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.91652659267152, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1117.29, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5583658170914544, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.017843570471263, -3.9649488838366516, -3.9824919740241427, -3.9645339357992877, -3.9862770678712245, -3.8286941778853905, -3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8521336062105278, "mean_inference_ms": 8.560181062006299, "mean_action_processing_ms": 0.4192923475748321, "mean_env_wait_ms": 10.135436126103528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1044516, "agent_timesteps_total": 1044516, "timers": {"sample_time_ms": 43452.402, "sample_throughput": 276.302, "load_time_ms": 6.055, "load_throughput": 1982942.068, "learn_time_ms": 35641.219, "learn_throughput": 336.857, "update_time_ms": 24.458}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030072475783526897, "policy_loss": 0.0005292754503898323, "vf_loss": 0.002477971138432622, "vf_explained_var": 0.42230385541915894, "kl": 4.1072075873671565e-07, "entropy": 2.7191965579986572, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1044516, "num_agent_steps_sampled": 1044516, "num_steps_trained": 1044516, "num_agent_steps_trained": 1044516}, "done": false, "episodes_total": 522, "training_iteration": 87, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-12-47", "timestamp": 1690845167, "time_this_iter_s": 77.50006794929504, "time_total_s": 7218.346491098404, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7218.346491098404, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.97927927927927, "ram_util_percent": 55.39459459459456}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.9152708151663393, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8360419293214956, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.07922888584485, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.92288858448424, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1113.62, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5565317341329336, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9022934458717193, -3.915979431133274, -4.061535411228377, -3.9259980420622727, -3.817599675983822, -3.8834741266107464, -3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8506116500430578, "mean_inference_ms": 8.553492457616082, "mean_action_processing_ms": 0.41910505967739076, "mean_env_wait_ms": 10.131034449100056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1056522, "agent_timesteps_total": 1056522, "timers": {"sample_time_ms": 43109.548, "sample_throughput": 278.5, "load_time_ms": 6.131, "load_throughput": 1958144.305, "learn_time_ms": 35838.204, "learn_throughput": 335.006, "update_time_ms": 26.352}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003572742687538266, "policy_loss": 0.0007996605709195137, "vf_loss": 0.0027730828151106834, "vf_explained_var": 0.19911552965641022, "kl": 3.1961388913259725e-07, "entropy": 2.7728934288024902, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1056522, "num_agent_steps_sampled": 1056522, "num_steps_trained": 1056522, "num_agent_steps_trained": 1056522}, "done": false, "episodes_total": 528, "training_iteration": 88, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-14-04", "timestamp": 1690845244, "time_this_iter_s": 77.2023241519928, "time_total_s": 7295.548815250397, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7295.548815250397, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.9809090909091, "ram_util_percent": 55.361818181818194}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.916497588664261, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8361845469106943, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.080313041753574, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.03130417535664, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1133.99, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5667116441779111, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.907017457476234, -3.9820749414116183, -3.7716131421355588, -3.961697052075219, -3.9080519100051667, -3.835899361304569, -3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8491187997656926, "mean_inference_ms": 8.546867224148865, "mean_action_processing_ms": 0.41888596835746655, "mean_env_wait_ms": 10.126664938758974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1068528, "agent_timesteps_total": 1068528, "timers": {"sample_time_ms": 42842.239, "sample_throughput": 280.237, "load_time_ms": 6.138, "load_throughput": 1956143.784, "learn_time_ms": 35760.62, "learn_throughput": 335.732, "update_time_ms": 27.192}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0035595959052443504, "policy_loss": 0.000981140066869557, "vf_loss": 0.0025784566532820463, "vf_explained_var": 0.4361237585544586, "kl": 1.4710615232615964e-06, "entropy": 2.7458760738372803, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1068528, "num_agent_steps_sampled": 1068528, "num_steps_trained": 1068528, "num_agent_steps_trained": 1068528}, "done": false, "episodes_total": 534, "training_iteration": 89, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-15-22", "timestamp": 1690845322, "time_this_iter_s": 77.35656666755676, "time_total_s": 7372.9053819179535, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7372.9053819179535, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.97927927927928, "ram_util_percent": 55.46576576576574}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.9201424333645094, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8396024507073772, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.080539982657138, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.05399826571298, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1145.82, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5726236881559221, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.941860379066646, -3.8366382235838277, -3.961629854307393, -3.8361297202655917, -3.9821296065421317, -3.82507052524985, -4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8477086354832333, "mean_inference_ms": 8.540880745556917, "mean_action_processing_ms": 0.41867199720021075, "mean_env_wait_ms": 10.122314264475593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1080534, "agent_timesteps_total": 1080534, "timers": {"sample_time_ms": 42761.513, "sample_throughput": 280.766, "load_time_ms": 6.229, "load_throughput": 1927378.615, "learn_time_ms": 35916.734, "learn_throughput": 334.273, "update_time_ms": 27.895}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0012920615263283253, "policy_loss": -0.0011754482984542847, "vf_loss": 0.0024675072636455297, "vf_explained_var": 0.25315865874290466, "kl": 7.748528787487885e-07, "entropy": 2.737009286880493, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1080534, "num_agent_steps_sampled": 1080534, "num_steps_trained": 1080534, "num_agent_steps_trained": 1080534}, "done": false, "episodes_total": 540, "training_iteration": 90, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-16-42", "timestamp": 1690845402, "time_this_iter_s": 79.6068925857544, "time_total_s": 7452.512274503708, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7452.512274503708, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.97631578947369, "ram_util_percent": 55.39999999999998}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.926114568538361, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.844084290197885, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0820302783404823, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.20302783404748, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1130.22, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5648275862068967, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.068818744053592, -3.8652797973984994, -3.8317035577582343, -3.9474647625215096, -4.018538223631917, -4.041645017316626, -4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8473515960436284, "mean_inference_ms": 8.534879779491305, "mean_action_processing_ms": 0.4184540533396995, "mean_env_wait_ms": 10.117957666771744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1092540, "agent_timesteps_total": 1092540, "timers": {"sample_time_ms": 42903.463, "sample_throughput": 279.838, "load_time_ms": 6.36, "load_throughput": 1887741.046, "learn_time_ms": 36056.2, "learn_throughput": 332.98, "update_time_ms": 30.498}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003229901660233736, "policy_loss": 0.0004850350378546864, "vf_loss": 0.002744868164882064, "vf_explained_var": 0.24464203417301178, "kl": 4.922289917885792e-07, "entropy": 2.7782437801361084, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1092540, "num_agent_steps_sampled": 1092540, "num_steps_trained": 1092540, "num_agent_steps_trained": 1092540}, "done": false, "episodes_total": 546, "training_iteration": 91, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-18-10", "timestamp": 1690845490, "time_this_iter_s": 88.44341254234314, "time_total_s": 7540.955687046051, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7540.955687046051, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.98015873015873, "ram_util_percent": 55.39841269841267}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.922527999766588, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8428406884113171, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0796873113552765, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.96873113552684, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1117.67, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5592056085778249, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.055792822799919, -3.850132523960328, -3.873663556770029, -3.823983229279895, -3.9241300675931936, -3.8730254966488156, -3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8470685099071007, "mean_inference_ms": 8.52941688809825, "mean_action_processing_ms": 0.4182605920987747, "mean_env_wait_ms": 10.113924646518786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1104390, "agent_timesteps_total": 1104390, "timers": {"sample_time_ms": 42910.306, "sample_throughput": 279.429, "load_time_ms": 6.254, "load_throughput": 1917118.366, "learn_time_ms": 36016.907, "learn_throughput": 332.91, "update_time_ms": 32.275}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0028977482579648495, "policy_loss": 0.00021824697614647448, "vf_loss": 0.0026795007288455963, "vf_explained_var": 0.5470711588859558, "kl": 6.574828603334026e-06, "entropy": 2.6984024047851562, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1104390, "num_agent_steps_sampled": 1104390, "num_steps_trained": 1104390, "num_agent_steps_trained": 1104390}, "done": false, "episodes_total": 552, "training_iteration": 92, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-19-27", "timestamp": 1690845567, "time_this_iter_s": 76.94454336166382, "time_total_s": 7617.900230407715, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7617.900230407715, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.97818181818182, "ram_util_percent": 55.35090909090906}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.924098569367185, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8440967573805226, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0800018119866683, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0001811986661, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1119.22, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5599802212714781, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.8729364737772545, -4.026689460253671, -3.8046348777556562, -3.9431481662193812, -3.780473767668938, -3.8533391631014413, -3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8469108227039497, "mean_inference_ms": 8.524078599544353, "mean_action_processing_ms": 0.41808503341224074, "mean_env_wait_ms": 10.110050469665856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1116396, "agent_timesteps_total": 1116396, "timers": {"sample_time_ms": 42931.221, "sample_throughput": 279.293, "load_time_ms": 6.258, "load_throughput": 1915927.886, "learn_time_ms": 36131.174, "learn_throughput": 331.857, "update_time_ms": 31.495}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014036956708878279, "policy_loss": -0.001096098916605115, "vf_loss": 0.0024997934233397245, "vf_explained_var": 0.14038372039794922, "kl": 2.3969038309701318e-08, "entropy": 2.7706854343414307, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1116396, "num_agent_steps_sampled": 1116396, "num_steps_trained": 1116396, "num_agent_steps_trained": 1116396}, "done": false, "episodes_total": 558, "training_iteration": 93, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-20-46", "timestamp": 1690845646, "time_this_iter_s": 78.75951671600342, "time_total_s": 7696.659747123718, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7696.659747123718, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.97927927927927, "ram_util_percent": 55.38108108108108}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.928153732776161, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8480512794574285, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.080102453318738, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.0102453318731, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1105.97, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5533585321160558, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.748082647007905, -3.8618321953593258, -4.004826783895637, -3.948951147342263, -3.9443779247469033, -3.8553443085900385, -3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.846769626194351, "mean_inference_ms": 8.51908842387876, "mean_action_processing_ms": 0.4179286824463441, "mean_env_wait_ms": 10.106325493261362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1128402, "agent_timesteps_total": 1128402, "timers": {"sample_time_ms": 42688.899, "sample_throughput": 280.879, "load_time_ms": 5.99, "load_throughput": 2001647.072, "learn_time_ms": 36108.159, "learn_throughput": 332.069, "update_time_ms": 29.799}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002986665116623044, "policy_loss": 0.0004331835953053087, "vf_loss": 0.002553480677306652, "vf_explained_var": 0.22405754029750824, "kl": 1.4562179728727642e-07, "entropy": 2.758099317550659, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1128402, "num_agent_steps_sampled": 1128402, "num_steps_trained": 1128402, "num_agent_steps_trained": 1128402}, "done": false, "episodes_total": 564, "training_iteration": 94, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-22-04", "timestamp": 1690845724, "time_this_iter_s": 77.09574627876282, "time_total_s": 7773.755493402481, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7773.755493402481, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.39999999999996}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.165154684159928, "episode_reward_mean": -3.9307747661654906, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8523000804707195, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0784746856947773, "reward_component_totals/delta_v_min": -2.194158025383943, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.84746856947697, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 219.41580253839416, "constraint_violation.max_vel_constraint.steps_mean": 1122.85, "constraint_violation.max_vel_constraint.steps_min": 249, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5617943142250015, "constraint_violation.max_vel_constraint.ratio_min": 0.12443778110944528, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.7472976747170335, -4.002180130842568, -4.165154684159928, -3.898425878924723, -3.946652335339386, -4.00052977812316, -3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8466012540617576, "mean_inference_ms": 8.51443447880592, "mean_action_processing_ms": 0.4177639231147252, "mean_env_wait_ms": 10.102340397616187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1140408, "agent_timesteps_total": 1140408, "timers": {"sample_time_ms": 42535.998, "sample_throughput": 281.888, "load_time_ms": 6.971, "load_throughput": 1719963.293, "learn_time_ms": 36119.926, "learn_throughput": 331.961, "update_time_ms": 29.664}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031301372218877077, "policy_loss": 0.0006994752329774201, "vf_loss": 0.0024306592531502247, "vf_explained_var": 0.4098585247993469, "kl": 7.182700301200384e-07, "entropy": 2.700368881225586, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1140408, "num_agent_steps_sampled": 1140408, "num_steps_trained": 1140408, "num_agent_steps_trained": 1140408}, "done": false, "episodes_total": 570, "training_iteration": 95, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-23-21", "timestamp": 1690845801, "time_this_iter_s": 76.73470759391785, "time_total_s": 7850.490200996399, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7850.490200996399, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.98256880733943, "ram_util_percent": 55.4302752293578}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.93241858559853, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8537116836166025, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0787069019819335, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.87069019819262, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1131.07, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5659022602519879, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.915812756890916, -3.971050455302782, -4.0997235008765704, -3.9724220170276157, -4.0175226270397735, -3.7600794613187327, -3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8463761989405918, "mean_inference_ms": 8.510106439600023, "mean_action_processing_ms": 0.4176023215056054, "mean_env_wait_ms": 10.098064296761265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1152414, "agent_timesteps_total": 1152414, "timers": {"sample_time_ms": 42207.441, "sample_throughput": 284.083, "load_time_ms": 6.893, "load_throughput": 1739524.149, "learn_time_ms": 36293.516, "learn_throughput": 330.373, "update_time_ms": 31.792}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0012873394880443811, "policy_loss": -0.001012482913210988, "vf_loss": 0.002299822401255369, "vf_explained_var": 0.5979713797569275, "kl": 9.083934855880216e-06, "entropy": 2.6975550651550293, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1152414, "num_agent_steps_sampled": 1152414, "num_steps_trained": 1152414, "num_agent_steps_trained": 1152414}, "done": false, "episodes_total": 576, "training_iteration": 96, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-24-38", "timestamp": 1690845878, "time_this_iter_s": 76.91814732551575, "time_total_s": 7927.408348321915, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7927.408348321915, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.97363636363637, "ram_util_percent": 55.48272727272725}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.928509316728009, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8495914897024593, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0789178270255557, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89178270255482, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1150.29, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5755074576532873, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9414027742691458, -3.8337570684688007, -3.992080876760661, -4.074912338017706, -3.7698912576504515, -3.9550448792266844, -3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8452163564261697, "mean_inference_ms": 8.506381544338518, "mean_action_processing_ms": 0.41743284711901724, "mean_env_wait_ms": 10.09352581608967, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1164420, "agent_timesteps_total": 1164420, "timers": {"sample_time_ms": 42173.141, "sample_throughput": 284.314, "load_time_ms": 7.157, "load_throughput": 1675323.969, "learn_time_ms": 36379.092, "learn_throughput": 329.596, "update_time_ms": 34.502}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0025796531699597836, "policy_loss": -1.2232330846018158e-05, "vf_loss": 0.0025918830651789904, "vf_explained_var": 0.40682461857795715, "kl": 1.3464471066981787e-06, "entropy": 2.717691659927368, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1164420, "num_agent_steps_sampled": 1164420, "num_steps_trained": 1164420, "num_agent_steps_trained": 1164420}, "done": false, "episodes_total": 582, "training_iteration": 97, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-25-56", "timestamp": 1690845956, "time_this_iter_s": 78.15395832061768, "time_total_s": 8005.562306642532, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8005.562306642532, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.97857142857144, "ram_util_percent": 55.61696428571428}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9263556000584128, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8474071521653519, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.078948447893067, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.024255412469305, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89484478930584, "delta_v_total_min": 202.42554124693046, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1151.63, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5761771228207035, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-3.9525774892549457, -4.028921470368659, -3.878894976274268, -3.9387076935437833, -3.9507056898876636, -3.9270685840269595, -4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.844110548734663, "mean_inference_ms": 8.502730692960327, "mean_action_processing_ms": 0.41726229086711364, "mean_env_wait_ms": 10.088991259690053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1176426, "agent_timesteps_total": 1176426, "timers": {"sample_time_ms": 42375.498, "sample_throughput": 282.956, "load_time_ms": 6.958, "load_throughput": 1723157.402, "learn_time_ms": 36200.958, "learn_throughput": 331.218, "update_time_ms": 34.345}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031502079218626022, "policy_loss": 0.000582779583055526, "vf_loss": 0.00256742793135345, "vf_explained_var": 0.1570228636264801, "kl": 3.6946218529010366e-07, "entropy": 2.764190435409546, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1176426, "num_agent_steps_sampled": 1176426, "num_steps_trained": 1176426, "num_agent_steps_trained": 1176426}, "done": false, "episodes_total": 588, "training_iteration": 98, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-27-14", "timestamp": 1690846034, "time_this_iter_s": 77.4185700416565, "time_total_s": 8082.980876684189, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8082.980876684189, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.65675675675678}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9272634215531186, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8471751211774808, "reward_component_totals/dist_change_reward_min": -0.9947803643109869, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.080088300375644, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00883003756357, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1150.52, "constraint_violation.max_vel_constraint.steps_min": 350, "constraint_violation.max_vel_constraint.steps_max": 1983, "constraint_violation.max_vel_constraint.ratio_mean": 0.5756224001820228, "constraint_violation.max_vel_constraint.ratio_min": 0.17491254372813594, "constraint_violation.max_vel_constraint.ratio_max": 0.9910044977511244}, "hist_stats": {"episode_reward": [-4.065755551235405, -3.7969741489620423, -3.893074333495014, -3.876067322674559, -3.872682629298842, -3.90382210550223, -3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8430025247118034, "mean_inference_ms": 8.49940272520509, "mean_action_processing_ms": 0.4171034260905091, "mean_env_wait_ms": 10.084459056413088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1188432, "agent_timesteps_total": 1188432, "timers": {"sample_time_ms": 42533.252, "sample_throughput": 281.906, "load_time_ms": 7.157, "load_throughput": 1675307.226, "learn_time_ms": 36282.629, "learn_throughput": 330.472, "update_time_ms": 32.404}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014024660922586918, "policy_loss": -0.0009424039162695408, "vf_loss": 0.00234487047418952, "vf_explained_var": 0.4998934864997864, "kl": 2.392572696408024e-06, "entropy": 2.692084312438965, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1188432, "num_agent_steps_sampled": 1188432, "num_steps_trained": 1188432, "num_agent_steps_trained": 1188432}, "done": false, "episodes_total": 594, "training_iteration": 99, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-28-34", "timestamp": 1690846114, "time_this_iter_s": 79.77591371536255, "time_total_s": 8162.756790399551, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8162.756790399551, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.98421052631579, "ram_util_percent": 55.515789473684194}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6264337072155084, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9316103026201286, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8521076659560185, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.514528231062616, "reward_component_totals/delta_v_mean": -2.0795026366641163, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9502636664108, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1136.05, "constraint_violation.max_vel_constraint.steps_min": 388, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5683910158741767, "constraint_violation.max_vel_constraint.ratio_min": 0.19390304847576212, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8346718600625196, -3.8335666002381097, -4.091912418921523, -3.8603628247754624, -3.6264337072155084, -3.906236231151223, -3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8418622173590975, "mean_inference_ms": 8.496250610496586, "mean_action_processing_ms": 0.4169292718774978, "mean_env_wait_ms": 10.079631490785092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1200438, "agent_timesteps_total": 1200438, "timers": {"sample_time_ms": 42306.48, "sample_throughput": 283.418, "load_time_ms": 7.557, "load_throughput": 1586589.059, "learn_time_ms": 36253.94, "learn_throughput": 330.734, "update_time_ms": 31.686}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0032218475826084614, "policy_loss": 0.0007779821171425283, "vf_loss": 0.002443865407258272, "vf_explained_var": 0.2502589821815491, "kl": 2.446349185447616e-07, "entropy": 2.746579647064209, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1200438, "num_agent_steps_sampled": 1200438, "num_steps_trained": 1200438, "num_agent_steps_trained": 1200438}, "done": false, "episodes_total": 600, "training_iteration": 100, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-29-51", "timestamp": 1690846191, "time_this_iter_s": 77.06223893165588, "time_total_s": 8239.819029331207, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8239.819029331207, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.9890909090909, "ram_util_percent": 55.39999999999997}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7747883594663367, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.935161332499758, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8570124490825123, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.0781488834172523, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.81488834172436, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1139.17, "constraint_violation.max_vel_constraint.steps_min": 388, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5699502362639818, "constraint_violation.max_vel_constraint.ratio_min": 0.19390304847576212, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.7846067051257926, -4.043400132672034, -3.7834893913012673, -3.981414142524354, -3.844986492552844, -3.906596374533783, -3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8416157151322952, "mean_inference_ms": 8.492853516788536, "mean_action_processing_ms": 0.41675237271850596, "mean_env_wait_ms": 10.074858775564728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1212444, "agent_timesteps_total": 1212444, "timers": {"sample_time_ms": 42315.0, "sample_throughput": 283.361, "load_time_ms": 7.435, "load_throughput": 1612709.646, "learn_time_ms": 36268.625, "learn_throughput": 330.6, "update_time_ms": 30.261}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027550887316465378, "policy_loss": 0.0002457388036418706, "vf_loss": 0.0025093501899391413, "vf_explained_var": 0.30907654762268066, "kl": 3.5263326481072e-07, "entropy": 2.7614858150482178, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1212444, "num_agent_steps_sampled": 1212444, "num_steps_trained": 1212444, "num_agent_steps_trained": 1212444}, "done": false, "episodes_total": 606, "training_iteration": 101, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-31-20", "timestamp": 1690846280, "time_this_iter_s": 88.65122032165527, "time_total_s": 8328.470249652863, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8328.470249652863, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.97439999999999, "ram_util_percent": 55.48160000000001}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7747883594663367, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9394628911271075, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8604376220086621, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.0790252691184516, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.90252691184435, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1150.03, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5753775226208034, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.8564677488682513, -4.011907013220488, -3.787885671686161, -3.965500239270514, -3.7747883594663367, -3.9474541687375018, -4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8412949068736113, "mean_inference_ms": 8.489505228944136, "mean_action_processing_ms": 0.41657299327646446, "mean_env_wait_ms": 10.069813919040334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1224450, "agent_timesteps_total": 1224450, "timers": {"sample_time_ms": 42192.588, "sample_throughput": 284.552, "load_time_ms": 7.358, "load_throughput": 1631735.102, "learn_time_ms": 36539.545, "learn_throughput": 328.576, "update_time_ms": 28.217}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0035311325918883085, "policy_loss": 0.0008771170978434384, "vf_loss": 0.002654012991115451, "vf_explained_var": 0.36951273679733276, "kl": 1.0483762480362202e-06, "entropy": 2.74403977394104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1224450, "num_agent_steps_sampled": 1224450, "num_steps_trained": 1224450, "num_agent_steps_trained": 1224450}, "done": false, "episodes_total": 612, "training_iteration": 102, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-32-39", "timestamp": 1690846359, "time_this_iter_s": 78.45302391052246, "time_total_s": 8406.923273563385, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8406.923273563385, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 99.97946428571429, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.783919297547144, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.945036785907145, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8652296868966012, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.07980709901055, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9807099010542, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1141.88, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713045591025625, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-4.061742128777997, -3.7931464817858647, -3.923096129143798, -4.031915512558066, -3.999920349955347, -3.9402770585903872, -3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8410540303644864, "mean_inference_ms": 8.486265885652692, "mean_action_processing_ms": 0.41640110970266947, "mean_env_wait_ms": 10.06483905666814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1236456, "agent_timesteps_total": 1236456, "timers": {"sample_time_ms": 42232.026, "sample_throughput": 284.287, "load_time_ms": 7.505, "load_throughput": 1599766.622, "learn_time_ms": 36521.923, "learn_throughput": 328.734, "update_time_ms": 30.009}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033432815689593554, "policy_loss": 0.0009743915870785713, "vf_loss": 0.002368889283388853, "vf_explained_var": 0.41457268595695496, "kl": 1.5742831465104246e-06, "entropy": 2.7220869064331055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1236456, "num_agent_steps_sampled": 1236456, "num_steps_trained": 1236456, "num_agent_steps_trained": 1236456}, "done": false, "episodes_total": 618, "training_iteration": 103, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-33-58", "timestamp": 1690846438, "time_this_iter_s": 79.06405758857727, "time_total_s": 8485.987331151962, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8485.987331151962, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.98318584070799, "ram_util_percent": 55.49911504424779}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.783919297547144, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9408751821861783, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8622572485353706, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.078617933650815, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.86179336508079, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1153.4, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5770616805418428, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.916849336559545, -3.994953144028698, -3.783919297547144, -4.014882484117447, -4.020204144170291, -3.9952044230509998, -3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8408023936932565, "mean_inference_ms": 8.483259885202916, "mean_action_processing_ms": 0.41623356664664435, "mean_env_wait_ms": 10.059964031119796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1248462, "agent_timesteps_total": 1248462, "timers": {"sample_time_ms": 42174.644, "sample_throughput": 284.673, "load_time_ms": 7.932, "load_throughput": 1513584.767, "learn_time_ms": 36519.544, "learn_throughput": 328.755, "update_time_ms": 30.016}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0026105886790901423, "policy_loss": 0.0001672690559644252, "vf_loss": 0.0024433175567537546, "vf_explained_var": 0.4760388135910034, "kl": 1.429840494893142e-06, "entropy": 2.6848723888397217, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1248462, "num_agent_steps_sampled": 1248462, "num_steps_trained": 1248462, "num_agent_steps_trained": 1248462}, "done": false, "episodes_total": 624, "training_iteration": 104, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-35-15", "timestamp": 1690846515, "time_this_iter_s": 76.42522025108337, "time_total_s": 8562.412551403046, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8562.412551403046, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.98636363636362, "ram_util_percent": 55.4990909090909}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7902439631114166, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9442762639195563, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8653266954899702, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.078949568429592, "reward_component_totals/delta_v_min": -2.132235975563523, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89495684295852, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 213.2235975563517, "constraint_violation.max_vel_constraint.steps_mean": 1122.99, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5618642792424926, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.855290109542053, -3.823246533334065, -3.8914524741606495, -4.044159798424369, -3.8813451982984404, -3.990082055556674, -4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8405289413623083, "mean_inference_ms": 8.480285553121917, "mean_action_processing_ms": 0.41608690227965694, "mean_env_wait_ms": 10.055279789787688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1260468, "agent_timesteps_total": 1260468, "timers": {"sample_time_ms": 42215.006, "sample_throughput": 284.401, "load_time_ms": 7.153, "load_throughput": 1678347.87, "learn_time_ms": 36442.077, "learn_throughput": 329.454, "update_time_ms": 29.89}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003469026880338788, "policy_loss": 0.0009024151368066669, "vf_loss": 0.002566613256931305, "vf_explained_var": 0.21068546175956726, "kl": 1.6208016262453384e-08, "entropy": 2.7913296222686768, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1260468, "num_agent_steps_sampled": 1260468, "num_steps_trained": 1260468, "num_agent_steps_trained": 1260468}, "done": false, "episodes_total": 630, "training_iteration": 105, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-36-31", "timestamp": 1690846591, "time_this_iter_s": 76.34755396842957, "time_total_s": 8638.760105371475, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8638.760105371475, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.98715596330274, "ram_util_percent": 55.49908256880734}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7902439631114166, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9437079564685797, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8647211324488334, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.0789868240197533, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8986824019745, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1107.43, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5540881672984647, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-4.032294363825432, -3.8674570495324407, -4.098335309097555, -3.861324358122544, -4.091069947649116, -3.910323334628856, -3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8402574896913098, "mean_inference_ms": 8.477293004185846, "mean_action_processing_ms": 0.4159444224319239, "mean_env_wait_ms": 10.050516868742898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1272474, "agent_timesteps_total": 1272474, "timers": {"sample_time_ms": 42216.957, "sample_throughput": 284.388, "load_time_ms": 7.744, "load_throughput": 1550418.382, "learn_time_ms": 36677.998, "learn_throughput": 327.335, "update_time_ms": 31.015}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0035762437619268894, "policy_loss": 0.0012700366787612438, "vf_loss": 0.002306204056367278, "vf_explained_var": 0.5592108964920044, "kl": 4.367399469629163e-06, "entropy": 2.6643223762512207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1272474, "num_agent_steps_sampled": 1272474, "num_steps_trained": 1272474, "num_agent_steps_trained": 1272474}, "done": false, "episodes_total": 636, "training_iteration": 106, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-37-51", "timestamp": 1690846671, "time_this_iter_s": 79.2792420387268, "time_total_s": 8718.039347410202, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8718.039347410202, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.98849557522125, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7902439631114166, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.939166474193007, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8601857892664009, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.0789806849266124, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.026441775659726, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89806849266046, "delta_v_total_min": 202.6441775659715, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1092.72, "constraint_violation.max_vel_constraint.steps_min": 440, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5467368429606335, "constraint_violation.max_vel_constraint.ratio_min": 0.21989005497251374, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.995902463236855, -4.027652351445125, -4.016359058392123, -3.939364671048576, -3.825432853759217, -3.8678070877396404, -4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8390411037584917, "mean_inference_ms": 8.474871722631512, "mean_action_processing_ms": 0.41581389402119695, "mean_env_wait_ms": 10.045779313610677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1284480, "agent_timesteps_total": 1284480, "timers": {"sample_time_ms": 42197.186, "sample_throughput": 284.521, "load_time_ms": 7.296, "load_throughput": 1645545.336, "learn_time_ms": 36662.307, "learn_throughput": 327.475, "update_time_ms": 28.659}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0037426648195832968, "policy_loss": 0.0009294105693697929, "vf_loss": 0.0028132533188909292, "vf_explained_var": 0.3687492311000824, "kl": 1.1874612937390339e-06, "entropy": 2.724540948867798, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1284480, "num_agent_steps_sampled": 1284480, "num_steps_trained": 1284480, "num_agent_steps_trained": 1284480}, "done": false, "episodes_total": 642, "training_iteration": 107, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-39-09", "timestamp": 1690846749, "time_this_iter_s": 77.72525238990784, "time_total_s": 8795.76459980011, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8795.76459980011, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.98648648648648, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7902439631114166, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.937550317201058, "episode_len_mean": 1999.44, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.99, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8582675418660481, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7084744673377794, "reward_component_totals/delta_v_mean": -2.079282775335017, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.029892707516754, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9282775335009, "delta_v_total_min": 202.98927075167364, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1130.13, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5654324951345465, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-4.058303622869367, -4.008298581059103, -3.8423240000517396, -3.812627080023937, -3.881546040086004, -4.088370006324372, -3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855], "episode_lengths": [2001, 1845, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8378381536874409, "mean_inference_ms": 8.47262192759631, "mean_action_processing_ms": 0.4156743236750634, "mean_env_wait_ms": 10.040937360997047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1296486, "agent_timesteps_total": 1296486, "timers": {"sample_time_ms": 42244.078, "sample_throughput": 284.206, "load_time_ms": 7.249, "load_throughput": 1656305.239, "learn_time_ms": 36720.335, "learn_throughput": 326.958, "update_time_ms": 29.155}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0013150130398571491, "policy_loss": -0.0009156378800980747, "vf_loss": 0.0022306502796709538, "vf_explained_var": 0.4836806356906891, "kl": 1.116400426326436e-06, "entropy": 2.696521043777466, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1296486, "num_agent_steps_sampled": 1296486, "num_steps_trained": 1296486, "num_agent_steps_trained": 1296486}, "done": false, "episodes_total": 648, "training_iteration": 108, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-40-27", "timestamp": 1690846827, "time_this_iter_s": 78.46064782142639, "time_total_s": 8874.225247621536, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8874.225247621536, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.98141592920354, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7902439631114166, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.936124214544127, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.856757779988382, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7113632384031834, "reward_component_totals/delta_v_mean": -2.079366434555752, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.03479229802887, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93664345557443, "delta_v_total_min": 203.47922980288646, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1136.68, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.568055972013993, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.8017329028409264, -3.7902439631114166, -3.99776058340447, -3.9981311613447605, -3.9768514205990693, -3.812806212236774, -3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8366921136223389, "mean_inference_ms": 8.470501812063056, "mean_action_processing_ms": 0.41553165130115993, "mean_env_wait_ms": 10.035940354496548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1308492, "agent_timesteps_total": 1308492, "timers": {"sample_time_ms": 42292.646, "sample_throughput": 283.879, "load_time_ms": 6.869, "load_throughput": 1747936.042, "learn_time_ms": 36444.075, "learn_throughput": 329.436, "update_time_ms": 31.746}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002209421480074525, "policy_loss": -0.00033488369081169367, "vf_loss": 0.0025443064514547586, "vf_explained_var": 0.22535492479801178, "kl": 6.814602215854393e-07, "entropy": 2.7509069442749023, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1308492, "num_agent_steps_sampled": 1308492, "num_steps_trained": 1308492, "num_agent_steps_trained": 1308492}, "done": false, "episodes_total": 654, "training_iteration": 109, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-41-45", "timestamp": 1690846905, "time_this_iter_s": 77.4707396030426, "time_total_s": 8951.695987224579, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8951.695987224579, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.49908256880734}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7932454528315454, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.938840624152604, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8596506026749685, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7221161793035094, "reward_component_totals/delta_v_mean": -2.0791900214776433, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.03479229802887, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9190021477635, "delta_v_total_min": 203.47922980288646, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1150.33, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5748775612193903, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.836211491092327, -4.005071274639125, -3.9973241105626234, -4.0584737405440245, -3.888780489144158, -3.9708073554559684, -4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8355833789892555, "mean_inference_ms": 8.468448577095032, "mean_action_processing_ms": 0.4153705929769677, "mean_env_wait_ms": 10.030869690458793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1320498, "agent_timesteps_total": 1320498, "timers": {"sample_time_ms": 42474.191, "sample_throughput": 282.666, "load_time_ms": 6.384, "load_throughput": 1880711.916, "learn_time_ms": 36506.662, "learn_throughput": 328.871, "update_time_ms": 33.565}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023994462098926306, "policy_loss": 0.00010284040763508528, "vf_loss": 0.0022966049145907164, "vf_explained_var": 0.3468577563762665, "kl": 3.4253642411385954e-07, "entropy": 2.721630573272705, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1320498, "num_agent_steps_sampled": 1320498, "num_steps_trained": 1320498, "num_agent_steps_trained": 1320498}, "done": false, "episodes_total": 660, "training_iteration": 110, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-43-05", "timestamp": 1690846985, "time_this_iter_s": 79.50226402282715, "time_total_s": 9031.198251247406, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9031.198251247406, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.98596491228072, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7932454528315454, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.9367993009364906, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8574617701198993, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7221161793035094, "reward_component_totals/delta_v_mean": -2.0793375308165984, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0202860502898785, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93375308165906, "delta_v_total_min": 202.0286050289868, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1133.17, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5663018490754623, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-4.023839335561678, -4.05755828806548, -3.834843646429959, -3.8496892312178344, -3.916288733513613, -3.91905085476182, -3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8352736128731042, "mean_inference_ms": 8.466227465320886, "mean_action_processing_ms": 0.41520826391249294, "mean_env_wait_ms": 10.02571649907748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1332504, "agent_timesteps_total": 1332504, "timers": {"sample_time_ms": 42547.346, "sample_throughput": 282.18, "load_time_ms": 6.351, "load_throughput": 1890434.002, "learn_time_ms": 36557.872, "learn_throughput": 328.411, "update_time_ms": 33.015}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0025812217500060797, "policy_loss": 9.071914973901585e-05, "vf_loss": 0.002490504179149866, "vf_explained_var": 0.13257816433906555, "kl": 3.265236898641888e-07, "entropy": 2.759061336517334, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1332504, "num_agent_steps_sampled": 1332504, "num_steps_trained": 1332504, "num_agent_steps_trained": 1332504}, "done": false, "episodes_total": 666, "training_iteration": 111, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-44-35", "timestamp": 1690847075, "time_this_iter_s": 89.90122389793396, "time_total_s": 9121.09947514534, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9121.09947514534, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 99.9859375, "ram_util_percent": 55.5}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.112973066986269, "episode_reward_mean": -3.934488934763217, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8567806322911846, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7221161793035094, "reward_component_totals/delta_v_mean": -2.0777083024720384, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7708302472031, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1109.67, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5545577211394302, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.936232327937879, -4.031794784526335, -4.008282657684765, -4.112973066986269, -3.820177987063479, -4.001561068047246, -3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8349794079546482, "mean_inference_ms": 8.464062779236164, "mean_action_processing_ms": 0.41504807938962734, "mean_env_wait_ms": 10.02055679383806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1344510, "agent_timesteps_total": 1344510, "timers": {"sample_time_ms": 42523.899, "sample_throughput": 282.335, "load_time_ms": 6.263, "load_throughput": 1917011.079, "learn_time_ms": 36579.869, "learn_throughput": 328.213, "update_time_ms": 33.933}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002602258464321494, "policy_loss": 9.686507837614045e-05, "vf_loss": 0.002505392534658313, "vf_explained_var": 0.3317526876926422, "kl": 9.491303671893547e-07, "entropy": 2.7223904132843018, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1344510, "num_agent_steps_sampled": 1344510, "num_steps_trained": 1344510, "num_agent_steps_trained": 1344510}, "done": false, "episodes_total": 672, "training_iteration": 112, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-45-53", "timestamp": 1690847153, "time_this_iter_s": 78.38077759742737, "time_total_s": 9199.480252742767, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9199.480252742767, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.48928571428571}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.089055010312289, "episode_reward_mean": -3.9290857258477856, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8517945945773613, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7182700973763835, "reward_component_totals/delta_v_mean": -2.0772911312704316, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72911312704244, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1112.59, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5560169915042479, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.942917878395865, -3.849408857144066, -3.8875197946391475, -3.844098346114527, -3.841164122521871, -3.830016574478863, -3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8346744887544277, "mean_inference_ms": 8.462103476586558, "mean_action_processing_ms": 0.41488065917915684, "mean_env_wait_ms": 10.015484567071365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1356516, "agent_timesteps_total": 1356516, "timers": {"sample_time_ms": 42355.148, "sample_throughput": 283.46, "load_time_ms": 6.221, "load_throughput": 1930008.387, "learn_time_ms": 36601.726, "learn_throughput": 328.017, "update_time_ms": 36.346}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030027739703655243, "policy_loss": 0.0005822130478918552, "vf_loss": 0.002420562319457531, "vf_explained_var": 0.46237391233444214, "kl": 7.452483146153099e-07, "entropy": 2.6970534324645996, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1356516, "num_agent_steps_sampled": 1356516, "num_steps_trained": 1356516, "num_agent_steps_trained": 1356516}, "done": false, "episodes_total": 678, "training_iteration": 113, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-47-11", "timestamp": 1690847231, "time_this_iter_s": 77.51737189292908, "time_total_s": 9276.997624635696, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9276.997624635696, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.97927927927928, "ram_util_percent": 55.39999999999996}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.089055010312289, "episode_reward_mean": -3.929452192822077, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8525787787770046, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7182700973763835, "reward_component_totals/delta_v_mean": -2.076873414045079, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.68734140450718, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1112.78, "constraint_violation.max_vel_constraint.steps_min": 468, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5561119440279859, "constraint_violation.max_vel_constraint.ratio_min": 0.23388305847076463, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.8778053561074994, -4.030096652725236, -3.856329436742414, -3.9163053848578553, -3.910178067478328, -4.068240508959524, -3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8344289706230033, "mean_inference_ms": 8.46021143158575, "mean_action_processing_ms": 0.41471120113472637, "mean_env_wait_ms": 10.010440272533623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1368522, "agent_timesteps_total": 1368522, "timers": {"sample_time_ms": 42391.401, "sample_throughput": 283.218, "load_time_ms": 5.936, "load_throughput": 2022719.429, "learn_time_ms": 36707.06, "learn_throughput": 327.076, "update_time_ms": 37.267}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033976330887526274, "policy_loss": 0.0005665253847837448, "vf_loss": 0.0028311063069850206, "vf_explained_var": 0.33604374527931213, "kl": 8.585943191974366e-07, "entropy": 2.7361788749694824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1368522, "num_agent_steps_sampled": 1368522, "num_steps_trained": 1368522, "num_agent_steps_trained": 1368522}, "done": false, "episodes_total": 684, "training_iteration": 114, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-48-29", "timestamp": 1690847309, "time_this_iter_s": 77.87669658660889, "time_total_s": 9354.874321222305, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9354.874321222305, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.990990990991, "ram_util_percent": 55.493693693693686}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.089055010312289, "episode_reward_mean": -3.9283226734544434, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505730509669212, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7182700973763835, "reward_component_totals/delta_v_mean": -2.077749622487528, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.77496224875216, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1127.71, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5635732133933034, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.869569328490215, -3.949407583555298, -3.9746133748653314, -3.9956491894782022, -3.8159797012141548, -3.9473746169552073, -4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8341496067062866, "mean_inference_ms": 8.458294459305181, "mean_action_processing_ms": 0.4145325748655217, "mean_env_wait_ms": 10.005104718377769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1380528, "agent_timesteps_total": 1380528, "timers": {"sample_time_ms": 42280.885, "sample_throughput": 283.958, "load_time_ms": 5.748, "load_throughput": 2088636.362, "learn_time_ms": 36969.029, "learn_throughput": 324.758, "update_time_ms": 36.63}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002778460504487157, "policy_loss": -7.619812822667882e-05, "vf_loss": 0.0028546589892357588, "vf_explained_var": 0.16223843395709991, "kl": 1.3669412624039978e-07, "entropy": 2.7906858921051025, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1380528, "num_agent_steps_sampled": 1380528, "num_steps_trained": 1380528, "num_agent_steps_trained": 1380528}, "done": false, "episodes_total": 690, "training_iteration": 115, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-49-47", "timestamp": 1690847387, "time_this_iter_s": 77.87683391571045, "time_total_s": 9432.751155138016, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9432.751155138016, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 99.98035714285713, "ram_util_percent": 55.50178571428571}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.089055010312289, "episode_reward_mean": -3.9284824271831145, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8507895404153326, "reward_component_totals/dist_change_reward_min": -0.9989304010706913, "reward_component_totals/dist_change_reward_max": -0.7182700973763835, "reward_component_totals/delta_v_mean": -2.0776928867677875, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.76928867677813, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1128.27, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5638530734632683, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-4.043007215076451, -4.054506942063557, -3.993249710384433, -3.9889460121752753, -4.021336211084194, -3.827041472768842, -3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8339121976200041, "mean_inference_ms": 8.456380214281326, "mean_action_processing_ms": 0.4143639589587921, "mean_env_wait_ms": 9.99993530119588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1392534, "agent_timesteps_total": 1392534, "timers": {"sample_time_ms": 42386.165, "sample_throughput": 283.253, "load_time_ms": 5.342, "load_throughput": 2247460.014, "learn_time_ms": 37010.269, "learn_throughput": 324.396, "update_time_ms": 34.713}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0026541196275502443, "policy_loss": -0.00020674787811003625, "vf_loss": 0.002860867418348789, "vf_explained_var": 0.19034254550933838, "kl": 3.702332662669505e-07, "entropy": 2.7680530548095703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1392534, "num_agent_steps_sampled": 1392534, "num_steps_trained": 1392534, "num_agent_steps_trained": 1392534}, "done": false, "episodes_total": 696, "training_iteration": 116, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-51-08", "timestamp": 1690847468, "time_this_iter_s": 80.67737579345703, "time_total_s": 9513.428530931473, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9513.428530931473, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.55398230088496}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.095602754313177, "episode_reward_mean": -3.926415600599953, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8498472643386441, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0765683362613148, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6568336261308, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1137.41, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1986, "constraint_violation.max_vel_constraint.ratio_mean": 0.5684207896051974, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.992503748125937}, "hist_stats": {"episode_reward": [-3.935057272674516, -3.947180412034313, -3.8508237447395572, -3.9268475170259016, -3.8135533175040477, -4.051752581477582, -3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8328018137833946, "mean_inference_ms": 8.454858931020027, "mean_action_processing_ms": 0.414206747686567, "mean_env_wait_ms": 9.994816885195483, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1404540, "agent_timesteps_total": 1404540, "timers": {"sample_time_ms": 42461.312, "sample_throughput": 282.752, "load_time_ms": 5.902, "load_throughput": 2034388.587, "learn_time_ms": 36913.61, "learn_throughput": 325.246, "update_time_ms": 35.625}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023509757593274117, "policy_loss": -8.273609273601323e-05, "vf_loss": 0.0024337132927030325, "vf_explained_var": 0.44164830446243286, "kl": 1.472163148719119e-06, "entropy": 2.7146050930023193, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1404540, "num_agent_steps_sampled": 1404540, "num_steps_trained": 1404540, "num_agent_steps_trained": 1404540}, "done": false, "episodes_total": 702, "training_iteration": 117, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-52-26", "timestamp": 1690847546, "time_this_iter_s": 77.44349813461304, "time_total_s": 9590.872029066086, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9590.872029066086, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.35945945945943}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.095602754313177, "episode_reward_mean": -3.9276475336312755, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8511752629254796, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.076472270705802, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6472270705795, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1137.82, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5686256871564218, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-3.9237215269309322, -4.089055010312289, -3.9149237927828766, -3.9816428724373027, -3.945093216457429, -4.084843217442495, -4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.831693299947318, "mean_inference_ms": 8.453291805451213, "mean_action_processing_ms": 0.4140358871024579, "mean_env_wait_ms": 9.989578908521835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1416546, "agent_timesteps_total": 1416546, "timers": {"sample_time_ms": 42492.079, "sample_throughput": 282.547, "load_time_ms": 6.094, "load_throughput": 1970164.51, "learn_time_ms": 36811.167, "learn_throughput": 326.151, "update_time_ms": 34.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0019993840251117945, "policy_loss": -0.0002948347828350961, "vf_loss": 0.0022942207287997007, "vf_explained_var": 0.4692327380180359, "kl": 4.26298402089742e-06, "entropy": 2.695185661315918, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1416546, "num_agent_steps_sampled": 1416546, "num_steps_trained": 1416546, "num_agent_steps_trained": 1416546}, "done": false, "episodes_total": 708, "training_iteration": 118, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-53-44", "timestamp": 1690847624, "time_this_iter_s": 77.75256729125977, "time_total_s": 9668.624596357346, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9668.624596357346, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.98288288288288, "ram_util_percent": 55.38468468468465}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.095602754313177, "episode_reward_mean": -3.9231799744633467, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8483350298645767, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0748449445987767, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.484494459877, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1133.86, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5666466766616691, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-4.006477284198176, -3.953715571178604, -4.040659967575328, -3.870603422400995, -3.8999692614409955, -3.8072728209973477, -3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8306060465020388, "mean_inference_ms": 8.451875852629852, "mean_action_processing_ms": 0.4138442183312277, "mean_env_wait_ms": 9.984221703091407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1428552, "agent_timesteps_total": 1428552, "timers": {"sample_time_ms": 42503.267, "sample_throughput": 282.472, "load_time_ms": 6.716, "load_throughput": 1787667.785, "learn_time_ms": 37015.257, "learn_throughput": 324.353, "update_time_ms": 33.821}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002513245912268758, "policy_loss": 0.00017274660058319569, "vf_loss": 0.0023404990788549185, "vf_explained_var": 0.3307160437107086, "kl": 4.2628536789379723e-07, "entropy": 2.72721791267395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1428552, "num_agent_steps_sampled": 1428552, "num_steps_trained": 1428552, "num_agent_steps_trained": 1428552}, "done": false, "episodes_total": 714, "training_iteration": 119, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-55-04", "timestamp": 1690847704, "time_this_iter_s": 79.61189723014832, "time_total_s": 9748.236493587494, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9748.236493587494, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 99.98245614035088, "ram_util_percent": 55.37982456140349}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.095602754313177, "episode_reward_mean": -3.924266397561735, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8490541981723001, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.07521219938944, "reward_component_totals/delta_v_min": -2.141747168054179, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52121993894343, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 214.17471680541814, "constraint_violation.max_vel_constraint.steps_mean": 1136.91, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5681709145427286, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-3.9282650172291653, -3.9341115715333075, -3.8693000985077717, -3.895018519006241, -4.085538678814107, -4.037570703757759, -4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8295443034880854, "mean_inference_ms": 8.450597066822766, "mean_action_processing_ms": 0.4136445763306057, "mean_env_wait_ms": 9.978829587120899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1440558, "agent_timesteps_total": 1440558, "timers": {"sample_time_ms": 42535.539, "sample_throughput": 282.258, "load_time_ms": 6.687, "load_throughput": 1795290.232, "learn_time_ms": 36890.886, "learn_throughput": 325.446, "update_time_ms": 32.377}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0018838329706341028, "policy_loss": -0.0005158997373655438, "vf_loss": 0.0023997335229068995, "vf_explained_var": 0.29854288697242737, "kl": 1.7897416171308578e-07, "entropy": 2.7431070804595947, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1440558, "num_agent_steps_sampled": 1440558, "num_steps_trained": 1440558, "num_agent_steps_trained": 1440558}, "done": false, "episodes_total": 720, "training_iteration": 120, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-56-22", "timestamp": 1690847782, "time_this_iter_s": 78.62308239936829, "time_total_s": 9826.859575986862, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9826.859575986862, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.97767857142857, "ram_util_percent": 55.30624999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.770435062868377, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9240781987810807, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8485109021226286, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0755672966584595, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.55672966584524, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1138.41, "constraint_violation.max_vel_constraint.steps_min": 404, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5689205397301349, "constraint_violation.max_vel_constraint.ratio_min": 0.20189905047476261, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-4.03136044243014, -3.837552174959896, -4.0424024869444155, -4.0316965159055185, -3.917252503130271, -3.8077740587939957, -3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8292678328466803, "mean_inference_ms": 8.449139607094159, "mean_action_processing_ms": 0.4134490548811582, "mean_env_wait_ms": 9.973556030738788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1452564, "agent_timesteps_total": 1452564, "timers": {"sample_time_ms": 42552.697, "sample_throughput": 282.144, "load_time_ms": 7.031, "load_throughput": 1707693.716, "learn_time_ms": 36863.181, "learn_throughput": 325.691, "update_time_ms": 33.094}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0010879719629883766, "policy_loss": -0.001285590580664575, "vf_loss": 0.002373561728745699, "vf_explained_var": 0.5476027727127075, "kl": 7.576326879643602e-06, "entropy": 2.7411179542541504, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1452564, "num_agent_steps_sampled": 1452564, "num_steps_trained": 1452564, "num_agent_steps_trained": 1452564}, "done": false, "episodes_total": 726, "training_iteration": 121, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-57-52", "timestamp": 1690847872, "time_this_iter_s": 89.79619646072388, "time_total_s": 9916.655772447586, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9916.655772447586, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.98124999999999, "ram_util_percent": 55.36093749999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7642613451743285, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9208342514531385, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8453565300555639, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.075477721397582, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54777213975748, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1137.39, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5684107946026987, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-3.9186536019124807, -3.960570013932897, -3.890188873381768, -3.9343063730672085, -3.837246853846718, -3.7932454528315454, -3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8290294136670182, "mean_inference_ms": 8.448006435034351, "mean_action_processing_ms": 0.4132538653896552, "mean_env_wait_ms": 9.968431372272947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1464570, "agent_timesteps_total": 1464570, "timers": {"sample_time_ms": 42713.652, "sample_throughput": 281.081, "load_time_ms": 7.13, "load_throughput": 1683853.373, "learn_time_ms": 36607.061, "learn_throughput": 327.97, "update_time_ms": 32.983}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014849479775875807, "policy_loss": -0.001046554185450077, "vf_loss": 0.0025315035600215197, "vf_explained_var": 0.2527602016925812, "kl": 1.719892424034697e-07, "entropy": 2.746690273284912, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1464570, "num_agent_steps_sampled": 1464570, "num_steps_trained": 1464570, "num_agent_steps_trained": 1464570}, "done": false, "episodes_total": 732, "training_iteration": 122, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_16-59-10", "timestamp": 1690847950, "time_this_iter_s": 77.44815945625305, "time_total_s": 9994.10393190384, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9994.10393190384, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.98288288288289, "ram_util_percent": 55.38738738738735}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7642613451743285, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.922615773576257, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8481926490036256, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.074423124572638, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44231245726306, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1122.28, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1838, "constraint_violation.max_vel_constraint.ratio_mean": 0.5608595702148925, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9185407296351824}, "hist_stats": {"episode_reward": [-3.882918768522118, -4.023054990902868, -3.985904440079519, -3.8842856291158188, -3.9260566134182286, -3.9613119373423067, -3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8288165914425734, "mean_inference_ms": 8.446846044185003, "mean_action_processing_ms": 0.41307886833798674, "mean_env_wait_ms": 9.963726561805105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1476576, "agent_timesteps_total": 1476576, "timers": {"sample_time_ms": 42853.119, "sample_throughput": 280.166, "load_time_ms": 7.532, "load_throughput": 1594024.052, "learn_time_ms": 36458.291, "learn_throughput": 329.308, "update_time_ms": 32.559}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003292419482022524, "policy_loss": 0.001007413724437356, "vf_loss": 0.0022850055247545242, "vf_explained_var": 0.5266472697257996, "kl": 3.049981387448497e-07, "entropy": 2.6891274452209473, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1476576, "num_agent_steps_sampled": 1476576, "num_steps_trained": 1476576, "num_agent_steps_trained": 1476576}, "done": false, "episodes_total": 738, "training_iteration": 123, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-00-28", "timestamp": 1690848028, "time_this_iter_s": 77.53898644447327, "time_total_s": 10071.642918348312, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10071.642918348312, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.39909909909906}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.756431698462233, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9204049687804825, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8479169001288309, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0724880686516594, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.2488068651652, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1100.89, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1798, "constraint_violation.max_vel_constraint.ratio_mean": 0.5501699150424787, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.8985507246376812}, "hist_stats": {"episode_reward": [-3.846181098950457, -3.9625825805730392, -4.007834135556802, -3.8069364205858855, -3.9669486798208498, -3.905176006935127, -3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8286243270774905, "mean_inference_ms": 8.445563722787352, "mean_action_processing_ms": 0.41289529063379216, "mean_env_wait_ms": 9.95908811336324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1488582, "agent_timesteps_total": 1488582, "timers": {"sample_time_ms": 42784.982, "sample_throughput": 280.612, "load_time_ms": 7.723, "load_throughput": 1554654.497, "learn_time_ms": 36364.966, "learn_throughput": 330.153, "update_time_ms": 31.338}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0026933387853205204, "policy_loss": 0.00011321525380481035, "vf_loss": 0.0025801225565373898, "vf_explained_var": 0.36168205738067627, "kl": 1.0919907253992278e-06, "entropy": 2.7226247787475586, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1488582, "num_agent_steps_sampled": 1488582, "num_steps_trained": 1488582, "num_agent_steps_trained": 1488582}, "done": false, "episodes_total": 744, "training_iteration": 124, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-01-44", "timestamp": 1690848104, "time_this_iter_s": 76.18891787528992, "time_total_s": 10147.831836223602, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10147.831836223602, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.98598130841121, "ram_util_percent": 55.35981308411213}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.756431698462233, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9189632341889196, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8470759950228226, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.071887239166104, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.1887239166096, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1077.19, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5383258370814592, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.98026385183166, -3.924392536453583, -3.853009687393583, -3.9190683022866044, -4.046031998897465, -3.944398347895718, -3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8283859280843027, "mean_inference_ms": 8.44401104351464, "mean_action_processing_ms": 0.41270954029529483, "mean_env_wait_ms": 9.95448386613271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1500588, "agent_timesteps_total": 1500588, "timers": {"sample_time_ms": 42783.012, "sample_throughput": 280.625, "load_time_ms": 7.767, "load_throughput": 1545730.672, "learn_time_ms": 36295.54, "learn_throughput": 330.784, "update_time_ms": 31.584}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001700914348475635, "policy_loss": -0.0007237751269713044, "vf_loss": 0.002424687147140503, "vf_explained_var": 0.43748465180397034, "kl": 4.458756848180201e-07, "entropy": 2.718695878982544, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1500588, "num_agent_steps_sampled": 1500588, "num_steps_trained": 1500588, "num_agent_steps_trained": 1500588}, "done": false, "episodes_total": 750, "training_iteration": 125, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-03-02", "timestamp": 1690848182, "time_this_iter_s": 77.07751822471619, "time_total_s": 10224.909354448318, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10224.909354448318, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.98468468468468, "ram_util_percent": 55.36936936936938}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7316812995049538, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9157229742898947, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8431426889617677, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.072580285328134, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.25802853281257, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1057.91, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5286906546726636, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.8896836137324655, -3.9861423083880085, -3.84898265500682, -3.9339282804646314, -3.906457952193168, -4.00168558265843, -3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8280413359884289, "mean_inference_ms": 8.442396302968044, "mean_action_processing_ms": 0.41252242060696337, "mean_env_wait_ms": 9.949801473856201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1512594, "agent_timesteps_total": 1512594, "timers": {"sample_time_ms": 42727.507, "sample_throughput": 280.99, "load_time_ms": 7.666, "load_throughput": 1566171.961, "learn_time_ms": 36212.8, "learn_throughput": 331.54, "update_time_ms": 34.152}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0018989668460562825, "policy_loss": -0.0005438878433778882, "vf_loss": 0.002442853292450309, "vf_explained_var": 0.2417251616716385, "kl": 2.1731611354880442e-07, "entropy": 2.7714247703552246, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1512594, "num_agent_steps_sampled": 1512594, "num_steps_trained": 1512594, "num_agent_steps_trained": 1512594}, "done": false, "episodes_total": 756, "training_iteration": 126, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-04-21", "timestamp": 1690848261, "time_this_iter_s": 79.31494808197021, "time_total_s": 10304.224302530289, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10304.224302530289, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.98141592920355, "ram_util_percent": 55.382300884955725}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7316812995049538, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9149392859203753, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8420854699152878, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0728538160050944, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.2853816005086, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1049.21, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5243428285857071, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.976068041379161, -3.9254337967840183, -3.927446768260485, -3.8154439985515687, -3.820310192678657, -3.807297474607215, -3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8268919945398026, "mean_inference_ms": 8.44111253969637, "mean_action_processing_ms": 0.41234886409327387, "mean_env_wait_ms": 9.945095517841686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1524600, "agent_timesteps_total": 1524600, "timers": {"sample_time_ms": 42530.618, "sample_throughput": 282.291, "load_time_ms": 7.672, "load_throughput": 1564998.922, "learn_time_ms": 36295.71, "learn_throughput": 330.783, "update_time_ms": 32.484}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0029664149042218924, "policy_loss": 0.0004991888417862356, "vf_loss": 0.002467224607244134, "vf_explained_var": 0.22910615801811218, "kl": 1.1123746617158758e-06, "entropy": 2.7568039894104004, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1524600, "num_agent_steps_sampled": 1524600, "num_steps_trained": 1524600, "num_agent_steps_trained": 1524600}, "done": false, "episodes_total": 762, "training_iteration": 127, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-05-38", "timestamp": 1690848338, "time_this_iter_s": 76.30541729927063, "time_total_s": 10380.52971982956, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10380.52971982956, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.98256880733945, "ram_util_percent": 55.35045871559631}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.7316812995049538, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.915941737840802, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413787113271496, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.7092236055733776, "reward_component_totals/delta_v_mean": -2.0745630265136596, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0026171170671825, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.45630265136515, "delta_v_total_min": 200.26171170671728, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1048.44, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1786, "constraint_violation.max_vel_constraint.ratio_mean": 0.5239580209895053, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.8925537231384307}, "hist_stats": {"episode_reward": [-3.9934042002499663, -3.939750132768337, -3.770435062868377, -4.039036409050453, -3.8407148466025554, -3.9531161833136004, -3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8257610005546332, "mean_inference_ms": 8.439676684639291, "mean_action_processing_ms": 0.41216764256609373, "mean_env_wait_ms": 9.940294645687462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1536606, "agent_timesteps_total": 1536606, "timers": {"sample_time_ms": 42412.367, "sample_throughput": 283.078, "load_time_ms": 8.253, "load_throughput": 1454671.908, "learn_time_ms": 36406.741, "learn_throughput": 329.774, "update_time_ms": 33.137}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030220183543860912, "policy_loss": 0.0005005659768357873, "vf_loss": 0.002521451562643051, "vf_explained_var": 0.43477120995521545, "kl": 1.0156647931580665e-06, "entropy": 2.7223997116088867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1536606, "num_agent_steps_sampled": 1536606, "num_steps_trained": 1536606, "num_agent_steps_trained": 1536606}, "done": false, "episodes_total": 768, "training_iteration": 128, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-06-56", "timestamp": 1690848416, "time_this_iter_s": 77.70246434211731, "time_total_s": 10458.232184171677, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10458.232184171677, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 99.9846846846847, "ram_util_percent": 55.39009009009009}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9156420437448416, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8413361892097428, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0743058545351065, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.43058545350985, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1043.05, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.521264367816092, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.838986468085484, -3.876518287009178, -3.9254348913802914, -3.935930324311825, -3.962198897031106, -3.9381354208466144, -3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.824607363471776, "mean_inference_ms": 8.438325451507149, "mean_action_processing_ms": 0.41198309339750266, "mean_env_wait_ms": 9.935448777106307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1548612, "agent_timesteps_total": 1548612, "timers": {"sample_time_ms": 42204.143, "sample_throughput": 284.474, "load_time_ms": 7.676, "load_throughput": 1564075.358, "learn_time_ms": 36423.74, "learn_throughput": 329.62, "update_time_ms": 31.286}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0016042769420892, "policy_loss": -0.0010202107951045036, "vf_loss": 0.0026244877371937037, "vf_explained_var": 0.21433058381080627, "kl": 1.9359492853254778e-07, "entropy": 2.7630040645599365, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1548612, "num_agent_steps_sampled": 1548612, "num_steps_trained": 1548612, "num_agent_steps_trained": 1548612}, "done": false, "episodes_total": 774, "training_iteration": 129, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-08-14", "timestamp": 1690848494, "time_this_iter_s": 77.68445062637329, "time_total_s": 10535.91663479805, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10535.91663479805, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.98648648648648, "ram_util_percent": 55.36666666666666}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9162834951323657, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8424917280110145, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.073791767121358, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37917671213506, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1044.47, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.5219740129935032, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.870110997569199, -3.820847665870103, -3.7899630833392983, -3.8505162060671188, -3.88188563725197, -3.944664739486912, -3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8234835119168054, "mean_inference_ms": 8.436781889550826, "mean_action_processing_ms": 0.4118216927274331, "mean_env_wait_ms": 9.930911017883199, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1560618, "agent_timesteps_total": 1560618, "timers": {"sample_time_ms": 41963.457, "sample_throughput": 286.106, "load_time_ms": 7.525, "load_throughput": 1595397.697, "learn_time_ms": 36615.061, "learn_throughput": 327.898, "update_time_ms": 30.679}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023801689967513084, "policy_loss": -0.00011319555051159114, "vf_loss": 0.0024933647364377975, "vf_explained_var": 0.2799564003944397, "kl": 1.7671920886641601e-06, "entropy": 2.751246690750122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1560618, "num_agent_steps_sampled": 1560618, "num_steps_trained": 1560618, "num_agent_steps_trained": 1560618}, "done": false, "episodes_total": 780, "training_iteration": 130, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-09-32", "timestamp": 1690848572, "time_this_iter_s": 78.07713747024536, "time_total_s": 10613.993772268295, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10613.993772268295, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.9857142857143, "ram_util_percent": 55.38839285714284}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9180048634929285, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8442147394356982, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.073790124057237, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3790124057229, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1039.91, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.5196951524237882, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.9806433078228296, -3.875295762009917, -3.9623967078958886, -3.9011173156399535, -3.9189208126370483, -3.8369759031803596, -3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8230355945368826, "mean_inference_ms": 8.434818015158681, "mean_action_processing_ms": 0.41167045105976874, "mean_env_wait_ms": 9.926523900914562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1572624, "agent_timesteps_total": 1572624, "timers": {"sample_time_ms": 41882.291, "sample_throughput": 286.661, "load_time_ms": 7.262, "load_throughput": 1653178.658, "learn_time_ms": 36568.73, "learn_throughput": 328.313, "update_time_ms": 29.311}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002829028060659766, "policy_loss": 0.00018831274064723402, "vf_loss": 0.00264071230776608, "vf_explained_var": 0.13721482455730438, "kl": 4.7397307412211376e-08, "entropy": 2.7986197471618652, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1572624, "num_agent_steps_sampled": 1572624, "num_steps_trained": 1572624, "num_agent_steps_trained": 1572624}, "done": false, "episodes_total": 786, "training_iteration": 131, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-11-01", "timestamp": 1690848661, "time_this_iter_s": 88.52787375450134, "time_total_s": 10702.521646022797, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10702.521646022797, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.98159999999999, "ram_util_percent": 55.3216}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9167928919491133, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8434041729665807, "reward_component_totals/dist_change_reward_min": -0.9993330069963422, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0733887189825406, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.33887189825336, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1037.08, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.518280859570215, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.928217382956336, -4.028283565677876, -3.920504722724858, -3.935666780249062, -3.999177157431462, -4.095602754313177, -3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8226005284571942, "mean_inference_ms": 8.432927140043143, "mean_action_processing_ms": 0.4115256880901588, "mean_env_wait_ms": 9.92235502194774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1584630, "agent_timesteps_total": 1584630, "timers": {"sample_time_ms": 41940.747, "sample_throughput": 286.261, "load_time_ms": 7.568, "load_throughput": 1586451.109, "learn_time_ms": 36728.154, "learn_throughput": 326.888, "update_time_ms": 28.4}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.004243464674800634, "policy_loss": 0.001472736825235188, "vf_loss": 0.002770728897303343, "vf_explained_var": 0.31638839840888977, "kl": 2.54666645105317e-07, "entropy": 2.7520599365234375, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1584630, "num_agent_steps_sampled": 1584630, "num_steps_trained": 1584630, "num_agent_steps_trained": 1584630}, "done": false, "episodes_total": 792, "training_iteration": 132, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-12-21", "timestamp": 1690848741, "time_this_iter_s": 79.65150189399719, "time_total_s": 10782.173147916794, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10782.173147916794, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 99.98421052631578, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.9142641170604633, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.840972499950095, "reward_component_totals/dist_change_reward_min": -0.995200802331512, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0732916171103746, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.32916171103665, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1042.71, "constraint_violation.max_vel_constraint.steps_min": 402, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.5210944527736132, "constraint_violation.max_vel_constraint.ratio_min": 0.20089955022488756, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.775852145085927, -3.79099853021093, -4.034199041523673, -4.025575276671465, -3.9826550502989404, -4.011743685688408, -3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8221884125559393, "mean_inference_ms": 8.431143090728028, "mean_action_processing_ms": 0.4113633195664306, "mean_env_wait_ms": 9.917937772477536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1596636, "agent_timesteps_total": 1596636, "timers": {"sample_time_ms": 41818.804, "sample_throughput": 287.096, "load_time_ms": 7.194, "load_throughput": 1668997.107, "learn_time_ms": 36916.517, "learn_throughput": 325.22, "update_time_ms": 26.099}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027880347333848476, "policy_loss": 0.0003688099386636168, "vf_loss": 0.0024192265700548887, "vf_explained_var": 0.4049030840396881, "kl": 2.551948909967905e-07, "entropy": 2.7199039459228516, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1596636, "num_agent_steps_sampled": 1596636, "num_steps_trained": 1596636, "num_agent_steps_trained": 1596636}, "done": false, "episodes_total": 798, "training_iteration": 133, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-13-39", "timestamp": 1690848819, "time_this_iter_s": 78.1773567199707, "time_total_s": 10860.350504636765, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10860.350504636765, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.98750000000003, "ram_util_percent": 55.329464285714266}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.110401393653433, "episode_reward_mean": -3.913097535219853, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8386558275571151, "reward_component_totals/dist_change_reward_min": -0.995200802331512, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.074441707662744, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44417076627363, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1034.28, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.5168815592203898, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.880273101670053, -3.945256894394541, -3.869092561318327, -3.9593868552178777, -3.968054328738339, -3.967606897557749, -3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8218343261898269, "mean_inference_ms": 8.429271097167442, "mean_action_processing_ms": 0.41119684360415315, "mean_env_wait_ms": 9.913504819579991, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1608642, "agent_timesteps_total": 1608642, "timers": {"sample_time_ms": 41694.0, "sample_throughput": 287.955, "load_time_ms": 6.963, "load_throughput": 1724359.448, "learn_time_ms": 36857.02, "learn_throughput": 325.745, "update_time_ms": 25.923}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0028845088090747595, "policy_loss": 0.0004915031604468822, "vf_loss": 0.0023930049501359463, "vf_explained_var": 0.527414858341217, "kl": 4.238131168676773e-06, "entropy": 2.6833863258361816, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1608642, "num_agent_steps_sampled": 1608642, "num_steps_trained": 1608642, "num_agent_steps_trained": 1608642}, "done": false, "episodes_total": 804, "training_iteration": 134, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-14-54", "timestamp": 1690848894, "time_this_iter_s": 74.37354230880737, "time_total_s": 10934.724046945572, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10934.724046945572, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.9877358490566, "ram_util_percent": 55.33679245283018}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.914647540682996, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8404548439954195, "reward_component_totals/dist_change_reward_min": -0.995200802331512, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0741926966875828, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.41926966875744, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1022.51, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1928, "constraint_violation.max_vel_constraint.ratio_mean": 0.5109995002498751, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9635182408795602}, "hist_stats": {"episode_reward": [-3.8290666987641813, -4.049901956716901, -3.8496800089282965, -3.8282138288650005, -4.082671578621214, -3.8609824580138783, -3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8214443792002009, "mean_inference_ms": 8.427196459851451, "mean_action_processing_ms": 0.4110332916568364, "mean_env_wait_ms": 9.908875861135295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1620648, "agent_timesteps_total": 1620648, "timers": {"sample_time_ms": 41677.455, "sample_throughput": 288.069, "load_time_ms": 7.806, "load_throughput": 1537978.933, "learn_time_ms": 36736.845, "learn_throughput": 326.811, "update_time_ms": 27.975}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003618973772972822, "policy_loss": 0.0007573700859211385, "vf_loss": 0.0028616045601665974, "vf_explained_var": 0.10141261667013168, "kl": 2.795219522511161e-08, "entropy": 2.7878808975219727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1620648, "num_agent_steps_sampled": 1620648, "num_steps_trained": 1620648, "num_agent_steps_trained": 1620648}, "done": false, "episodes_total": 810, "training_iteration": 135, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-16-10", "timestamp": 1690848970, "time_this_iter_s": 75.82595014572144, "time_total_s": 11010.549997091293, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11010.549997091293, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.9834862385321, "ram_util_percent": 55.311009174311906}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9166197344202227, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8412900697468177, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0753296646734105, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.53296646734034, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1017.37, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5084307846076961, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.994900661372286, -3.8751178464577634, -3.933393895547945, -3.940274197617125, -3.8270466310782503, -3.955315898821328, -4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8211106166952762, "mean_inference_ms": 8.424989434040858, "mean_action_processing_ms": 0.4108774979860436, "mean_env_wait_ms": 9.904361004246793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1632654, "agent_timesteps_total": 1632654, "timers": {"sample_time_ms": 41568.794, "sample_throughput": 288.822, "load_time_ms": 8.685, "load_throughput": 1382331.441, "learn_time_ms": 36434.389, "learn_throughput": 329.524, "update_time_ms": 25.49}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0032022842206060886, "policy_loss": 0.0005125777097418904, "vf_loss": 0.002689707325771451, "vf_explained_var": 0.37750452756881714, "kl": 9.483242138230707e-07, "entropy": 2.7650294303894043, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1632654, "num_agent_steps_sampled": 1632654, "num_steps_trained": 1632654, "num_agent_steps_trained": 1632654}, "done": false, "episodes_total": 816, "training_iteration": 136, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-17-25", "timestamp": 1690849045, "time_this_iter_s": 75.23936796188354, "time_total_s": 11085.789365053177, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11085.789365053177, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 99.98317757009346, "ram_util_percent": 55.388785046728955}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9145598135550244, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8384994611863748, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0760603523686556, "reward_component_totals/delta_v_min": -2.1538652205963915, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6060352368648, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 215.38652205963797, "constraint_violation.max_vel_constraint.steps_mean": 1009.56, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.504527736131934, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-4.034721130306952, -4.110401393653433, -3.840640194317606, -3.9628594626054467, -3.842583944974151, -4.066241859919634, -3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.820091145037265, "mean_inference_ms": 8.423162536357147, "mean_action_processing_ms": 0.41073674867789506, "mean_env_wait_ms": 9.900005991049753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1644660, "agent_timesteps_total": 1644660, "timers": {"sample_time_ms": 41777.33, "sample_throughput": 287.381, "load_time_ms": 8.174, "load_throughput": 1468860.972, "learn_time_ms": 36544.571, "learn_throughput": 328.53, "update_time_ms": 26.437}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017448042053729296, "policy_loss": -0.0006626934045925736, "vf_loss": 0.0024075002875179052, "vf_explained_var": 0.4005284607410431, "kl": 1.112927975555067e-06, "entropy": 2.760948896408081, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1644660, "num_agent_steps_sampled": 1644660, "num_steps_trained": 1644660, "num_agent_steps_trained": 1644660}, "done": false, "episodes_total": 822, "training_iteration": 137, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-18-45", "timestamp": 1690849125, "time_this_iter_s": 79.52346348762512, "time_total_s": 11165.312828540802, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11165.312828540802, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.98157894736843, "ram_util_percent": 55.39736842105261}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.910707929482805, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8355562886419403, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0751516408408714, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5151640840864, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1000.33, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.49991504247876056, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.8893210149318103, -3.982321765617275, -3.7642613451743285, -3.798913518752815, -3.9146921932013825, -4.022435522891211, -3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8190890271271725, "mean_inference_ms": 8.421250692771853, "mean_action_processing_ms": 0.4105919774218648, "mean_env_wait_ms": 9.895633557547887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1656666, "agent_timesteps_total": 1656666, "timers": {"sample_time_ms": 41783.656, "sample_throughput": 287.337, "load_time_ms": 7.599, "load_throughput": 1579935.613, "learn_time_ms": 36867.034, "learn_throughput": 325.657, "update_time_ms": 26.66}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0016114554600790143, "policy_loss": -0.0007307901396416128, "vf_loss": 0.0023422453086823225, "vf_explained_var": 0.39628440141677856, "kl": 1.1196500508958707e-06, "entropy": 2.716237783432007, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1656666, "num_agent_steps_sampled": 1656666, "num_steps_trained": 1656666, "num_agent_steps_trained": 1656666}, "done": false, "episodes_total": 828, "training_iteration": 138, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-20-06", "timestamp": 1690849206, "time_this_iter_s": 80.93785524368286, "time_total_s": 11246.250683784485, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11246.250683784485, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.98189655172413, "ram_util_percent": 55.382758620689636}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.913350409594017, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8372965398990513, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.076053869694971, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60538696949635, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1028.92, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5142028985507247, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.962285446091676, -3.835455943883436, -3.9038292553998106, -3.873665019816862, -3.756431698462233, -4.009156302903551, -3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8181343152171363, "mean_inference_ms": 8.419180613664652, "mean_action_processing_ms": 0.4104453160266342, "mean_env_wait_ms": 9.891403411044552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1668672, "agent_timesteps_total": 1668672, "timers": {"sample_time_ms": 42058.137, "sample_throughput": 285.462, "load_time_ms": 7.789, "load_throughput": 1541472.2, "learn_time_ms": 36895.492, "learn_throughput": 325.406, "update_time_ms": 27.523}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0025477083399891853, "policy_loss": 0.00011330538836773485, "vf_loss": 0.002434401772916317, "vf_explained_var": 0.3211532533168793, "kl": 3.344599690535688e-07, "entropy": 2.7567245960235596, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1668672, "num_agent_steps_sampled": 1668672, "num_steps_trained": 1668672, "num_agent_steps_trained": 1668672}, "done": false, "episodes_total": 834, "training_iteration": 139, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-21-27", "timestamp": 1690849287, "time_this_iter_s": 80.73762822151184, "time_total_s": 11326.988312005997, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11326.988312005997, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.97894736842106, "ram_util_percent": 55.39912280701753}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.6051773232091673, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9127388892791704, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8378618485845195, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.5413741561143781, "reward_component_totals/delta_v_mean": -2.0748770406946573, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48770406946497, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1037.95, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5187156421789105, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9363175502443504, -3.9589659456658524, -3.933240048813189, -3.8483403537143945, -3.944071051441627, -3.913556729391926, -3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8171828038360325, "mean_inference_ms": 8.41706675364622, "mean_action_processing_ms": 0.4103030901447664, "mean_env_wait_ms": 9.887058223384503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1680678, "agent_timesteps_total": 1680678, "timers": {"sample_time_ms": 42188.751, "sample_throughput": 284.578, "load_time_ms": 8.192, "load_throughput": 1465637.526, "learn_time_ms": 36897.676, "learn_throughput": 325.386, "update_time_ms": 26.813}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002460154239088297, "policy_loss": 0.00019899963808711618, "vf_loss": 0.002261154819279909, "vf_explained_var": 0.42794069647789, "kl": 1.1912517265955103e-06, "entropy": 2.691589832305908, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1680678, "num_agent_steps_sampled": 1680678, "num_steps_trained": 1680678, "num_agent_steps_trained": 1680678}, "done": false, "episodes_total": 840, "training_iteration": 140, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-22-47", "timestamp": 1690849367, "time_this_iter_s": 79.44742679595947, "time_total_s": 11406.435738801956, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11406.435738801956, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 99.98070175438598, "ram_util_percent": 55.330701754385956}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.414829410115528, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9114193330948193, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8352538266941578, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.299175045390577, "reward_component_totals/delta_v_mean": -2.0761655064006677, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0208074487249066, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61655064006598, "delta_v_total_min": 202.08074487249013, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1049.59, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5245327336331834, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.8708156507803277, -3.8057614545349576, -3.9273486179713837, -3.8899319591455708, -3.9093604098921615, -3.7316812995049538, -3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.816829526123765, "mean_inference_ms": 8.414585374934545, "mean_action_processing_ms": 0.41017531135139756, "mean_env_wait_ms": 9.882944178158159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1692684, "agent_timesteps_total": 1692684, "timers": {"sample_time_ms": 42078.958, "sample_throughput": 285.321, "load_time_ms": 8.382, "load_throughput": 1432296.223, "learn_time_ms": 37076.802, "learn_throughput": 323.814, "update_time_ms": 25.377}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003504009684547782, "policy_loss": 0.0006763794226571918, "vf_loss": 0.0028276301454752684, "vf_explained_var": 0.26808544993400574, "kl": 6.798654794692993e-07, "entropy": 2.7766835689544678, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1692684, "num_agent_steps_sampled": 1692684, "num_steps_trained": 1692684, "num_agent_steps_trained": 1692684}, "done": false, "episodes_total": 846, "training_iteration": 141, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-24-16", "timestamp": 1690849456, "time_this_iter_s": 89.20097231864929, "time_total_s": 11495.636711120605, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11495.636711120605, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.98425196850395, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.414829410115528, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9172106087645657, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8409664346656005, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": -0.299175045390577, "reward_component_totals/delta_v_mean": -2.0762441740989717, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.6244174098964, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1064.89, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5321789105447275, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9845396709207854, -4.05841571799394, -3.806720455952253, -3.852421180591973, -3.945646940067249, -3.918516702528806, -3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8165052126334817, "mean_inference_ms": 8.412182020268494, "mean_action_processing_ms": 0.4100496010380792, "mean_env_wait_ms": 9.878918463405297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1704690, "agent_timesteps_total": 1704690, "timers": {"sample_time_ms": 41786.068, "sample_throughput": 287.321, "load_time_ms": 8.509, "load_throughput": 1410981.861, "learn_time_ms": 36855.089, "learn_throughput": 325.762, "update_time_ms": 25.158}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0015417621470987797, "policy_loss": -0.0010521556250751019, "vf_loss": 0.0025939189363271, "vf_explained_var": 0.3257122337818146, "kl": 8.34747936551139e-07, "entropy": 2.7543742656707764, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1704690, "num_agent_steps_sampled": 1704690, "num_steps_trained": 1704690, "num_agent_steps_trained": 1704690}, "done": false, "episodes_total": 852, "training_iteration": 142, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-25-31", "timestamp": 1690849531, "time_this_iter_s": 74.50370955467224, "time_total_s": 11570.140420675278, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11570.140420675278, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.97924528301886, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9071297611402036, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8314840757813644, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.075645685358845, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.56456853588378, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1071.18, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5353223388305848, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.9519044732729, -3.9382367652757804, -3.9589292995432137, -3.7752773748036534, -3.811211807532983, -3.9669756622119143, -3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8161784339463523, "mean_inference_ms": 8.409717262802566, "mean_action_processing_ms": 0.409929241700294, "mean_env_wait_ms": 9.875026992874245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1716696, "agent_timesteps_total": 1716696, "timers": {"sample_time_ms": 41748.392, "sample_throughput": 287.58, "load_time_ms": 8.826, "load_throughput": 1360347.884, "learn_time_ms": 36681.254, "learn_throughput": 327.306, "update_time_ms": 26.082}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0013973466120660305, "policy_loss": -0.0012671758886426687, "vf_loss": 0.0026645236648619175, "vf_explained_var": 0.26447150111198425, "kl": 1.9837671061395667e-07, "entropy": 2.784837007522583, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1716696, "num_agent_steps_sampled": 1716696, "num_steps_trained": 1716696, "num_agent_steps_trained": 1716696}, "done": false, "episodes_total": 858, "training_iteration": 143, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-26-47", "timestamp": 1690849607, "time_this_iter_s": 76.05683255195618, "time_total_s": 11646.197253227234, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11646.197253227234, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.3}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9094675491083266, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8333909748354187, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.076076574272914, "reward_component_totals/delta_v_min": -2.1403746133049357, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60765742729066, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 214.03746133049322, "constraint_violation.max_vel_constraint.steps_mean": 1082.24, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1964, "constraint_violation.max_vel_constraint.ratio_mean": 0.5408495752123937, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9815092453773113}, "hist_stats": {"episode_reward": [-3.910505194274676, -3.860425367271091, -3.8714667621016288, -3.951660670911476, -3.932918137891968, -4.0204728263871266, -3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8158060469827382, "mean_inference_ms": 8.407167246586221, "mean_action_processing_ms": 0.4097907950956817, "mean_env_wait_ms": 9.870956093905905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1728702, "agent_timesteps_total": 1728702, "timers": {"sample_time_ms": 41570.822, "sample_throughput": 288.808, "load_time_ms": 8.73, "load_throughput": 1375234.218, "learn_time_ms": 37249.493, "learn_throughput": 322.313, "update_time_ms": 28.483}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0009268195135518909, "policy_loss": -0.0014520910335704684, "vf_loss": 0.0023789110127836466, "vf_explained_var": 0.2550942301750183, "kl": 2.1404146366421628e-07, "entropy": 2.7780020236968994, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1728702, "num_agent_steps_sampled": 1728702, "num_steps_trained": 1728702, "num_agent_steps_trained": 1728702}, "done": false, "episodes_total": 864, "training_iteration": 144, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-28-06", "timestamp": 1690849686, "time_this_iter_s": 78.25906300544739, "time_total_s": 11724.456316232681, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11724.456316232681, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 99.98660714285714, "ram_util_percent": 55.29999999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.907720411246576, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8320887164176124, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.075631694828971, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5631694828963, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1078.89, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1982, "constraint_violation.max_vel_constraint.ratio_mean": 0.5391754122938531, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9905047476261869}, "hist_stats": {"episode_reward": [-3.9997166045546573, -3.9409814305299067, -3.6051773232091673, -4.00722110268449, -4.066091368213877, -3.9695621033410085, -4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8154348834326326, "mean_inference_ms": 8.404701922525724, "mean_action_processing_ms": 0.40964657609149824, "mean_env_wait_ms": 9.866734204204349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1740708, "agent_timesteps_total": 1740708, "timers": {"sample_time_ms": 41615.648, "sample_throughput": 288.497, "load_time_ms": 8.089, "load_throughput": 1484234.575, "learn_time_ms": 37451.435, "learn_throughput": 320.575, "update_time_ms": 29.539}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0035273029934614897, "policy_loss": 0.0010576469358056784, "vf_loss": 0.002469654893502593, "vf_explained_var": 0.35276883840560913, "kl": 6.560291012647212e-07, "entropy": 2.7523550987243652, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1740708, "num_agent_steps_sampled": 1740708, "num_steps_trained": 1740708, "num_agent_steps_trained": 1740708}, "done": false, "episodes_total": 870, "training_iteration": 145, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-29-24", "timestamp": 1690849764, "time_this_iter_s": 78.22163820266724, "time_total_s": 11802.677954435349, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11802.677954435349, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 99.98303571428573, "ram_util_percent": 55.30089285714285}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9068098687936192, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.831203233456051, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.075606635337575, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5606635337567, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1093.04, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1982, "constraint_violation.max_vel_constraint.ratio_mean": 0.5462468765617191, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9905047476261869}, "hist_stats": {"episode_reward": [-4.010985291153773, -3.810371380464507, -3.7642150711183984, -3.9201242131252902, -3.851749149186063, -3.801857386932738, -4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8151011482186925, "mean_inference_ms": 8.402010816667236, "mean_action_processing_ms": 0.4095078584451681, "mean_env_wait_ms": 9.862747739685368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1752714, "agent_timesteps_total": 1752714, "timers": {"sample_time_ms": 41720.816, "sample_throughput": 287.77, "load_time_ms": 7.246, "load_throughput": 1656822.944, "learn_time_ms": 37697.161, "learn_throughput": 318.486, "update_time_ms": 27.812}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0026804576627910137, "policy_loss": 0.00019788221106864512, "vf_loss": 0.0024825751315802336, "vf_explained_var": 0.24293391406536102, "kl": 6.648015755672532e-07, "entropy": 2.754162549972534, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1752714, "num_agent_steps_sampled": 1752714, "num_steps_trained": 1752714, "num_agent_steps_trained": 1752714}, "done": false, "episodes_total": 876, "training_iteration": 146, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-30-43", "timestamp": 1690849843, "time_this_iter_s": 78.68976783752441, "time_total_s": 11881.367722272873, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11881.367722272873, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.98558558558558, "ram_util_percent": 55.372972972972946}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9115107420577084, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8350772766489285, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.076433465408786, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64334654087781, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1112.42, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1982, "constraint_violation.max_vel_constraint.ratio_mean": 0.5559320339830085, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9905047476261869}, "hist_stats": {"episode_reward": [-4.009474346690412, -4.035471125143918, -3.7703191870934103, -3.861253970594258, -3.86601047059645, -3.961730127585878, -3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8141148591287035, "mean_inference_ms": 8.39965342091295, "mean_action_processing_ms": 0.4093792900136247, "mean_env_wait_ms": 9.858946961173636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1764720, "agent_timesteps_total": 1764720, "timers": {"sample_time_ms": 41603.343, "sample_throughput": 288.583, "load_time_ms": 7.103, "load_throughput": 1690319.45, "learn_time_ms": 37709.638, "learn_throughput": 318.38, "update_time_ms": 28.231}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0034933455754071474, "policy_loss": 0.00074768002377823, "vf_loss": 0.0027456635143607855, "vf_explained_var": 0.26602983474731445, "kl": 2.7133532753964573e-08, "entropy": 2.787393569946289, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1764720, "num_agent_steps_sampled": 1764720, "num_steps_trained": 1764720, "num_agent_steps_trained": 1764720}, "done": false, "episodes_total": 882, "training_iteration": 147, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-32-02", "timestamp": 1690849922, "time_this_iter_s": 78.42512321472168, "time_total_s": 11959.792845487595, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11959.792845487595, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.98035714285713, "ram_util_percent": 55.399999999999984}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.909810213701267, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8337404714180446, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0760697422832286, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60697422832214, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1101.79, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1982, "constraint_violation.max_vel_constraint.ratio_mean": 0.5506196901549224, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9905047476261869}, "hist_stats": {"episode_reward": [-3.8222840827640967, -3.9342789631076753, -3.9476632165737406, -3.8221857941768, -3.8743131809784934, -3.962722432345438, -4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8131408395539015, "mean_inference_ms": 8.397434921877009, "mean_action_processing_ms": 0.40923765110184823, "mean_env_wait_ms": 9.854926844336381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1776726, "agent_timesteps_total": 1776726, "timers": {"sample_time_ms": 41500.48, "sample_throughput": 289.298, "load_time_ms": 8.057, "load_throughput": 1490053.76, "learn_time_ms": 37758.256, "learn_throughput": 317.97, "update_time_ms": 27.291}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0003619230992626399, "policy_loss": -0.0020380294881761074, "vf_loss": 0.002399952383711934, "vf_explained_var": 0.44511878490448, "kl": 9.96189669422165e-07, "entropy": 2.711756467819214, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1776726, "num_agent_steps_sampled": 1776726, "num_steps_trained": 1776726, "num_agent_steps_trained": 1776726}, "done": false, "episodes_total": 888, "training_iteration": 148, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-33-22", "timestamp": 1690850002, "time_this_iter_s": 80.4317877292633, "time_total_s": 12040.224633216858, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12040.224633216858, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.98173913043478, "ram_util_percent": 55.43304347826086}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.913311791697134, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8373691844627181, "reward_component_totals/dist_change_reward_min": -0.9939979006736965, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0759426072344223, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.59426072344147, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1109.17, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1982, "constraint_violation.max_vel_constraint.ratio_mean": 0.5543078460769615, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9905047476261869}, "hist_stats": {"episode_reward": [-4.057812777564029, -4.044683233078199, -3.966675091622795, -3.748368158898681, -4.060699224957767, -3.863935189275357, -3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812195168678814, "mean_inference_ms": 8.395118465851557, "mean_action_processing_ms": 0.40909230075173186, "mean_env_wait_ms": 9.851011440160857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1788732, "agent_timesteps_total": 1788732, "timers": {"sample_time_ms": 41137.912, "sample_throughput": 291.848, "load_time_ms": 7.994, "load_throughput": 1501798.748, "learn_time_ms": 37778.036, "learn_throughput": 317.804, "update_time_ms": 28.055}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0032294688280671835, "policy_loss": 0.0005256769945845008, "vf_loss": 0.00270379101857543, "vf_explained_var": 0.4176166355609894, "kl": 1.1915872164536268e-06, "entropy": 2.7543721199035645, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1788732, "num_agent_steps_sampled": 1788732, "num_steps_trained": 1788732, "num_agent_steps_trained": 1788732}, "done": false, "episodes_total": 894, "training_iteration": 149, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-34-40", "timestamp": 1690850080, "time_this_iter_s": 77.30210757255554, "time_total_s": 12117.526740789413, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12117.526740789413, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 99.9790909090909, "ram_util_percent": 55.44454545454543}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9094764626441925, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8333542071152287, "reward_component_totals/dist_change_reward_min": -0.9918380104582961, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0761222555289702, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61222555289626, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1107.97, "constraint_violation.max_vel_constraint.steps_min": 219, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5537081459270365, "constraint_violation.max_vel_constraint.ratio_min": 0.10944527736131934, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.8728154589458472, -3.9611655419632186, -3.9542497587509775, -3.7915003715251725, -3.9152226017675757, -4.017744531792821, -3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8112049213343078, "mean_inference_ms": 8.392813108109685, "mean_action_processing_ms": 0.40895016628337616, "mean_env_wait_ms": 9.84713031746098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1800738, "agent_timesteps_total": 1800738, "timers": {"sample_time_ms": 40979.409, "sample_throughput": 292.976, "load_time_ms": 7.911, "load_throughput": 1517608.014, "learn_time_ms": 37705.096, "learn_throughput": 318.418, "update_time_ms": 30.166}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003215912263840437, "policy_loss": 0.00040066754445433617, "vf_loss": 0.0028152463492006063, "vf_explained_var": 0.3101392090320587, "kl": 3.041594425212679e-07, "entropy": 2.7685060501098633, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1800738, "num_agent_steps_sampled": 1800738, "num_steps_trained": 1800738, "num_agent_steps_trained": 1800738}, "done": false, "episodes_total": 900, "training_iteration": 150, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-35-57", "timestamp": 1690850157, "time_this_iter_s": 77.11682391166687, "time_total_s": 12194.64356470108, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12194.64356470108, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.39999999999996}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.113369280704008, "episode_reward_mean": -3.9126153243363997, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354447277070206, "reward_component_totals/dist_change_reward_min": -0.9918380104582961, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0771705966293847, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71705966293774, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1106.17, "constraint_violation.max_vel_constraint.steps_min": 497, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.552808595702149, "constraint_violation.max_vel_constraint.ratio_min": 0.248375812093953, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.992543886187247, -4.113369280704008, -3.8787555930798434, -3.8270352916796266, -3.881250205211175, -4.089476164437966, -3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8107804849081515, "mean_inference_ms": 8.390306879757008, "mean_action_processing_ms": 0.4088265350730041, "mean_env_wait_ms": 9.843452396480384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1812744, "agent_timesteps_total": 1812744, "timers": {"sample_time_ms": 41259.88, "sample_throughput": 290.985, "load_time_ms": 7.599, "load_throughput": 1579846.392, "learn_time_ms": 37587.279, "learn_throughput": 319.417, "update_time_ms": 33.402}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0032797313760966063, "policy_loss": 0.0005298538017086685, "vf_loss": 0.0027498765848577023, "vf_explained_var": 0.19546550512313843, "kl": 4.250536278505024e-08, "entropy": 2.7811951637268066, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1812744, "num_agent_steps_sampled": 1812744, "num_steps_trained": 1812744, "num_agent_steps_trained": 1812744}, "done": false, "episodes_total": 906, "training_iteration": 151, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-37-28", "timestamp": 1690850248, "time_this_iter_s": 90.87284469604492, "time_total_s": 12285.516409397125, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12285.516409397125, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.98461538461538, "ram_util_percent": 55.4176923076923}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109551112584532, "episode_reward_mean": -3.9088263120815863, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8323688930288685, "reward_component_totals/dist_change_reward_min": -0.9929858711682383, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.076457419052724, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.64574190527162, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1131.37, "constraint_violation.max_vel_constraint.steps_min": 497, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5654022988505747, "constraint_violation.max_vel_constraint.ratio_min": 0.248375812093953, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.906660865116887, -3.840826407319281, -3.9050946396769857, -4.074427621869903, -3.876565550970659, -3.8596461969310383, -3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8103565034125748, "mean_inference_ms": 8.387942166008838, "mean_action_processing_ms": 0.4087049434219802, "mean_env_wait_ms": 9.83985901783977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1824750, "agent_timesteps_total": 1824750, "timers": {"sample_time_ms": 41412.299, "sample_throughput": 289.914, "load_time_ms": 7.362, "load_throughput": 1630868.432, "learn_time_ms": 37681.526, "learn_throughput": 318.618, "update_time_ms": 34.159}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0037403334863483906, "policy_loss": 0.0013667780440300703, "vf_loss": 0.0023735561408102512, "vf_explained_var": 0.4925902187824249, "kl": 2.1661010407569847e-07, "entropy": 2.6926910877227783, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1824750, "num_agent_steps_sampled": 1824750, "num_steps_trained": 1824750, "num_agent_steps_trained": 1824750}, "done": false, "episodes_total": 912, "training_iteration": 152, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-38-45", "timestamp": 1690850325, "time_this_iter_s": 76.9257082939148, "time_total_s": 12362.44211769104, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12362.44211769104, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.98181818181817, "ram_util_percent": 55.483636363636364}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109551112584532, "episode_reward_mean": -3.909436178975214, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8339819936562697, "reward_component_totals/dist_change_reward_min": -0.9942843360534939, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.075454185318951, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.54541853189428, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1137.13, "constraint_violation.max_vel_constraint.steps_min": 509, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5682808595702148, "constraint_violation.max_vel_constraint.ratio_min": 0.2543728135932034, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.983662798119646, -3.8608716377474885, -3.94196122381907, -3.7973496367870005, -3.879914374599183, -3.942299844128036, -3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8099586467668407, "mean_inference_ms": 8.385530740132852, "mean_action_processing_ms": 0.4085799282506087, "mean_env_wait_ms": 9.836174148151102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1836756, "agent_timesteps_total": 1836756, "timers": {"sample_time_ms": 41483.054, "sample_throughput": 289.419, "load_time_ms": 6.949, "load_throughput": 1727702.067, "learn_time_ms": 38016.497, "learn_throughput": 315.81, "update_time_ms": 34.77}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033894984517246485, "policy_loss": 0.0009333339985460043, "vf_loss": 0.002456163289025426, "vf_explained_var": 0.21789948642253876, "kl": 4.8974548860769573e-08, "entropy": 2.773630142211914, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1836756, "num_agent_steps_sampled": 1836756, "num_steps_trained": 1836756, "num_agent_steps_trained": 1836756}, "done": false, "episodes_total": 918, "training_iteration": 153, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-40-06", "timestamp": 1690850406, "time_this_iter_s": 80.11006832122803, "time_total_s": 12442.552186012268, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12442.552186012268, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 99.98070175438598, "ram_util_percent": 55.409649122807}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109551112584532, "episode_reward_mean": -3.9102318192949634, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8354126724969118, "reward_component_totals/dist_change_reward_min": -0.9954337181918086, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.074819146798058, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.48191467980504, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1126.5, "constraint_violation.max_vel_constraint.steps_min": 409, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5629685157421289, "constraint_violation.max_vel_constraint.ratio_min": 0.20439780109945027, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.9205790235158062, -3.9178382218678465, -3.7876278040327156, -4.0240003104117354, -3.801103855703328, -3.9276481121961426, -4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8095621234643215, "mean_inference_ms": 8.383047115752639, "mean_action_processing_ms": 0.4084458186233102, "mean_env_wait_ms": 9.832513055922684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1848762, "agent_timesteps_total": 1848762, "timers": {"sample_time_ms": 41760.942, "sample_throughput": 287.494, "load_time_ms": 6.904, "load_throughput": 1738996.382, "learn_time_ms": 37865.115, "learn_throughput": 317.073, "update_time_ms": 33.138}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003242266131564975, "policy_loss": 0.0009580975747667253, "vf_loss": 0.002284168964251876, "vf_explained_var": 0.5192127227783203, "kl": 5.009531378163956e-06, "entropy": 2.7033629417419434, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1848762, "num_agent_steps_sampled": 1848762, "num_steps_trained": 1848762, "num_agent_steps_trained": 1848762}, "done": false, "episodes_total": 924, "training_iteration": 154, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-41-25", "timestamp": 1690850485, "time_this_iter_s": 79.51737117767334, "time_total_s": 12522.069557189941, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12522.069557189941, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.99017857142857, "ram_util_percent": 55.435714285714276}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109551112584532, "episode_reward_mean": -3.9124341348206975, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8375572345679998, "reward_component_totals/dist_change_reward_min": -0.9954337181918086, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0748769002527037, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.4876900252696, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1144.88, "constraint_violation.max_vel_constraint.steps_min": 409, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5721539230384808, "constraint_violation.max_vel_constraint.ratio_min": 0.20439780109945027, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-4.0412064810432105, -4.057993617807001, -3.7861788466142, -4.022062458326049, -3.801443451146304, -3.881799765270281, -3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8091314298534131, "mean_inference_ms": 8.380547271004744, "mean_action_processing_ms": 0.40830923670519526, "mean_env_wait_ms": 9.82856350742671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1860768, "agent_timesteps_total": 1860768, "timers": {"sample_time_ms": 41780.234, "sample_throughput": 287.361, "load_time_ms": 6.841, "load_throughput": 1755124.858, "learn_time_ms": 38044.324, "learn_throughput": 315.579, "update_time_ms": 30.734}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002956935903057456, "policy_loss": 0.0005350378924049437, "vf_loss": 0.0024218973703682423, "vf_explained_var": 0.3988853394985199, "kl": 1.2931914170621894e-06, "entropy": 2.7329230308532715, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1860768, "num_agent_steps_sampled": 1860768, "num_steps_trained": 1860768, "num_agent_steps_trained": 1860768}, "done": false, "episodes_total": 930, "training_iteration": 155, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-42-46", "timestamp": 1690850566, "time_this_iter_s": 80.20646405220032, "time_total_s": 12602.276021242142, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12602.276021242142, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.98608695652173, "ram_util_percent": 55.446086956521725}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109551112584532, "episode_reward_mean": -3.9131366908440732, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8386763554841061, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0744603353599746, "reward_component_totals/delta_v_min": -2.130001344780125, "reward_component_totals/delta_v_max": -2.0246160048743156, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.44603353599666, "delta_v_total_min": 202.46160048743081, "delta_v_total_max": 213.00013447801186, "constraint_violation.max_vel_constraint.steps_mean": 1156.91, "constraint_violation.max_vel_constraint.steps_min": 409, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5781659170414793, "constraint_violation.max_vel_constraint.ratio_min": 0.20439780109945027, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.8442017847841488, -3.9747852409567614, -3.894473807941087, -3.8829675849743968, -3.414829410115528, -4.071602388361751, -4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.808695726056985, "mean_inference_ms": 8.378072017820205, "mean_action_processing_ms": 0.4081680015693546, "mean_env_wait_ms": 9.824420550753912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1872774, "agent_timesteps_total": 1872774, "timers": {"sample_time_ms": 41639.134, "sample_throughput": 288.335, "load_time_ms": 7.79, "load_throughput": 1541208.004, "learn_time_ms": 37843.854, "learn_throughput": 317.251, "update_time_ms": 33.642}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027316801715642214, "policy_loss": 0.0003860201104544103, "vf_loss": 0.0023456583730876446, "vf_explained_var": 0.4765837490558624, "kl": 6.794098226237111e-07, "entropy": 2.7479708194732666, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1872774, "num_agent_steps_sampled": 1872774, "num_steps_trained": 1872774, "num_agent_steps_trained": 1872774}, "done": false, "episodes_total": 936, "training_iteration": 156, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-44-01", "timestamp": 1690850641, "time_this_iter_s": 75.29658222198486, "time_total_s": 12677.572603464127, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12677.572603464127, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.98224299065421, "ram_util_percent": 55.41028037383175}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9205590472162903, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8437140795465488, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.0768449676697487, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.028967212537929, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.68449676697412, "delta_v_total_min": 202.89672125379207, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1171.15, "constraint_violation.max_vel_constraint.steps_min": 409, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5852823588205895, "constraint_violation.max_vel_constraint.ratio_min": 0.20439780109945027, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-4.038440447690007, -3.911349546104968, -3.9670815675732882, -3.999232700990706, -4.0968322761476, -3.923492785075608, -4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076813790348003, "mean_inference_ms": 8.375920164751049, "mean_action_processing_ms": 0.4080224487906818, "mean_env_wait_ms": 9.820200141283578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1884780, "agent_timesteps_total": 1884780, "timers": {"sample_time_ms": 41606.943, "sample_throughput": 288.558, "load_time_ms": 7.664, "load_throughput": 1566605.602, "learn_time_ms": 37800.753, "learn_throughput": 317.613, "update_time_ms": 36.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 6.0752034187316895e-05, "policy_loss": -0.0018855660455301404, "vf_loss": 0.0019463177304714918, "vf_explained_var": 0.7311305999755859, "kl": 2.2437563984567532e-06, "entropy": 2.5636954307556152, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1884780, "num_agent_steps_sampled": 1884780, "num_steps_trained": 1884780, "num_agent_steps_trained": 1884780}, "done": false, "episodes_total": 942, "training_iteration": 157, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-45-19", "timestamp": 1690850719, "time_this_iter_s": 77.71503067016602, "time_total_s": 12755.287634134293, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12755.287634134293, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 99.98828828828827, "ram_util_percent": 55.48378378378376}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.915512141455335, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8381387168373928, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.07737342461795, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.028967212537929, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73734246179419, "delta_v_total_min": 202.89672125379207, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1187.93, "constraint_violation.max_vel_constraint.steps_min": 409, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5936681659170415, "constraint_violation.max_vel_constraint.ratio_min": 0.20439780109945027, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-4.012157414821704, -4.006971426334552, -3.8790426884450397, -3.79553036797949, -4.051286322392588, -3.8867078220914637, -3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8067053423818007, "mean_inference_ms": 8.373979479197024, "mean_action_processing_ms": 0.40788182856578337, "mean_env_wait_ms": 9.815961454856035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1896786, "agent_timesteps_total": 1896786, "timers": {"sample_time_ms": 41578.308, "sample_throughput": 288.756, "load_time_ms": 6.692, "load_throughput": 1794062.184, "learn_time_ms": 37688.453, "learn_throughput": 318.559, "update_time_ms": 41.366}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002906651236116886, "policy_loss": 0.0003941094328183681, "vf_loss": 0.0025125425308942795, "vf_explained_var": 0.20320211350917816, "kl": 1.3024245504311693e-07, "entropy": 2.7687082290649414, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1896786, "num_agent_steps_sampled": 1896786, "num_steps_trained": 1896786, "num_agent_steps_trained": 1896786}, "done": false, "episodes_total": 948, "training_iteration": 158, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-46-38", "timestamp": 1690850798, "time_this_iter_s": 78.99159097671509, "time_total_s": 12834.279225111008, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12834.279225111008, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.98495575221239, "ram_util_percent": 55.469026548672566}, "trial_id": "b1188_00000"}
{"episode_reward_max": -2.8750057535462026, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9162484081735975, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8369474925633087, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": 0.20743369141296575, "reward_component_totals/delta_v_mean": -2.079300915610297, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.028967212537929, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.93009156102897, "delta_v_total_min": 202.89672125379207, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1175.52, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5874662668665667, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.921938288363552, -2.8750057535462026, -3.924244322841043, -3.8989933963839274, -4.001007719789483, -3.947473653514733, -3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8057803789023237, "mean_inference_ms": 8.37204219510027, "mean_action_processing_ms": 0.40774470098730803, "mean_env_wait_ms": 9.811931724409643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1908792, "agent_timesteps_total": 1908792, "timers": {"sample_time_ms": 41801.622, "sample_throughput": 287.214, "load_time_ms": 6.678, "load_throughput": 1797744.959, "learn_time_ms": 37877.53, "learn_throughput": 316.969, "update_time_ms": 44.808}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003219720209017396, "policy_loss": 0.0008860899251885712, "vf_loss": 0.002333629410713911, "vf_explained_var": 0.4723320007324219, "kl": 1.913745109050069e-06, "entropy": 2.7350449562072754, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1908792, "num_agent_steps_sampled": 1908792, "num_steps_trained": 1908792, "num_agent_steps_trained": 1908792}, "done": false, "episodes_total": 954, "training_iteration": 159, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-48-00", "timestamp": 1690850880, "time_this_iter_s": 81.46819376945496, "time_total_s": 12915.747418880463, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12915.747418880463, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.98974358974358, "ram_util_percent": 55.54786324786326}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9240005610732283, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8444876910028947, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0795128700703414, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.0163967896004578, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9512870070334, "delta_v_total_min": 201.6396789600452, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1167.98, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5836981509245377, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.953750437053489, -3.9497805199763123, -3.7800544702176806, -4.004247378901042, -3.9719930201632483, -3.780052829487053, -3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.804866904385246, "mean_inference_ms": 8.370340985245026, "mean_action_processing_ms": 0.40761151083489144, "mean_env_wait_ms": 9.8078866722029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1920798, "agent_timesteps_total": 1920798, "timers": {"sample_time_ms": 42060.972, "sample_throughput": 285.443, "load_time_ms": 6.476, "load_throughput": 1853813.842, "learn_time_ms": 37894.212, "learn_throughput": 316.829, "update_time_ms": 45.826}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002822439419105649, "policy_loss": 0.0005533701041713357, "vf_loss": 0.0022690673358738422, "vf_explained_var": 0.5083956718444824, "kl": 2.1896771613683086e-06, "entropy": 2.6980040073394775, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1920798, "num_agent_steps_sampled": 1920798, "num_steps_trained": 1920798, "num_agent_steps_trained": 1920798}, "done": false, "episodes_total": 960, "training_iteration": 160, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-49-20", "timestamp": 1690850960, "time_this_iter_s": 79.86134696006775, "time_total_s": 12995.60876584053, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12995.60876584053, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.98070175438596, "ram_util_percent": 55.41842105263157}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9257443814901394, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8467997185059314, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0789446629842154, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.0163967896004578, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.89446629842084, "delta_v_total_min": 201.6396789600452, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1170.13, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5847726136931535, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.883249826430286, -3.835576990256376, -3.9748534662531876, -3.927009040072816, -4.01617651490762, -3.893698241694178, -3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8045057409007184, "mean_inference_ms": 8.368557322792393, "mean_action_processing_ms": 0.40749570720459793, "mean_env_wait_ms": 9.804149412636704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1932804, "agent_timesteps_total": 1932804, "timers": {"sample_time_ms": 41641.297, "sample_throughput": 288.32, "load_time_ms": 6.581, "load_throughput": 1824323.944, "learn_time_ms": 38074.914, "learn_throughput": 315.326, "update_time_ms": 43.55}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002793935127556324, "policy_loss": 0.00031277802190743387, "vf_loss": 0.002481155563145876, "vf_explained_var": 0.3374394178390503, "kl": 7.077475743244577e-07, "entropy": 2.704192876815796, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1932804, "num_agent_steps_sampled": 1932804, "num_steps_trained": 1932804, "num_agent_steps_trained": 1932804}, "done": false, "episodes_total": 966, "training_iteration": 161, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-50-49", "timestamp": 1690851049, "time_this_iter_s": 88.52315592765808, "time_total_s": 13084.131921768188, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13084.131921768188, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.98720000000002, "ram_util_percent": 55.45439999999998}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9237049127129495, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8456496124642912, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0780553002486655, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.80553002486587, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1162.58, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.580999500249875, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.854690373835968, -3.8043608924707355, -4.055328976822244, -3.8734406875066343, -3.885708664527427, -4.0660921962200485, -4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8041797494274174, "mean_inference_ms": 8.366772937263633, "mean_action_processing_ms": 0.4073754435446405, "mean_env_wait_ms": 9.800366647523692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1944810, "agent_timesteps_total": 1944810, "timers": {"sample_time_ms": 41483.833, "sample_throughput": 289.414, "load_time_ms": 6.78, "load_throughput": 1770857.557, "learn_time_ms": 38432.574, "learn_throughput": 312.391, "update_time_ms": 44.484}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030033662915229797, "policy_loss": 0.0007448819815181196, "vf_loss": 0.002258485648781061, "vf_explained_var": 0.36456143856048584, "kl": 1.657078200878459e-06, "entropy": 2.7145230770111084, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1944810, "num_agent_steps_sampled": 1944810, "num_steps_trained": 1944810, "num_agent_steps_trained": 1944810}, "done": false, "episodes_total": 972, "training_iteration": 162, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-52-08", "timestamp": 1690851128, "time_this_iter_s": 78.92819404602051, "time_total_s": 13163.060115814209, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13163.060115814209, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 99.98141592920354, "ram_util_percent": 55.39734513274335}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.923237425376048, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8433420667897411, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.079895358586315, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98953585863075, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1139.0, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.569215392303848, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-4.001356855946112, -3.8392555707420737, -3.9320326598279705, -3.904943871126008, -4.011349165617658, -3.757122122595759, -3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8038545665795305, "mean_inference_ms": 8.365079364630656, "mean_action_processing_ms": 0.40724665975808555, "mean_env_wait_ms": 9.79650429083572, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1956816, "agent_timesteps_total": 1956816, "timers": {"sample_time_ms": 41347.206, "sample_throughput": 290.37, "load_time_ms": 6.833, "load_throughput": 1757096.832, "learn_time_ms": 38411.849, "learn_throughput": 312.56, "update_time_ms": 42.912}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027225883677601814, "policy_loss": 0.0002439614909235388, "vf_loss": 0.002478624926880002, "vf_explained_var": 0.41705042123794556, "kl": 2.1148907762835734e-06, "entropy": 2.7571191787719727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1956816, "num_agent_steps_sampled": 1956816, "num_steps_trained": 1956816, "num_agent_steps_trained": 1956816}, "done": false, "episodes_total": 978, "training_iteration": 163, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-53-27", "timestamp": 1690851207, "time_this_iter_s": 78.53278064727783, "time_total_s": 13241.592896461487, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13241.592896461487, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.456250000000004}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.928861368118391, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8488382042643129, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0800231638540856, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 208.00231638540782, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1147.96, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5736931534232883, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.9303245729570273, -3.793450505797901, -3.868056563614681, -3.9739034614771604, -3.8802633830387827, -3.975611177804134, -4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8034982750519, "mean_inference_ms": 8.363360736899446, "mean_action_processing_ms": 0.40712080949104323, "mean_env_wait_ms": 9.79266664228959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1968822, "agent_timesteps_total": 1968822, "timers": {"sample_time_ms": 41327.105, "sample_throughput": 290.512, "load_time_ms": 7.284, "load_throughput": 1648259.949, "learn_time_ms": 38452.095, "learn_throughput": 312.233, "update_time_ms": 43.299}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002866881899535656, "policy_loss": 0.0003822407452389598, "vf_loss": 0.002484640572220087, "vf_explained_var": 0.24029022455215454, "kl": 1.506464286649134e-07, "entropy": 2.7622766494750977, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1968822, "num_agent_steps_sampled": 1968822, "num_steps_trained": 1968822, "num_agent_steps_trained": 1968822}, "done": false, "episodes_total": 984, "training_iteration": 164, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-54-47", "timestamp": 1690851287, "time_this_iter_s": 79.74442887306213, "time_total_s": 13321.337325334549, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13321.337325334549, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.98771929824561, "ram_util_percent": 55.49210526315789}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9303836139467996, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8505398024859709, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0798438114608357, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.98438114608285, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1130.25, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5648425787106447, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-4.047757345732361, -3.9759912111175346, -3.862339992705616, -3.9716423591345, -3.8789542449325447, -3.8142994296802355, -3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8031659043806847, "mean_inference_ms": 8.361593007910647, "mean_action_processing_ms": 0.40700095487330207, "mean_env_wait_ms": 9.788900359571818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1980828, "agent_timesteps_total": 1980828, "timers": {"sample_time_ms": 41228.583, "sample_throughput": 291.206, "load_time_ms": 7.164, "load_throughput": 1675851.168, "learn_time_ms": 38245.378, "learn_throughput": 313.92, "update_time_ms": 43.507}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0015715360641479492, "policy_loss": -0.0010913750156760216, "vf_loss": 0.00266291038133204, "vf_explained_var": 0.14274977147579193, "kl": 5.4334659438382005e-08, "entropy": 2.7955610752105713, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1980828, "num_agent_steps_sampled": 1980828, "num_steps_trained": 1980828, "num_agent_steps_trained": 1980828}, "done": false, "episodes_total": 990, "training_iteration": 165, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-56-04", "timestamp": 1690851364, "time_this_iter_s": 77.1832537651062, "time_total_s": 13398.520579099655, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13398.520579099655, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.98468468468468, "ram_util_percent": 55.46126126126126}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.929096697855367, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8491473080400411, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0799493898153334, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9949389815326, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1139.49, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1990, "constraint_violation.max_vel_constraint.ratio_mean": 0.5694602698650675, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9945027486256871}, "hist_stats": {"episode_reward": [-3.89552186977321, -3.8482153919284894, -3.9249899452720003, -3.996659888516266, -4.078431471944323, -3.9751478951146746, -3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8028176387204287, "mean_inference_ms": 8.359957557432839, "mean_action_processing_ms": 0.4068796353579715, "mean_env_wait_ms": 9.785006670223526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1992834, "agent_timesteps_total": 1992834, "timers": {"sample_time_ms": 41290.341, "sample_throughput": 290.77, "load_time_ms": 6.736, "load_throughput": 1782472.676, "learn_time_ms": 38623.887, "learn_throughput": 310.844, "update_time_ms": 43.315}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001475589582696557, "policy_loss": -0.0007484200177714229, "vf_loss": 0.002224009484052658, "vf_explained_var": 0.5134652256965637, "kl": 2.5595397801225772e-06, "entropy": 2.685783863067627, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1992834, "num_agent_steps_sampled": 1992834, "num_steps_trained": 1992834, "num_agent_steps_trained": 1992834}, "done": false, "episodes_total": 996, "training_iteration": 166, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-57-24", "timestamp": 1690851444, "time_this_iter_s": 79.68713426589966, "time_total_s": 13478.207713365555, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13478.207713365555, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 99.98407079646017, "ram_util_percent": 55.41238938053096}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9258577851690295, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8467258817714939, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0791319033975433, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9131903397536, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1124.73, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5620839580209895, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-3.8402085588640222, -4.0678588793420225, -3.856210012835187, -4.008727615866044, -3.8272231113613753, -3.8941781657492234, -3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8018905275251569, "mean_inference_ms": 8.358678187236508, "mean_action_processing_ms": 0.4067450730621753, "mean_env_wait_ms": 9.780954605756362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2004840, "agent_timesteps_total": 2004840, "timers": {"sample_time_ms": 41452.572, "sample_throughput": 289.632, "load_time_ms": 6.961, "load_throughput": 1724802.414, "learn_time_ms": 38569.941, "learn_throughput": 311.279, "update_time_ms": 39.329}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.001972525380551815, "policy_loss": -0.0007221716223284602, "vf_loss": 0.002694696420803666, "vf_explained_var": 0.3398301601409912, "kl": 7.799325629775922e-08, "entropy": 2.698282480239868, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2004840, "num_agent_steps_sampled": 2004840, "num_steps_trained": 2004840, "num_agent_steps_trained": 2004840}, "done": false, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_17-58-43", "timestamp": 1690851523, "time_this_iter_s": 78.77663207054138, "time_total_s": 13556.984345436096, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13556.984345436096, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.9858407079646, "ram_util_percent": 55.41327433628317}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9268338671158953, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.847935635935888, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0788982311800153, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.88982311800083, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1129.68, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5645577211394303, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-3.7805578415364995, -3.813121066163054, -3.978897898423834, -4.109551112584532, -3.886039592899392, -4.070342500143411, -3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8009839991827095, "mean_inference_ms": 8.357541403200871, "mean_action_processing_ms": 0.40660825006845897, "mean_env_wait_ms": 9.776920235285283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2016846, "agent_timesteps_total": 2016846, "timers": {"sample_time_ms": 41522.591, "sample_throughput": 289.144, "load_time_ms": 6.821, "load_throughput": 1760026.207, "learn_time_ms": 38563.967, "learn_throughput": 311.327, "update_time_ms": 34.318}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030472183134406805, "policy_loss": 0.000666702922899276, "vf_loss": 0.002380515681579709, "vf_explained_var": 0.33088845014572144, "kl": 1.2483728539791628e-07, "entropy": 2.762418746948242, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2016846, "num_agent_steps_sampled": 2016846, "num_steps_trained": 2016846, "num_agent_steps_trained": 2016846}, "done": false, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-00-03", "timestamp": 1690851603, "time_this_iter_s": 79.69195818901062, "time_total_s": 13636.676303625107, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13636.676303625107, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.9798245614035, "ram_util_percent": 55.48157894736841}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.739520438937433, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.92437974836729, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8454726164604467, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.07890713190685, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.014425467054052, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8907131906843, "delta_v_total_min": 201.44254670540442, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1137.66, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5685457271364318, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-3.841698587543007, -3.794970942173098, -3.956733857973266, -3.9744224905153858, -4.080679516868995, -3.9638072786038983, -3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8001333463282083, "mean_inference_ms": 8.356491006157588, "mean_action_processing_ms": 0.4064678657041966, "mean_env_wait_ms": 9.772890426041654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2028852, "agent_timesteps_total": 2028852, "timers": {"sample_time_ms": 41304.097, "sample_throughput": 290.673, "load_time_ms": 7.403, "load_throughput": 1621771.431, "learn_time_ms": 38329.893, "learn_throughput": 313.228, "update_time_ms": 30.174}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027621183544397354, "policy_loss": 0.00010031121200881898, "vf_loss": 0.0026618060655891895, "vf_explained_var": 0.35803455114364624, "kl": 1.5639534467482008e-06, "entropy": 2.7226805686950684, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2028852, "num_agent_steps_sampled": 2028852, "num_steps_trained": 2028852, "num_agent_steps_trained": 2028852}, "done": false, "episodes_total": 1014, "training_iteration": 169, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-01-20", "timestamp": 1690851680, "time_this_iter_s": 76.95536804199219, "time_total_s": 13713.631671667099, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13713.631671667099, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.97981651376146, "ram_util_percent": 55.461467889908256}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.731038621619704, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.920032753153977, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.84185638773674, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.078176365417245, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.8176365417238, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1151.4, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5754122938530735, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-3.9303134150280807, -3.870813701117377, -3.798553412601092, -3.8414562229558857, -4.050261577262731, -3.8414927352210375, -4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7993218020349604, "mean_inference_ms": 8.355545655076293, "mean_action_processing_ms": 0.40633512866082133, "mean_env_wait_ms": 9.768988605783676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2040858, "agent_timesteps_total": 2040858, "timers": {"sample_time_ms": 41164.365, "sample_throughput": 291.66, "load_time_ms": 7.879, "load_throughput": 1523803.026, "learn_time_ms": 38343.907, "learn_throughput": 313.114, "update_time_ms": 29.217}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002262011868879199, "policy_loss": -5.7761306379688904e-05, "vf_loss": 0.0023197722621262074, "vf_explained_var": 0.42500215768814087, "kl": 7.860888331379101e-07, "entropy": 2.729562759399414, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2040858, "num_agent_steps_sampled": 2040858, "num_steps_trained": 2040858, "num_agent_steps_trained": 2040858}, "done": false, "episodes_total": 1020, "training_iteration": 170, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-02-39", "timestamp": 1690851759, "time_this_iter_s": 78.63798880577087, "time_total_s": 13792.26966047287, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13792.26966047287, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 99.98392857142856, "ram_util_percent": 55.40089285714284}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.731038621619704, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.921015246630919, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8417363204163477, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.079278926214579, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9278926214572, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1150.88, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5751524237881059, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-4.0135090110868346, -4.029911163885604, -3.807516328982648, -3.8563380638620828, -3.8313450761619876, -3.8294264182887243, -4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7989979093327235, "mean_inference_ms": 8.354371828996245, "mean_action_processing_ms": 0.40620523868741343, "mean_env_wait_ms": 9.765163158758117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2052864, "agent_timesteps_total": 2052864, "timers": {"sample_time_ms": 41372.245, "sample_throughput": 290.195, "load_time_ms": 7.957, "load_throughput": 1508786.747, "learn_time_ms": 38305.064, "learn_throughput": 313.431, "update_time_ms": 30.565}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0036090645007789135, "policy_loss": 0.001273334608413279, "vf_loss": 0.0023357325699180365, "vf_explained_var": 0.49277612566947937, "kl": 2.6619877644407097e-06, "entropy": 2.7218241691589355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2052864, "num_agent_steps_sampled": 2052864, "num_steps_trained": 2052864, "num_agent_steps_trained": 2052864}, "done": false, "episodes_total": 1026, "training_iteration": 171, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-04-09", "timestamp": 1690851849, "time_this_iter_s": 90.19516134262085, "time_total_s": 13882.46482181549, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13882.46482181549, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.98062015503876, "ram_util_percent": 55.47674418604651}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.731038621619704, "episode_reward_min": -4.109795329292531, "episode_reward_mean": -3.9229194057293193, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8433771244260174, "reward_component_totals/dist_change_reward_min": -0.9987213127724804, "reward_component_totals/dist_change_reward_max": -0.7075956421448764, "reward_component_totals/delta_v_mean": -2.0795422813033095, "reward_component_totals/delta_v_min": -2.1640532865623565, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.9542281303302, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 216.40532865623518, "constraint_violation.max_vel_constraint.steps_mean": 1118.04, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1943, "constraint_violation.max_vel_constraint.ratio_mean": 0.5587406296851575, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9710144927536232}, "hist_stats": {"episode_reward": [-4.030190401324678, -4.020707744024286, -4.051717199575156, -3.897553383169939, -3.9594762020527794, -4.109795329292531, -4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.798677129292449, "mean_inference_ms": 8.353208364949278, "mean_action_processing_ms": 0.40606972803923475, "mean_env_wait_ms": 9.761280638325154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2064870, "agent_timesteps_total": 2064870, "timers": {"sample_time_ms": 41390.8, "sample_throughput": 290.064, "load_time_ms": 7.604, "load_throughput": 1578855.722, "learn_time_ms": 38139.26, "learn_throughput": 314.794, "update_time_ms": 29.097}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0017240481683984399, "policy_loss": -0.0006699105142615736, "vf_loss": 0.002393958391621709, "vf_explained_var": 0.37722352147102356, "kl": 1.831090344239783e-06, "entropy": 2.7346086502075195, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2064870, "num_agent_steps_sampled": 2064870, "num_steps_trained": 2064870, "num_agent_steps_trained": 2064870}, "done": false, "episodes_total": 1032, "training_iteration": 172, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-05-27", "timestamp": 1690851927, "time_this_iter_s": 77.4454197883606, "time_total_s": 13959.910241603851, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13959.910241603851, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.98108108108107, "ram_util_percent": 55.41531531531528}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.088586969150255, "episode_reward_mean": -3.912650672113251, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8341072904361846, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0785433816770746, "reward_component_totals/delta_v_min": -2.148204017033184, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.85433816770674, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.82040170331726, "constraint_violation.max_vel_constraint.steps_mean": 1091.8, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5456271864067967, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-4.084939019445858, -3.9690008530115426, -3.8491736489323323, -3.8527108016202707, -3.7997951612228142, -3.77793824706408, -3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7983284786816, "mean_inference_ms": 8.352017473197328, "mean_action_processing_ms": 0.4059277336608121, "mean_env_wait_ms": 9.757251918197033, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2076876, "agent_timesteps_total": 2076876, "timers": {"sample_time_ms": 41293.559, "sample_throughput": 290.748, "load_time_ms": 7.596, "load_throughput": 1580476.113, "learn_time_ms": 37873.247, "learn_throughput": 317.005, "update_time_ms": 29.068}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003291814122349024, "policy_loss": 0.0007418286986649036, "vf_loss": 0.0025499844923615456, "vf_explained_var": 0.15669748187065125, "kl": 1.0358209578953392e-07, "entropy": 2.7753288745880127, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2076876, "num_agent_steps_sampled": 2076876, "num_steps_trained": 2076876, "num_agent_steps_trained": 2076876}, "done": false, "episodes_total": 1038, "training_iteration": 173, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-06-42", "timestamp": 1690852002, "time_this_iter_s": 74.84738373756409, "time_total_s": 14034.757625341415, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14034.757625341415, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.98598130841121, "ram_util_percent": 55.39532710280371}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.088586969150255, "episode_reward_mean": -3.9147544568482147, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8370507164570832, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0777037403911383, "reward_component_totals/delta_v_min": -2.148204017033184, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7703740391131, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.82040170331726, "constraint_violation.max_vel_constraint.steps_mean": 1079.54, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5395002498750625, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.927070833156958, -3.8270224399236543, -4.088586969150255, -4.0113250969689265, -4.040822102281126, -4.014816220966302, -3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.797971633773297, "mean_inference_ms": 8.350723001510316, "mean_action_processing_ms": 0.40578691872466566, "mean_env_wait_ms": 9.753348318292133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2088882, "agent_timesteps_total": 2088882, "timers": {"sample_time_ms": 41181.392, "sample_throughput": 291.539, "load_time_ms": 7.118, "load_throughput": 1686633.815, "learn_time_ms": 37890.812, "learn_throughput": 316.858, "update_time_ms": 28.681}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0033362105023115873, "policy_loss": 0.0008126841858029366, "vf_loss": 0.0025235251523554325, "vf_explained_var": 0.3914612829685211, "kl": 1.8030405044555664e-06, "entropy": 2.7285306453704834, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2088882, "num_agent_steps_sampled": 2088882, "num_steps_trained": 2088882, "num_agent_steps_trained": 2088882}, "done": false, "episodes_total": 1044, "training_iteration": 174, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-08-01", "timestamp": 1690852081, "time_this_iter_s": 78.79899764060974, "time_total_s": 14113.556622982025, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14113.556622982025, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 99.9830357142857, "ram_util_percent": 55.429464285714275}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.08759935631913, "episode_reward_mean": -3.9107802238910234, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8348986764772611, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0758815474137697, "reward_component_totals/delta_v_min": -2.148204017033184, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.5881547413762, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.82040170331726, "constraint_violation.max_vel_constraint.steps_mean": 1064.18, "constraint_violation.max_vel_constraint.steps_min": 289, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.531824087956022, "constraint_violation.max_vel_constraint.ratio_min": 0.14442778610694654, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.8555632274071394, -3.9785537097803467, -3.9674973719356843, -3.848070081520544, -3.9030165431277446, -3.997104491044675, -3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7975604688516795, "mean_inference_ms": 8.349303980629557, "mean_action_processing_ms": 0.4056344455422349, "mean_env_wait_ms": 9.749162108801706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2100888, "agent_timesteps_total": 2100888, "timers": {"sample_time_ms": 40994.907, "sample_throughput": 292.866, "load_time_ms": 7.092, "load_throughput": 1692956.232, "learn_time_ms": 37881.406, "learn_throughput": 316.936, "update_time_ms": 29.486}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0029932514298707247, "policy_loss": 0.0002630123926792294, "vf_loss": 0.002730238251388073, "vf_explained_var": 0.26116085052490234, "kl": 1.349491469682107e-07, "entropy": 2.785274028778076, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2100888, "num_agent_steps_sampled": 2100888, "num_steps_trained": 2100888, "num_agent_steps_trained": 2100888}, "done": false, "episodes_total": 1050, "training_iteration": 175, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-09-16", "timestamp": 1690852156, "time_this_iter_s": 75.23654460906982, "time_total_s": 14188.793167591095, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14188.793167591095, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.97870370370369, "ram_util_percent": 55.47037037037035}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.08759935631913, "episode_reward_mean": -3.909907918583662, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8363633410918869, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0735445774917833, "reward_component_totals/delta_v_min": -2.139674083938204, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.35445774917756, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 213.9674083938196, "constraint_violation.max_vel_constraint.steps_mean": 1072.97, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5362168915542229, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.9646631040859006, -3.739520438937433, -3.833157908899448, -3.906415938306763, -4.022113855189847, -4.039402689833377, -3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7971681517375437, "mean_inference_ms": 8.3477575717341, "mean_action_processing_ms": 0.4054845831046831, "mean_env_wait_ms": 9.745021056728731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2112894, "agent_timesteps_total": 2112894, "timers": {"sample_time_ms": 41128.675, "sample_throughput": 291.913, "load_time_ms": 6.734, "load_throughput": 1782939.694, "learn_time_ms": 37699.003, "learn_throughput": 318.47, "update_time_ms": 30.655}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002074653282761574, "policy_loss": -0.00031186919659376144, "vf_loss": 0.00238652341067791, "vf_explained_var": 0.44178617000579834, "kl": 2.6446307401783997e-06, "entropy": 2.7085673809051514, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2112894, "num_agent_steps_sampled": 2112894, "num_steps_trained": 2112894, "num_agent_steps_trained": 2112894}, "done": false, "episodes_total": 1056, "training_iteration": 176, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-10-36", "timestamp": 1690852236, "time_this_iter_s": 79.235111951828, "time_total_s": 14268.028279542923, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14268.028279542923, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.98125, "ram_util_percent": 55.39910714285713}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.08759935631913, "episode_reward_mean": -3.9070283662608496, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8311750784453023, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.075853287815554, "reward_component_totals/delta_v_min": -2.139674083938204, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.58532878155464, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 213.9674083938196, "constraint_violation.max_vel_constraint.steps_mean": 1097.49, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5484707646176912, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.8266103147062687, -3.9671288056834824, -3.9082798499262674, -3.8507251821506574, -3.9149738543515133, -3.987864777041814, -3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.796327249582916, "mean_inference_ms": 8.346276606952886, "mean_action_processing_ms": 0.40534193674485974, "mean_env_wait_ms": 9.741162979279865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2124900, "agent_timesteps_total": 2124900, "timers": {"sample_time_ms": 41078.392, "sample_throughput": 292.27, "load_time_ms": 6.513, "load_throughput": 1843444.26, "learn_time_ms": 37866.437, "learn_throughput": 317.062, "update_time_ms": 33.54}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0030372506007552147, "policy_loss": 0.0003687279240693897, "vf_loss": 0.0026685239281505346, "vf_explained_var": 0.4288010001182556, "kl": 3.503410198391066e-06, "entropy": 2.7464048862457275, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2124900, "num_agent_steps_sampled": 2124900, "num_steps_trained": 2124900, "num_agent_steps_trained": 2124900}, "done": false, "episodes_total": 1062, "training_iteration": 177, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-11-56", "timestamp": 1690852316, "time_this_iter_s": 79.95311665534973, "time_total_s": 14347.981396198273, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14347.981396198273, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.97543859649122, "ram_util_percent": 55.460526315789465}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.08759935631913, "episode_reward_mean": -3.905795479616778, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8290227647019033, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.076772714914881, "reward_component_totals/delta_v_min": -2.142226451784376, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.67727149148737, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.22264517843647, "constraint_violation.max_vel_constraint.steps_mean": 1103.04, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5512443778110945, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.956388318929247, -3.812471615216605, -3.793221407783479, -3.8616972285727784, -4.008341074361458, -4.074885891349157, -3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.795543623746174, "mean_inference_ms": 8.344772137050604, "mean_action_processing_ms": 0.4051979890443046, "mean_env_wait_ms": 9.73753339392678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2136906, "agent_timesteps_total": 2136906, "timers": {"sample_time_ms": 41224.835, "sample_throughput": 291.232, "load_time_ms": 6.303, "load_throughput": 1904936.8, "learn_time_ms": 37703.477, "learn_throughput": 318.432, "update_time_ms": 38.397}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031991254072636366, "policy_loss": 0.0007224808796308935, "vf_loss": 0.0024766467977315187, "vf_explained_var": 0.29156404733657837, "kl": 5.0526754336033264e-08, "entropy": 2.7472984790802, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2136906, "num_agent_steps_sampled": 2136906, "num_steps_trained": 2136906, "num_agent_steps_trained": 2136906}, "done": false, "episodes_total": 1068, "training_iteration": 178, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-13-16", "timestamp": 1690852396, "time_this_iter_s": 79.53461074829102, "time_total_s": 14427.516006946564, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14427.516006946564, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 99.97894736842105, "ram_util_percent": 55.39736842105261}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.08759935631913, "episode_reward_mean": -3.900752928663325, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.824918512160615, "reward_component_totals/dist_change_reward_min": -0.9963727932628192, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.075834416502717, "reward_component_totals/delta_v_min": -2.142226451784376, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.58344165027097, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.22264517843647, "constraint_violation.max_vel_constraint.steps_mean": 1112.87, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5561569215392305, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.916221710697056, -3.895289161080088, -3.7893554423974956, -3.8087797778076693, -4.081900511316958, -4.08759935631913, -4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7947780710861059, "mean_inference_ms": 8.34326593331435, "mean_action_processing_ms": 0.40507202001167664, "mean_env_wait_ms": 9.734189588382826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2148912, "agent_timesteps_total": 2148912, "timers": {"sample_time_ms": 41438.03, "sample_throughput": 289.734, "load_time_ms": 5.663, "load_throughput": 2119965.556, "learn_time_ms": 37537.231, "learn_throughput": 319.842, "update_time_ms": 38.605}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0034457771107554436, "policy_loss": 0.0005737908068113029, "vf_loss": 0.002871985314413905, "vf_explained_var": 0.1656528115272522, "kl": 5.2492044488872125e-08, "entropy": 2.774010181427002, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2148912, "num_agent_steps_sampled": 2148912, "num_steps_trained": 2148912, "num_agent_steps_trained": 2148912}, "done": false, "episodes_total": 1074, "training_iteration": 179, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-14-34", "timestamp": 1690852474, "time_this_iter_s": 77.37951874732971, "time_total_s": 14504.895525693893, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14504.895525693893, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 99.97999999999999, "ram_util_percent": 55.43090909090909}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.081536216551598, "episode_reward_mean": -3.9016277046991634, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8254312413566596, "reward_component_totals/dist_change_reward_min": -0.9884808697266957, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.076196463342511, "reward_component_totals/delta_v_min": -2.142226451784376, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.61964633425032, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.22264517843647, "constraint_violation.max_vel_constraint.steps_mean": 1114.21, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5568265867066468, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-4.002609141735098, -3.817136625219602, -4.019229422048785, -3.9999794634503223, -3.9028540720270994, -3.8271706137812553, -4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7940428788023532, "mean_inference_ms": 8.341796287875235, "mean_action_processing_ms": 0.40495303635490165, "mean_env_wait_ms": 9.73103321025177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2160918, "agent_timesteps_total": 2160918, "timers": {"sample_time_ms": 41367.419, "sample_throughput": 290.228, "load_time_ms": 5.537, "load_throughput": 2168150.533, "learn_time_ms": 37627.444, "learn_throughput": 319.076, "update_time_ms": 42.177}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002007691189646721, "policy_loss": -0.000578961567953229, "vf_loss": 0.0025866522919386625, "vf_explained_var": 0.4880460798740387, "kl": 5.515232260222547e-06, "entropy": 2.712256669998169, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2160918, "num_agent_steps_sampled": 2160918, "num_steps_trained": 2160918, "num_agent_steps_trained": 2160918}, "done": false, "episodes_total": 1080, "training_iteration": 180, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-15-53", "timestamp": 1690852553, "time_this_iter_s": 78.82714295387268, "time_total_s": 14583.722668647766, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14583.722668647766, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.98230088495575, "ram_util_percent": 55.430088495575205}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.081536216551598, "episode_reward_mean": -3.9008957298110882, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8239850916764131, "reward_component_totals/dist_change_reward_min": -0.9884808697266957, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.076910638134682, "reward_component_totals/delta_v_min": -2.142226451784376, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.69106381346745, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.22264517843647, "constraint_violation.max_vel_constraint.steps_mean": 1108.99, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5542178910544727, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-4.014474762579066, -4.019138414633668, -3.9581140238243178, -3.8520823606851287, -3.8121387825366977, -3.8832759810556556, -4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7938121780331244, "mean_inference_ms": 8.34030333846474, "mean_action_processing_ms": 0.4048399039168437, "mean_env_wait_ms": 9.728068792102794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2172924, "agent_timesteps_total": 2172924, "timers": {"sample_time_ms": 41241.045, "sample_throughput": 291.118, "load_time_ms": 5.466, "load_throughput": 2196531.991, "learn_time_ms": 37516.213, "learn_throughput": 320.022, "update_time_ms": 41.03}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0031133568845689297, "policy_loss": 0.00041353172855451703, "vf_loss": 0.002699826145544648, "vf_explained_var": 0.13488876819610596, "kl": 1.9237319293097244e-08, "entropy": 2.799144744873047, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2172924, "num_agent_steps_sampled": 2172924, "num_steps_trained": 2172924, "num_agent_steps_trained": 2172924}, "done": false, "episodes_total": 1086, "training_iteration": 181, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-17-21", "timestamp": 1690852641, "time_this_iter_s": 87.75754427909851, "time_total_s": 14671.480212926865, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14671.480212926865, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.98320000000001, "ram_util_percent": 55.45199999999999}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9005228057445716, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8227077497796885, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0778150559648907, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7815055964883, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1122.11, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5607746126936533, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-4.027642535088493, -4.028277165419863, -3.7700433036467498, -3.900915206412118, -4.081536216551598, -4.013435967567287, -3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7935839505782962, "mean_inference_ms": 8.339016168095101, "mean_action_processing_ms": 0.4047315857615443, "mean_env_wait_ms": 9.725223839328036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2184930, "agent_timesteps_total": 2184930, "timers": {"sample_time_ms": 41401.738, "sample_throughput": 289.988, "load_time_ms": 5.668, "load_throughput": 2118146.455, "learn_time_ms": 37453.22, "learn_throughput": 320.56, "update_time_ms": 41.648}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003207871923223138, "policy_loss": 0.0005016023060306907, "vf_loss": 0.002706269733607769, "vf_explained_var": 0.37595582008361816, "kl": 9.80104346126609e-07, "entropy": 2.760511875152588, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2184930, "num_agent_steps_sampled": 2184930, "num_steps_trained": 2184930, "num_agent_steps_trained": 2184930}, "done": false, "episodes_total": 1092, "training_iteration": 182, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-18-39", "timestamp": 1690852719, "time_this_iter_s": 78.4560968875885, "time_total_s": 14749.936309814453, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14749.936309814453, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.9849557522124, "ram_util_percent": 55.416814159292024}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.8995202395949993, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8223503411585353, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.07716989843647, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.71698984364622, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1120.47, "constraint_violation.max_vel_constraint.steps_min": 384, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5599550224887556, "constraint_violation.max_vel_constraint.ratio_min": 0.191904047976012, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.8197789413224177, -3.9211433478016184, -3.78894092857192, -3.77023979210034, -3.8178632530090075, -4.047732853041754, -3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79339244628605, "mean_inference_ms": 8.337524388030793, "mean_action_processing_ms": 0.4046319464088601, "mean_env_wait_ms": 9.722508074536682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2196936, "agent_timesteps_total": 2196936, "timers": {"sample_time_ms": 41494.133, "sample_throughput": 289.342, "load_time_ms": 5.925, "load_throughput": 2026463.759, "learn_time_ms": 37638.289, "learn_throughput": 318.984, "update_time_ms": 43.612}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002966179745271802, "policy_loss": 0.0004897008766420186, "vf_loss": 0.002476481720805168, "vf_explained_var": 0.45878931879997253, "kl": 2.3348907234321814e-06, "entropy": 2.7118024826049805, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2196936, "num_agent_steps_sampled": 2196936, "num_steps_trained": 2196936, "num_agent_steps_trained": 2196936}, "done": false, "episodes_total": 1098, "training_iteration": 183, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-19-57", "timestamp": 1690852797, "time_this_iter_s": 77.63517665863037, "time_total_s": 14827.571486473083, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14827.571486473083, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 99.97636363636363, "ram_util_percent": 55.46636363636363}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9042544265973844, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8269147408344654, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.077339685762926, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73396857629174, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1122.51, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5609745127436282, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.885051213816456, -4.020414962246978, -3.8496564897719936, -3.971295766818275, -3.9073062136903283, -3.784230572027135, -3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7932030296700148, "mean_inference_ms": 8.335987670372319, "mean_action_processing_ms": 0.4045388210161064, "mean_env_wait_ms": 9.720106633165603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2208942, "agent_timesteps_total": 2208942, "timers": {"sample_time_ms": 41657.345, "sample_throughput": 288.208, "load_time_ms": 6.448, "load_throughput": 1861984.56, "learn_time_ms": 37445.003, "learn_throughput": 320.63, "update_time_ms": 42.468}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0014196430565789342, "policy_loss": -0.000915400218218565, "vf_loss": 0.0023350422270596027, "vf_explained_var": 0.330024391412735, "kl": 2.251622532867259e-07, "entropy": 2.7514302730560303, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2208942, "num_agent_steps_sampled": 2208942, "num_steps_trained": 2208942, "num_agent_steps_trained": 2208942}, "done": false, "episodes_total": 1104, "training_iteration": 184, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-21-16", "timestamp": 1690852876, "time_this_iter_s": 78.54036831855774, "time_total_s": 14906.111854791641, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14906.111854791641, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.98214285714286, "ram_util_percent": 55.488392857142856}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.905246528816922, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8272593006374497, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.077987228179478, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.79872281794707, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1113.75, "constraint_violation.max_vel_constraint.steps_min": 351, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5565967016491754, "constraint_violation.max_vel_constraint.ratio_min": 0.17541229385307347, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.8940855830659613, -3.9386766457462814, -3.9836501032607905, -3.885149019099618, -3.944511068828761, -3.834782243467046, -4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7930247157770163, "mean_inference_ms": 8.334219815832615, "mean_action_processing_ms": 0.40445166353930984, "mean_env_wait_ms": 9.717825421993018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2220948, "agent_timesteps_total": 2220948, "timers": {"sample_time_ms": 41762.542, "sample_throughput": 287.483, "load_time_ms": 6.653, "load_throughput": 1804729.07, "learn_time_ms": 37266.99, "learn_throughput": 322.162, "update_time_ms": 42.942}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0024560655001550913, "policy_loss": 8.862377580953762e-05, "vf_loss": 0.0023674422409385443, "vf_explained_var": 0.5197297930717468, "kl": 1.0693495823943522e-05, "entropy": 2.7280452251434326, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2220948, "num_agent_steps_sampled": 2220948, "num_steps_trained": 2220948, "num_agent_steps_trained": 2220948}, "done": false, "episodes_total": 1110, "training_iteration": 185, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-22-31", "timestamp": 1690852951, "time_this_iter_s": 74.46095204353333, "time_total_s": 14980.572806835175, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14980.572806835175, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.98301886792453, "ram_util_percent": 55.44150943396226}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9027936329156034, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8250285444165172, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0777650884990924, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0116654712955198, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7765088499085, "delta_v_total_min": 201.16654712955133, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1094.28, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5468665667166417, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-4.022595071010598, -3.808564445313965, -3.836121702106362, -3.731038621619704, -3.865957948666437, -4.000658425380185, -3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7928667064193018, "mean_inference_ms": 8.332394150661127, "mean_action_processing_ms": 0.40437922466950504, "mean_env_wait_ms": 9.715873670486786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2232954, "agent_timesteps_total": 2232954, "timers": {"sample_time_ms": 41719.225, "sample_throughput": 287.781, "load_time_ms": 6.846, "load_throughput": 1753743.442, "learn_time_ms": 37038.791, "learn_throughput": 324.147, "update_time_ms": 39.854}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002063486957922578, "policy_loss": -0.00047257947153411806, "vf_loss": 0.0025360649451613426, "vf_explained_var": 0.3631709814071655, "kl": 1.8952289337903494e-06, "entropy": 2.718836784362793, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2232954, "num_agent_steps_sampled": 2232954, "num_steps_trained": 2232954, "num_agent_steps_trained": 2232954}, "done": false, "episodes_total": 1116, "training_iteration": 186, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-23-47", "timestamp": 1690853027, "time_this_iter_s": 76.42411804199219, "time_total_s": 15056.996924877167, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15056.996924877167, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.98532110091743, "ram_util_percent": 55.44311926605506}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9041954536895083, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8266531822269323, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0775422714625833, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0243397003412293, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7542271462575, "delta_v_total_min": 202.4339700341223, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1065.37, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1940, "constraint_violation.max_vel_constraint.ratio_mean": 0.5324187906046977, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9695152423788106}, "hist_stats": {"episode_reward": [-3.9181653795917892, -3.870624557248208, -3.8900508808433756, -3.8856832201503417, -3.892051847297558, -4.021836035261952, -3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7922470929010266, "mean_inference_ms": 8.330775078903054, "mean_action_processing_ms": 0.40430078692357907, "mean_env_wait_ms": 9.713985941801381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2244960, "agent_timesteps_total": 2244960, "timers": {"sample_time_ms": 41913.583, "sample_throughput": 286.447, "load_time_ms": 7.715, "load_throughput": 1556215.95, "learn_time_ms": 36773.015, "learn_throughput": 326.489, "update_time_ms": 37.5}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0023959605023264885, "policy_loss": -0.00019218346278648823, "vf_loss": 0.002588145202025771, "vf_explained_var": 0.2762020230293274, "kl": 4.239145141582412e-07, "entropy": 2.7343478202819824, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2244960, "num_agent_steps_sampled": 2244960, "num_steps_trained": 2244960, "num_agent_steps_trained": 2244960}, "done": false, "episodes_total": 1122, "training_iteration": 187, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-25-07", "timestamp": 1690853107, "time_this_iter_s": 79.3093101978302, "time_total_s": 15136.306235074997, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15136.306235074997, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 99.98333333333332, "ram_util_percent": 55.47631578947369}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9022893781835406, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8250299056971668, "reward_component_totals/dist_change_reward_min": -0.9929432591465532, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0772594724863804, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0243397003412293, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7259472486372, "delta_v_total_min": 202.4339700341223, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1091.07, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1904, "constraint_violation.max_vel_constraint.ratio_mean": 0.5452623688155922, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9515242378810594}, "hist_stats": {"episode_reward": [-3.8249920393964505, -3.9936254865132854, -3.94370035106387, -3.8822562125747906, -3.7991246577344104, -3.9373443916454773, -3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7916893499077202, "mean_inference_ms": 8.329254535263518, "mean_action_processing_ms": 0.40423679423434306, "mean_env_wait_ms": 9.712528830980391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2256966, "agent_timesteps_total": 2256966, "timers": {"sample_time_ms": 41924.005, "sample_throughput": 286.375, "load_time_ms": 7.899, "load_throughput": 1519944.155, "learn_time_ms": 36632.189, "learn_throughput": 327.745, "update_time_ms": 34.764}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0019442035118117929, "policy_loss": -0.00043408156489022076, "vf_loss": 0.0023782839998602867, "vf_explained_var": 0.2848772406578064, "kl": 5.341985911400116e-07, "entropy": 2.751619338989258, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2256966, "num_agent_steps_sampled": 2256966, "num_steps_trained": 2256966, "num_agent_steps_trained": 2256966}, "done": false, "episodes_total": 1128, "training_iteration": 188, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-26-25", "timestamp": 1690853185, "time_this_iter_s": 78.26823377609253, "time_total_s": 15214.57446885109, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15214.57446885109, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.98378378378379, "ram_util_percent": 55.49549549549546}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.57643105574377, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9030566791552777, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8255513971848787, "reward_component_totals/dist_change_reward_min": -0.993225411354423, "reward_component_totals/dist_change_reward_max": -0.49622248453823253, "reward_component_totals/delta_v_mean": -2.0775052819704047, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.7505281970397, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1118.95, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1904, "constraint_violation.max_vel_constraint.ratio_mean": 0.5591954022988506, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9515242378810594}, "hist_stats": {"episode_reward": [-3.8133660870706514, -3.8611943769460186, -3.57643105574377, -4.055106328692289, -3.9304872593945555, -3.8280633556739994, -4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.791184663087545, "mean_inference_ms": 8.327773800785003, "mean_action_processing_ms": 0.4041875135418389, "mean_env_wait_ms": 9.711377196948384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2268972, "agent_timesteps_total": 2268972, "timers": {"sample_time_ms": 41834.435, "sample_throughput": 286.988, "load_time_ms": 8.185, "load_throughput": 1466914.095, "learn_time_ms": 36648.367, "learn_throughput": 327.6, "update_time_ms": 35.705}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027658743783831596, "policy_loss": 0.00022188053117133677, "vf_loss": 0.002543993294239044, "vf_explained_var": 0.29929593205451965, "kl": 7.804358119756216e-07, "entropy": 2.7507264614105225, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2268972, "num_agent_steps_sampled": 2268972, "num_steps_trained": 2268972, "num_agent_steps_trained": 2268972}, "done": false, "episodes_total": 1134, "training_iteration": 189, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-27-42", "timestamp": 1690853262, "time_this_iter_s": 76.70792293548584, "time_total_s": 15291.282391786575, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15291.282391786575, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.97818181818182, "ram_util_percent": 55.459090909090904}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9023848417920965, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8250508036859959, "reward_component_totals/dist_change_reward_min": -0.993225411354423, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.077334038106107, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.73340381060993, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1113.5, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1904, "constraint_violation.max_vel_constraint.ratio_mean": 0.5564717641179411, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9515242378810594}, "hist_stats": {"episode_reward": [-4.062224171654738, -3.846427321810772, -4.03403572435286, -3.842698371906268, -4.061515285174795, -4.02479964512954, -3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.790754503427767, "mean_inference_ms": 8.326671351774161, "mean_action_processing_ms": 0.40415908995129024, "mean_env_wait_ms": 9.710652777485269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2280978, "agent_timesteps_total": 2280978, "timers": {"sample_time_ms": 42106.452, "sample_throughput": 285.134, "load_time_ms": 7.977, "load_throughput": 1505165.406, "learn_time_ms": 36395.722, "learn_throughput": 329.874, "update_time_ms": 31.133}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002770755672827363, "policy_loss": 0.00029129357426427305, "vf_loss": 0.0024794635828584433, "vf_explained_var": 0.3344138264656067, "kl": 1.1750912563002203e-06, "entropy": 2.7336931228637695, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2280978, "num_agent_steps_sampled": 2280978, "num_steps_trained": 2280978, "num_agent_steps_trained": 2280978}, "done": false, "episodes_total": 1140, "training_iteration": 190, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-29-01", "timestamp": 1690853341, "time_this_iter_s": 79.00043272972107, "time_total_s": 15370.282824516296, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15370.282824516296, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.97964601769912, "ram_util_percent": 55.4079646017699}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.898851594745449, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8215637922488991, "reward_component_totals/dist_change_reward_min": -0.993225411354423, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.077287802496556, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.72878024965482, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1120.62, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1904, "constraint_violation.max_vel_constraint.ratio_mean": 0.5600299850074961, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9515242378810594}, "hist_stats": {"episode_reward": [-3.8394094724780565, -3.814169993207771, -3.8915305405765137, -3.880795430161484, -3.9666097410130683, -4.000473465272588, -3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7908323303901352, "mean_inference_ms": 8.325597067092732, "mean_action_processing_ms": 0.40414214364189804, "mean_env_wait_ms": 9.710283891412326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2292984, "agent_timesteps_total": 2292984, "timers": {"sample_time_ms": 42202.369, "sample_throughput": 284.486, "load_time_ms": 7.793, "load_throughput": 1540613.893, "learn_time_ms": 36179.983, "learn_throughput": 331.841, "update_time_ms": 32.97}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002357407007366419, "policy_loss": -8.96804776857607e-05, "vf_loss": 0.0024470884818583727, "vf_explained_var": 0.39984673261642456, "kl": 2.7036019218940055e-06, "entropy": 2.7125346660614014, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2292984, "num_agent_steps_sampled": 2292984, "num_steps_trained": 2292984, "num_agent_steps_trained": 2292984}, "done": false, "episodes_total": 1146, "training_iteration": 191, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-30-28", "timestamp": 1690853428, "time_this_iter_s": 86.59774684906006, "time_total_s": 15456.880571365356, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15456.880571365356, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 99.98225806451613, "ram_util_percent": 55.49919354838711}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.897508811421353, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8208942650498571, "reward_component_totals/dist_change_reward_min": -0.993225411354423, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.076614546371503, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.66145463714946, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1131.87, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1904, "constraint_violation.max_vel_constraint.ratio_mean": 0.5656521739130436, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9515242378810594}, "hist_stats": {"episode_reward": [-3.9425824845492023, -3.771276155534129, -3.9614900976787277, -3.820142950032362, -3.8309890858698123, -3.9273496998148185, -3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7909451660004478, "mean_inference_ms": 8.32465965765973, "mean_action_processing_ms": 0.4041454260604634, "mean_env_wait_ms": 9.71046971492429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2304990, "agent_timesteps_total": 2304990, "timers": {"sample_time_ms": 42271.948, "sample_throughput": 284.018, "load_time_ms": 7.484, "load_throughput": 1604149.321, "learn_time_ms": 36119.435, "learn_throughput": 332.397, "update_time_ms": 32.21}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.002588988048955798, "policy_loss": 0.0002421918761683628, "vf_loss": 0.00234679295681417, "vf_explained_var": 0.37083086371421814, "kl": 3.0260974881457514e-07, "entropy": 2.731659412384033, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2304990, "num_agent_steps_sampled": 2304990, "num_steps_trained": 2304990, "num_agent_steps_trained": 2304990}, "done": false, "episodes_total": 1152, "training_iteration": 192, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-31-47", "timestamp": 1690853507, "time_this_iter_s": 78.55689215660095, "time_total_s": 15535.437463521957, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15535.437463521957, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.97477477477476, "ram_util_percent": 55.52972972972973}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.898891019841014, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8222251883109232, "reward_component_totals/dist_change_reward_min": -0.993225411354423, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0766658315300974, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.666583153009, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1143.24, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5713343328335833, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.9812095373968592, -3.8309229556408955, -3.844771187655554, -3.8020762365934773, -3.851645569034374, -3.861521780343483, -3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.791056633678429, "mean_inference_ms": 8.323762444999172, "mean_action_processing_ms": 0.4041515607880559, "mean_env_wait_ms": 9.710769776471471, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2316996, "agent_timesteps_total": 2316996, "timers": {"sample_time_ms": 42578.9, "sample_throughput": 281.971, "load_time_ms": 8.216, "load_throughput": 1461227.26, "learn_time_ms": 36194.469, "learn_throughput": 331.708, "update_time_ms": 30.349}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0021357329096645117, "policy_loss": -0.0003779129183385521, "vf_loss": 0.002513645915314555, "vf_explained_var": 0.3314816951751709, "kl": 4.212432145322964e-07, "entropy": 2.740600347518921, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2316996, "num_agent_steps_sampled": 2316996, "num_steps_trained": 2316996, "num_agent_steps_trained": 2316996}, "done": false, "episodes_total": 1158, "training_iteration": 193, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-33-09", "timestamp": 1690853589, "time_this_iter_s": 81.47596669197083, "time_total_s": 15616.913430213928, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15616.913430213928, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.98103448275862, "ram_util_percent": 55.557758620689675}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.899552606234641, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8249913453779563, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0745612608566915, "reward_component_totals/delta_v_min": -2.1457003571589794, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.45612608566836, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 214.57003571589738, "constraint_violation.max_vel_constraint.steps_mean": 1129.26, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5643478260869564, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8299680686455067, -4.002668011995174, -3.8061072857341127, -3.9803834037001997, -3.824900609912277, -3.8480445135994423, -3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7911380705804465, "mean_inference_ms": 8.32291784273865, "mean_action_processing_ms": 0.40415128273177003, "mean_env_wait_ms": 9.711003113171696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2329002, "agent_timesteps_total": 2329002, "timers": {"sample_time_ms": 42578.271, "sample_throughput": 281.975, "load_time_ms": 8.034, "load_throughput": 1494427.115, "learn_time_ms": 35880.238, "learn_throughput": 334.613, "update_time_ms": 30.247}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003395566949620843, "policy_loss": 0.0012059713480994105, "vf_loss": 0.0021895943209528923, "vf_explained_var": 0.5375747084617615, "kl": 9.383825840814097e-07, "entropy": 2.6961400508880615, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2329002, "num_agent_steps_sampled": 2329002, "num_steps_trained": 2329002, "num_agent_steps_trained": 2329002}, "done": false, "episodes_total": 1164, "training_iteration": 194, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-34-24", "timestamp": 1690853664, "time_this_iter_s": 75.33456158638, "time_total_s": 15692.247991800308, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15692.247991800308, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.97870370370369, "ram_util_percent": 55.52222222222223}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.902607068119359, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8265132020676289, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0760938660517367, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.60938660517292, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1136.22, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5678260869565217, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.740310017707286, -3.861312738523876, -3.9254782683381846, -3.802704292786423, -4.039423727564277, -3.920187157164883, -3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7912299121018478, "mean_inference_ms": 8.322096217808417, "mean_action_processing_ms": 0.4041633303310695, "mean_env_wait_ms": 9.711310876278903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2341008, "agent_timesteps_total": 2341008, "timers": {"sample_time_ms": 42833.675, "sample_throughput": 280.293, "load_time_ms": 7.744, "load_throughput": 1550427.929, "learn_time_ms": 35884.411, "learn_throughput": 334.574, "update_time_ms": 27.661}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003115591825917363, "policy_loss": 0.0007770363008603454, "vf_loss": 0.0023385563399642706, "vf_explained_var": 0.5359897613525391, "kl": 8.687537160767533e-07, "entropy": 2.6928234100341797, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2341008, "num_agent_steps_sampled": 2341008, "num_steps_trained": 2341008, "num_agent_steps_trained": 2341008}, "done": false, "episodes_total": 1170, "training_iteration": 195, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-35-42", "timestamp": 1690853742, "time_this_iter_s": 77.07853579521179, "time_total_s": 15769.32652759552, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15769.32652759552, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 99.98545454545454, "ram_util_percent": 55.55363636363636}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.905014142710002, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8297952166681839, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.075218926041825, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.52189260418172, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1110.83, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5551374312843579, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.8834465992380967, -3.8815306454912295, -3.979425759353112, -3.9626096743905754, -3.8851307541933346, -3.8662232858390357, -3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957, -3.7405468247003855, -3.8725415200890785, -3.993805739240236, -4.044785173008814, -3.873406436973174, -4.005037967137559], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7913447100918904, "mean_inference_ms": 8.321374192443775, "mean_action_processing_ms": 0.40416679999876615, "mean_env_wait_ms": 9.711514561597491, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2353014, "agent_timesteps_total": 2353014, "timers": {"sample_time_ms": 42826.272, "sample_throughput": 280.342, "load_time_ms": 7.291, "load_throughput": 1646766.882, "learn_time_ms": 35852.11, "learn_throughput": 334.876, "update_time_ms": 28.096}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0028513153083622456, "policy_loss": 0.000332399969920516, "vf_loss": 0.002518915105611086, "vf_explained_var": 0.30712398886680603, "kl": 7.287023322533059e-07, "entropy": 2.725087881088257, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2353014, "num_agent_steps_sampled": 2353014, "num_steps_trained": 2353014, "num_agent_steps_trained": 2353014}, "done": false, "episodes_total": 1176, "training_iteration": 196, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-36-58", "timestamp": 1690853818, "time_this_iter_s": 76.04979920387268, "time_total_s": 15845.376326799393, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15845.376326799393, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 99.98165137614677, "ram_util_percent": 55.60825688073394}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9035022809291253, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8303968414042804, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0731054395248525, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.31054395248452, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1116.72, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.55808095952024, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.9973909340500184, -3.910664375109599, -3.8437773685695604, -3.992595131693043, -3.9874723440443676, -3.833263081770479, -3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957, -3.7405468247003855, -3.8725415200890785, -3.993805739240236, -4.044785173008814, -3.873406436973174, -4.005037967137559, -3.9417196477482603, -3.8047602787978763, -3.975845708817301, -3.8828099528206352, -3.791250754579682, -3.9107941976540257], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.791037803575152, "mean_inference_ms": 8.321059508918486, "mean_action_processing_ms": 0.4041687840907738, "mean_env_wait_ms": 9.711682713176533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2365020, "agent_timesteps_total": 2365020, "timers": {"sample_time_ms": 42873.899, "sample_throughput": 280.031, "load_time_ms": 6.85, "load_throughput": 1752669.155, "learn_time_ms": 35824.893, "learn_throughput": 335.13, "update_time_ms": 27.975}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.00218029972165823, "policy_loss": -1.731378688418772e-05, "vf_loss": 0.002197612076997757, "vf_explained_var": 0.4478398263454437, "kl": 1.7502379705547355e-06, "entropy": 2.682392120361328, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2365020, "num_agent_steps_sampled": 2365020, "num_steps_trained": 2365020, "num_agent_steps_trained": 2365020}, "done": false, "episodes_total": 1182, "training_iteration": 197, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-38-18", "timestamp": 1690853898, "time_this_iter_s": 79.44687390327454, "time_total_s": 15924.823200702667, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15924.823200702667, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.97610619469026, "ram_util_percent": 55.53274336283186}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.138643616305535, "episode_reward_mean": -3.9033088652939556, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8295701692214608, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.073738696072502, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.37386960724945, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1112.87, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5561569215392304, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-3.836301218039885, -3.772058561039585, -3.934193097463119, -4.138643616305535, -4.037573161638395, -3.813242426006272, -4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957, -3.7405468247003855, -3.8725415200890785, -3.993805739240236, -4.044785173008814, -3.873406436973174, -4.005037967137559, -3.9417196477482603, -3.8047602787978763, -3.975845708817301, -3.8828099528206352, -3.791250754579682, -3.9107941976540257, -3.8700346299215305, -4.055174737213841, -4.017843426213744, -3.808123346500456, -3.8707870222590763, -3.9238585096114154], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7907247116297038, "mean_inference_ms": 8.320693638172573, "mean_action_processing_ms": 0.40417364753522506, "mean_env_wait_ms": 9.711864263207817, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2377026, "agent_timesteps_total": 2377026, "timers": {"sample_time_ms": 42747.056, "sample_throughput": 280.861, "load_time_ms": 7.203, "load_throughput": 1666919.804, "learn_time_ms": 35847.623, "learn_throughput": 334.918, "update_time_ms": 26.353}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0018847252940759063, "policy_loss": -0.00047231229837052524, "vf_loss": 0.002357038203626871, "vf_explained_var": 0.5759981870651245, "kl": 1.2163245628471486e-05, "entropy": 2.6582229137420654, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2377026, "num_agent_steps_sampled": 2377026, "num_steps_trained": 2377026, "num_agent_steps_trained": 2377026}, "done": false, "episodes_total": 1188, "training_iteration": 198, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-39-35", "timestamp": 1690853975, "time_this_iter_s": 77.14349341392517, "time_total_s": 16001.966694116592, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16001.966694116592, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.98288288288288, "ram_util_percent": 55.60360360360362}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.0812938398809475, "episode_reward_mean": -3.9044966399637233, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.8306173216534067, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0738793183103237, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.3879318310316, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1090.92, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1956, "constraint_violation.max_vel_constraint.ratio_mean": 0.5451874062968515, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9775112443778111}, "hist_stats": {"episode_reward": [-4.030814146091142, -3.944536639517798, -3.9048385685444584, -3.9905888379307353, -3.87093812602826, -3.832882391945333, -4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957, -3.7405468247003855, -3.8725415200890785, -3.993805739240236, -4.044785173008814, -3.873406436973174, -4.005037967137559, -3.9417196477482603, -3.8047602787978763, -3.975845708817301, -3.8828099528206352, -3.791250754579682, -3.9107941976540257, -3.8700346299215305, -4.055174737213841, -4.017843426213744, -3.808123346500456, -3.8707870222590763, -3.9238585096114154, -4.057898558405024, -3.947144307922873, -3.870765631230288, -3.851739252049392, -4.07974336387305, -3.843498433988901], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7904474194455264, "mean_inference_ms": 8.320245979935466, "mean_action_processing_ms": 0.4041884591795853, "mean_env_wait_ms": 9.712219133069063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2389032, "agent_timesteps_total": 2389032, "timers": {"sample_time_ms": 42882.464, "sample_throughput": 279.975, "load_time_ms": 6.969, "load_throughput": 1722684.144, "learn_time_ms": 36025.861, "learn_throughput": 333.261, "update_time_ms": 24.409}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.0027182858902961016, "policy_loss": -5.852214599144645e-05, "vf_loss": 0.0027768102008849382, "vf_explained_var": 0.19898909330368042, "kl": 1.8934137813175766e-07, "entropy": 2.772282361984253, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2389032, "num_agent_steps_sampled": 2389032, "num_steps_trained": 2389032, "num_agent_steps_trained": 2389032}, "done": false, "episodes_total": 1194, "training_iteration": 199, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-40-55", "timestamp": 1690854055, "time_this_iter_s": 79.79823589324951, "time_total_s": 16081.764930009842, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16081.764930009842, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.98053097345134, "ram_util_percent": 55.5849557522124}, "trial_id": "b1188_00000"}
{"episode_reward_max": -3.460399810684158, "episode_reward_min": -4.0812938398809475, "episode_reward_mean": -3.901054995503261, "episode_len_mean": 2001.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/reward_lower_bound_max_vel_constraint_mean": 0.0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_min": 0, "failure_code_ratio/reward_lower_bound_max_vel_constraint_max": 0, "reward_component_totals/dist_change_reward_mean": -0.827823260553914, "reward_component_totals/dist_change_reward_min": -0.9990190909240332, "reward_component_totals/dist_change_reward_max": -0.33434272901458595, "reward_component_totals/delta_v_mean": -2.0732317349493536, "reward_component_totals/delta_v_min": -2.1759846292436107, "reward_component_totals/delta_v_max": -2.0215626166760927, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0, "delta_v_total_mean": 207.32317349493462, "delta_v_total_min": 202.15626166760907, "delta_v_total_max": 217.59846292436063, "constraint_violation.max_vel_constraint.steps_mean": 1096.67, "constraint_violation.max_vel_constraint.steps_min": 296, "constraint_violation.max_vel_constraint.steps_max": 1962, "constraint_violation.max_vel_constraint.ratio_mean": 0.5480609695152423, "constraint_violation.max_vel_constraint.ratio_min": 0.14792603698150925, "constraint_violation.max_vel_constraint.ratio_max": 0.9805097451274363}, "hist_stats": {"episode_reward": [-4.033775726091807, -4.009737454997126, -4.019685926441342, -3.872098190581709, -3.809822816764134, -3.873144796333401, -3.88587434309812, -3.9171748271305984, -3.990986902544688, -4.040161754453928, -3.9759113349920714, -3.792658093911494, -3.8362507298534485, -3.834518922763298, -3.9543691309202362, -3.8418568608960992, -3.9141617500275374, -3.8741280066448516, -3.879707607806113, -3.8299432509758216, -3.869403446722975, -4.037774229310516, -3.7737421152611086, -3.860564664793551, -3.7949757481358772, -3.881219022288536, -4.009857125582009, -3.9674456937353604, -3.8972870941519178, -3.7897930325396256, -3.946680055829651, -3.893488020724237, -3.852017839004132, -4.078507193852388, -3.460399810684158, -3.7866431089522257, -3.9413953470495793, -3.828634130174887, -3.953083803690297, -4.027308526652045, -4.0271244487788564, -3.9236868335624053, -3.8321162455487703, -3.852252080872778, -3.9893490429790126, -3.8938471636223015, -3.786668770515294, -3.8738167736256615, -3.890270483875854, -3.8849257249739835, -3.8179132139276786, -4.005115343381557, -3.8188181075369583, -3.849216156913939, -3.8584244008263626, -4.0232588480184495, -4.046287987062993, -3.79604581508638, -3.8474064008637856, -3.797568896808163, -3.8709628657568285, -4.052170354319976, -3.8002359331163484, -3.869961455162229, -3.9635935665426416, -4.0812938398809475, -3.8388432065308584, -4.0326755259680205, -3.8065803801864515, -3.87453156294957, -3.7405468247003855, -3.8725415200890785, -3.993805739240236, -4.044785173008814, -3.873406436973174, -4.005037967137559, -3.9417196477482603, -3.8047602787978763, -3.975845708817301, -3.8828099528206352, -3.791250754579682, -3.9107941976540257, -3.8700346299215305, -4.055174737213841, -4.017843426213744, -3.808123346500456, -3.8707870222590763, -3.9238585096114154, -4.057898558405024, -3.947144307922873, -3.870765631230288, -3.851739252049392, -4.07974336387305, -3.843498433988901, -4.021664007477996, -3.8192547343298404, -3.905438858599229, -3.8090142366039013, -3.8770435434390533, -3.79801888356147], "episode_lengths": [2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7901869146618778, "mean_inference_ms": 8.319793527597724, "mean_action_processing_ms": 0.4041979796379481, "mean_env_wait_ms": 9.712643508596365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 2401038, "agent_timesteps_total": 2401038, "timers": {"sample_time_ms": 42717.095, "sample_throughput": 281.058, "load_time_ms": 6.861, "load_throughput": 1749916.211, "learn_time_ms": 36183.23, "learn_throughput": 331.811, "update_time_ms": 23.68}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 9.999999717180685e-10, "total_loss": 0.003051729639992118, "policy_loss": 0.000594545213971287, "vf_loss": 0.0024571851827204227, "vf_explained_var": 0.27145642042160034, "kl": 4.957740316058334e-07, "entropy": 2.7502832412719727, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 2401038, "num_agent_steps_sampled": 2401038, "num_steps_trained": 2401038, "num_agent_steps_trained": 2401038}, "done": true, "episodes_total": 1200, "training_iteration": 200, "experiment_id": "dd8e6238b7544f2e93f728f4f39f8e03", "date": "2023-07-31_18-42-14", "timestamp": 1690854134, "time_this_iter_s": 78.9438226222992, "time_total_s": 16160.708752632141, "pid": 3550184, "hostname": "barrett2.stanford.edu", "node_ip": "172.24.65.168", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "complete_episodes", "gamma": 0.968559, "lr": 1e-09, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DockingEnv", "observation_space": null, "action_space": null, "env_config": {"agent": "deputy", "step_size": 1, "env_objs": [{"name": "chief", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "x": 0, "x_dot": 0, "y": 0, "y_dot": 0}}}, {"name": "deputy", "class": "<class 'saferl.aerospace.models.cwhspacecraft.platforms.cwh.CWHSpacecraft2d'>", "config": {"integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "thrust_x", "space": "continuous", "bounds": [-1, 1]}, {"name": "thrust_y", "space": "continuous", "bounds": [-1, 1]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.docking.initializers.ConstrainedDeputyPolarInitializer'>", "ref": "chief", "radius": [100, 150], "angle": [0, 6.283185307179586]}}}, {"name": "docking_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "chief", "x_offset": 0, "y_offset": 0, "radius": 0.5, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "status": [{"name": "in_docking", "class": "<class 'saferl.aerospace.tasks.docking.processors.InDockingStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "docking_distance", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingDistanceStatusProcessor'>", "config": {"deputy": "deputy", "docking_region": "docking_region"}}, {"name": "delta_v", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingThrustDeltaVStatusProcessor'>", "config": {"target": "deputy"}}, {"name": "custom_metrics.delta_v_total", "class": "<class 'saferl.aerospace.tasks.docking.processors.AccumulatorStatusProcessor'>", "config": {"status": "delta_v"}}, {"name": "max_vel_limit", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimit'>", "config": {"target": "deputy", "dist_status": "docking_distance", "vel_threshold": 0.2, "threshold_dist": 0.5, "slope": 2}}, {"name": "max_vel_violation", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingVelocityLimitViolation'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "max_vel_constraint", "class": "<class 'saferl.aerospace.tasks.docking.processors.RelativeVelocityConstraint'>", "config": {"target": "deputy", "ref": "chief", "vel_limit_status": "max_vel_limit"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureStatusProcessor'>", "config": {"docking_distance": "docking_distance", "max_goal_distance": 40000, "timeout": 2000, "in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessStatusProcessor'>", "config": {"in_docking_status": "in_docking", "max_vel_constraint_status": "max_vel_constraint"}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.docking.processors.DockingObservationPolarPositionRectVelProcessor'>", "config": {"deputy": "deputy", "mode": "2d"}}], "reward": [{"name": "dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "deputy", "target": "docking_region", "pivot": 100}}, {"name": "delta_v", "class": "<class 'saferl.environment.tasks.processor.reward.ProportionalRewardProcessor'>", "config": {"scale": -0.01, "bias": 0, "proportion_status": "delta_v"}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "reward_lower_bound_max_vel_constraint": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 2000}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.928544, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16160.708752632141, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 99.98750000000003, "ram_util_percent": 55.62410714285714}, "trial_id": "b1188_00000"}
